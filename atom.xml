<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[CrazyHoney]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://crazyhoney.github.io/"/>
  <updated>2016-05-04T14:37:51.251Z</updated>
  <id>http://crazyhoney.github.io/</id>
  
  <author>
    <name><![CDATA[wayne Hao]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[testTags]]></title>
    <link href="http://crazyhoney.github.io/2016/05/04/testTags/"/>
    <id>http://crazyhoney.github.io/2016/05/04/testTags/</id>
    <published>2016-05-04T14:35:40.000Z</published>
    <updated>2016-05-04T14:37:51.251Z</updated>
    <content type="html"><![CDATA[<h2 id="hello"><a href="#hello" class="headerlink" title="hello"></a>hello</h2>]]></content>
    <summary type="html">
    <![CDATA[<h2 id="hello"><a href="#hello" class="headerlink" title="hello"></a>hello</h2>]]>
    </summary>
    
      <category term="test" scheme="http://crazyhoney.github.io/tags/test/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[算法学习--各种排序的思想和实现]]></title>
    <link href="http://crazyhoney.github.io/2016/05/04/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0-%E5%90%84%E7%A7%8D%E6%8E%92%E5%BA%8F%E7%9A%84%E6%80%9D%E6%83%B3%E5%92%8C%E5%AE%9E%E7%8E%B0/"/>
    <id>http://crazyhoney.github.io/2016/05/04/算法学习-各种排序的思想和实现/</id>
    <published>2016-05-04T11:26:09.000Z</published>
    <updated>2016-05-05T08:36:14.550Z</updated>
    <content type="html"><![CDATA[<h1 id="u4E00_u3001_u76F4_u63A5_u63D2_u5165_u6392_u5E8F"><a href="#u4E00_u3001_u76F4_u63A5_u63D2_u5165_u6392_u5E8F" class="headerlink" title="一、直接插入排序"></a>一、直接插入排序</h1><h2 id="uFF11_u3001_u601D_u60F3"><a href="#uFF11_u3001_u601D_u60F3" class="headerlink" title="１、思想"></a>１、思想</h2><p><strong>从第二个元素到末尾，逐个向前面的有序序列插入，使之成为有序序列。</strong></p>
<blockquote>
<ul>
<li>插入过程在有序序列中从后向前比较，遇到比当前元素大的元素，则把它向后移动一个。<br> 遇到比当前元素小的元素，直接break。把当前元素放到比它小的元素的下一个。<a id="more"></a>
</li>
</ul>
</blockquote>
<h2 id="2_u3001_u4EE3_u7801"><a href="#2_u3001_u4EE3_u7801" class="headerlink" title="2、代码"></a>2、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 直接插入排序</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InsertSort</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Insertsort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">int</span> j;</span><br><span class="line">			<span class="keyword">int</span> i ;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">				x = arr[i];</span><br><span class="line">				<span class="keyword">for</span> ( j = i-<span class="number">1</span>; j &gt;=<span class="number">0</span>; j--) &#123;</span><br><span class="line">					<span class="keyword">if</span> (arr[j] &gt; x) &#123;</span><br><span class="line">						arr[j+<span class="number">1</span>] = arr[j];</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				arr[j+<span class="number">1</span>] = x;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"please input a order number and order"</span>);</span><br><span class="line">		System.out.println(<span class="string">"eg: 5 回车  5 8 2 4 9(以空格隔开)"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span>+ n);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span>+i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 排序</span><br><span class="line">		 */</span></span><br><span class="line">		Insertsort(arr, n);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : arr) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u4E8C_u3001_u76F4_u63A5_u9009_u62E9_u6392_u5E8F"><a href="#u4E8C_u3001_u76F4_u63A5_u9009_u62E9_u6392_u5E8F" class="headerlink" title="二、直接选择排序"></a>二、直接选择排序</h1><h2 id="uFF11_u3001_u601D_u60F3-1"><a href="#uFF11_u3001_u601D_u60F3-1" class="headerlink" title="１、思想"></a>１、思想</h2><p><strong>在无序区间内选择一个最小值(或最大值)与无序区间第一个交换，并且每趟都缩小无序区间，直到无序区间只剩一个元素。</strong></p>
<h2 id="2_u3001_u4EE3_u7801-1"><a href="#2_u3001_u4EE3_u7801-1" class="headerlink" title="2、代码"></a>2、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 直接选择排序</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Selectsort</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Selectsort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> j;</span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		<span class="keyword">int</span> min;</span><br><span class="line">		<span class="keyword">int</span> t;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">			min = i;</span><br><span class="line">			<span class="keyword">for</span> (j = i; j &lt; n; j++) &#123;</span><br><span class="line">				<span class="keyword">if</span> (arr[j] &lt; arr[min]) &#123;</span><br><span class="line">					min = j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (min != i) &#123;</span><br><span class="line">				t = arr[min];</span><br><span class="line">				arr[min] = arr[i];</span><br><span class="line">				arr[i] = t;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"please input a order number and order"</span>);</span><br><span class="line">		System.out.println(<span class="string">"eg: 5 回车  5 8 2 4 9(以空格隔开)"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span> + n);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span> + i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 排序</span><br><span class="line">		 */</span></span><br><span class="line">		Selectsort(arr, n);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : arr) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u4E09_u3001_u5192_u6CE1_u6392_u5E8F"><a href="#u4E09_u3001_u5192_u6CE1_u6392_u5E8F" class="headerlink" title="三、冒泡排序"></a>三、冒泡排序</h1><h2 id="1_u3001_u601D_u60F3"><a href="#1_u3001_u601D_u60F3" class="headerlink" title="1、思想"></a>1、思想</h2><p><strong>通过相邻元素的比较交换，让当前最大的元素“冒泡”般的放在最后</strong></p>
<h2 id="2_u3001_u5B9E_u73B0"><a href="#2_u3001_u5B9E_u73B0" class="headerlink" title="2、实现"></a>2、实现</h2><blockquote>
<ul>
<li>外层循环0&lt;=i&lt;n-1(因为比较至剩下一个元素便不用比较了，已经有序)</li>
<li>内层循环1&lt;=j&lt;n-i(第一趟比较的对象时全部元素，第二趟是从开始到n-1的元素，之后每次减少一个。直到剩下第一个元素为止)</li>
<li>如果有一趟外层循环结束没有移动元素，则说明已经有序，直接退出返回</li>
</ul>
</blockquote>
<h2 id="3_u3001_u4EE3_u7801"><a href="#3_u3001_u4EE3_u7801" class="headerlink" title="3、代码"></a>3、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 冒泡排序</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> * </span><br><span class="line"> * </span><br><span class="line"> * 这是选择排序(⊙ˍ⊙)：</span><br><span class="line"> * 外层循环n-1趟</span><br><span class="line"> * 		内层循环次数逐层减少，每趟找到最大的下标。</span><br><span class="line"> * 		然后和最后一个元素交换。</span><br><span class="line"> * </span><br><span class="line"> * 这才是冒泡排序：</span><br><span class="line"> * 外层循环n-1趟</span><br><span class="line"> * 		内层循环让每个相邻元素比较，让大的向后移动。</span><br><span class="line"> * 		如果有一趟没有移动元素，则说明已经有序，直接退出返回</span><br><span class="line"> *</span><br><span class="line"> *两层循环：外层 i:0到n-1</span><br><span class="line"> *			内层 j:1到n-i</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BubbleSort</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">	 * 这个不太像严格意义的冒泡，因为没有连续相互比较，而是直接找最大的</span><br><span class="line">	 * 不对，这是直接选择排序啊</span><br><span class="line">	 * 卧槽。。。</span><br><span class="line">	 * <span class="doctag">@param</span> arr</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Bubblesort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> max;</span><br><span class="line">		<span class="keyword">int</span> t;</span><br><span class="line">		<span class="keyword">int</span> j;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length-<span class="number">1</span>; i++) &#123;</span><br><span class="line">			max = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> ( j = <span class="number">1</span>; j &lt; arr.length-i; j++) &#123;</span><br><span class="line">				<span class="keyword">if</span> (arr[j] &gt; arr[max]) &#123;</span><br><span class="line">					max = j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			t = arr[max];</span><br><span class="line">			arr[max] = arr[j-<span class="number">1</span>];</span><br><span class="line">			arr[j-<span class="number">1</span>] = t;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Bubblesort2</span><span class="params">(<span class="keyword">int</span> arr[])</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i,j,t;</span><br><span class="line">		<span class="keyword">boolean</span> flag;</span><br><span class="line">		<span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; arr.length-<span class="number">1</span>; i++) &#123;</span><br><span class="line">			flag = <span class="keyword">true</span>;</span><br><span class="line">			<span class="keyword">for</span> ( j = <span class="number">1</span>; j &lt; arr.length-i; j++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(arr[j-<span class="number">1</span>] &gt; arr[j])&#123;</span><br><span class="line">					t = arr[j];</span><br><span class="line">					arr[j] = arr[j-<span class="number">1</span>];</span><br><span class="line">					arr[j-<span class="number">1</span>] = t;</span><br><span class="line">					flag = <span class="keyword">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(flag) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"please input a order number and order"</span>);</span><br><span class="line">		System.out.println(<span class="string">"eg: 5 回车  5 8 2 4 9(以空格隔开)"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span> + n);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span> + i);</span><br><span class="line">		&#125;</span><br><span class="line">		Bubblesort2(arr);</span><br><span class="line">		<span class="comment">//输出</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : arr) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u56DB_u3001_u5F52_u5E76_u6392_u5E8F"><a href="#u56DB_u3001_u5F52_u5E76_u6392_u5E8F" class="headerlink" title="四、归并排序"></a>四、归并排序</h1><h2 id="uFF11_u3001_u601D_u60F3-2"><a href="#uFF11_u3001_u601D_u60F3-2" class="headerlink" title="１、思想"></a>１、思想</h2><p><strong>分治法，将大的问题分为更小的问题，分到很容易解决后解决。然后不断合并为最终答案</strong></p>
<blockquote>
<ul>
<li>分解：将问题分解，直到不能再分解</li>
<li>解决：使用归并分别递归地排列两个子序列</li>
<li>合并：合并两个已排序的序列为有序序列</li>
</ul>
</blockquote>
<h2 id="2_u3001_u4EE3_u7801-2"><a href="#2_u3001_u4EE3_u7801-2" class="headerlink" title="2、代码"></a>2、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 归并排序</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MergeSort</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Mergesort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> p, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (p &lt; r) &#123;</span><br><span class="line">			<span class="keyword">int</span> q = (p + r) / <span class="number">2</span>;</span><br><span class="line">			Mergesort(arr, p, q);</span><br><span class="line">			Mergesort(arr, q + <span class="number">1</span>, r);</span><br><span class="line">			Merge(arr, p, q, r);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> arr 	存放所有数据的数组</span><br><span class="line">	 * <span class="doctag">@param</span> p		当前两个子序列的最开始的下标</span><br><span class="line">	 * </span><br><span class="line">	 * arr[p..q] 有序  arr[q+1..r] 有序 但两个区间之间无序，所有要存在Merge函数</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> q		当前两个子序列的分隔开的位置</span><br><span class="line">	 * <span class="doctag">@param</span> r		当前两个子序列的最后的下标</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> p, <span class="keyword">int</span> q, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> arr1[] = <span class="keyword">new</span> <span class="keyword">int</span>[q-p+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">int</span> arr2[] = <span class="keyword">new</span> <span class="keyword">int</span>[r-q];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr1.length; i++) &#123;<span class="comment">//存放前面一半数据</span></span><br><span class="line">			arr1[i] = arr[p + i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr2.length; i++) &#123;<span class="comment">//存放后面一半数据</span></span><br><span class="line">			arr2[i] = arr[q + <span class="number">1</span> +i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> k;</span><br><span class="line">		<span class="keyword">for</span> ( k = p; k &lt;= r; k++) &#123;<span class="comment">//合并2边数据</span></span><br><span class="line">			<span class="keyword">if</span>(arr1[i] &lt; arr2[j])&#123;</span><br><span class="line">				arr[k] = arr1[i];</span><br><span class="line">				i++;</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				arr[k] = arr2[j];</span><br><span class="line">				j++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>( (i == arr1.length) || (j == arr2.length) )&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i == arr1.length)&#123;</span><br><span class="line">			<span class="comment">//前面一半先跑完，把另一半后面的直接放上去</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> m = j; m &lt; arr2.length; m++) &#123;</span><br><span class="line">				arr[++k] = arr2[m];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> m = i; m &lt; arr1.length; m++) &#123;</span><br><span class="line">				arr[++k] = arr1[m];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"please input a order number and order"</span>);</span><br><span class="line">		System.out.println(<span class="string">"eg: 5 回车  5 8 2 4 9(以空格隔开)"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span> + n);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span> + i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 排序</span><br><span class="line">		 */</span></span><br><span class="line">		Mergesort(arr, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : arr) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u4E94_u3001__u5806_u6392_u5E8F"><a href="#u4E94_u3001__u5806_u6392_u5E8F" class="headerlink" title="五、 堆排序"></a>五、 堆排序</h1><h2 id="uFF11_u3001_u601D_u60F3-3"><a href="#uFF11_u3001_u601D_u60F3-3" class="headerlink" title="１、思想"></a>１、思想</h2><p><strong>利用大根堆的性质，每次将堆顶元素和最后一个元素交换，然后不带最后一个位置的元素的调整为新的大根堆。迭代这个过程，直到堆的大小减小至1</strong>   </p>
<blockquote>
<ul>
<li>建队：自输入的最后一个节点的父节点到根节点循环调用堆调整算法MAXHEAPIFY，完成后则是大根堆(或小根堆)。</li>
<li>排序：</li>
<li>(1)将堆顶元素和最后一个元素交换，并且将堆的大小heapsize减一。然后对堆顶调用MAXHEAPIFY。</li>
<li>(2)一直循环调用至堆的heapsize为1为止。</li>
</ul>
</blockquote>
<h2 id="2_u3001_u5806_u8C03_u6574_u51FD_u6570MAXHEAPIFY_28arr_2Ci_29"><a href="#2_u3001_u5806_u8C03_u6574_u51FD_u6570MAXHEAPIFY_28arr_2Ci_29" class="headerlink" title="2、堆调整函数MAXHEAPIFY(arr,i)"></a>2、堆调整函数MAXHEAPIFY(arr,i)</h2><p><strong>调整存储在arr里面的以i为根节点的堆为大根堆</strong></p>
<p><em>隐含前提：以i为根的堆，它的左右子女的二叉树都是满足大根堆性质的。但是以i节点为根的堆可能不满足大根堆性质</em></p>
<blockquote>
<ul>
<li>计算i的左右子女下标</li>
<li>左子女节点不越界并且数值大于i节点的值，则max=left,否则max=i</li>
<li>右子女不越界并且数值大于max节点的值，则max=right</li>
<li>交换节点max和i的数值</li>
<li>若max和i节点不是同一个节点。则说明以i为根的堆的堆顶元素和它的某个子女交换了，则以i的某个子女为根的堆可能又不满足大根堆的性质了。所以递归调用MAXHEAPIFY(arr,max)</li>
</ul>
</blockquote>
<h2 id="3_u3001_u4EE3_u7801-1"><a href="#3_u3001_u4EE3_u7801-1" class="headerlink" title="3、代码"></a>3、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Heap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 堆排序</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> * </span><br><span class="line"> * heapsize全局变量，用来指示当前需要大根调整的元素个数。</span><br><span class="line"> * 完成堆排序的最大输出在最后。</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeapSort</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> heapsize;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> MaxHeap 大根堆数组</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">HeapSort</span><span class="params">(<span class="keyword">int</span>[] MaxHeap)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = MaxHeap.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">			<span class="keyword">int</span> t;</span><br><span class="line">			t = MaxHeap[<span class="number">0</span>];</span><br><span class="line">			MaxHeap[<span class="number">0</span>] = MaxHeap[i];</span><br><span class="line">			MaxHeap[i] = t;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 这里heapsize全局变量每次递减，保证了每次放在后面的数据不会再参与对调整。</span><br><span class="line">			 * 从而变得逐步有序</span><br><span class="line">			 */</span></span><br><span class="line">			heapsize--;</span><br><span class="line">			maxHeapify(MaxHeap, <span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[] buildMaxHeap(<span class="keyword">int</span> arr[]) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length / <span class="number">2</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">			maxHeapify(arr, i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> arr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">maxHeapify</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> left = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> right = (i * <span class="number">2</span>) + <span class="number">2</span>;</span><br><span class="line">		<span class="comment">/*</span><br><span class="line">		 * 这句话是有问题的，如果有一个下标是越界的，而另一个没有，则会出现比较不完全的问题 </span><br><span class="line">		 * if(left &gt;= heapsize || right&gt;= heapsize)//把大于号改为了大于等于，小于号改为了小于等于 </span><br><span class="line">		 * return;</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">int</span> max;</span><br><span class="line">		<span class="keyword">int</span> tmp;</span><br><span class="line">		<span class="comment">// 此处越界判断应放在前面的条件判断，否则会出现下标越界的错误</span></span><br><span class="line">		<span class="keyword">if</span> ((left &lt; heapsize) &amp;&amp; (a[left] &gt; a[i]))</span><br><span class="line">			max = left;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			max = i;</span><br><span class="line">		<span class="keyword">if</span> ((right &lt; heapsize) &amp;&amp; (a[right] &gt; a[max]))</span><br><span class="line">			max = right;</span><br><span class="line">		<span class="keyword">if</span> (max != i) &#123;</span><br><span class="line">			tmp = a[max];</span><br><span class="line">			a[max] = a[i];</span><br><span class="line">			a[i] = tmp;</span><br><span class="line">			maxHeapify(a, max);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"please input a order number and order"</span>);</span><br><span class="line">		System.out.println(<span class="string">"eg: 5 回车  5 8 2 4 9(以空格隔开)"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数</span><br><span class="line">		 * </span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span> + n);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">		heapsize = arr.length;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span> + i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> MaxHeap[] = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line">		<span class="comment">// 建堆</span></span><br><span class="line">		MaxHeap = buildMaxHeap(arr);</span><br><span class="line">		<span class="comment">// 把构建好的大顶堆进行排序</span></span><br><span class="line">		HeapSort(MaxHeap);</span><br><span class="line">		<span class="comment">// 输出</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : MaxHeap) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u516D_u3001_u5FEB_u901F_u6392_u5E8F"><a href="#u516D_u3001_u5FEB_u901F_u6392_u5E8F" class="headerlink" title="六、快速排序"></a>六、快速排序</h1><h2 id="1_u3001_u601D_u60F3-1"><a href="#1_u3001_u601D_u60F3-1" class="headerlink" title="1、思想"></a>1、思想</h2><p><strong>基于分治法，以一个元素为分界线，把数组划分为2个子数组。让这个元素在中间，左边的数组的元素都小于它，右边的数组的元素都大于它。左右数组递归地进行上述操作，直至问题规模为1。</strong></p>
<p><strong>和归并排序的区别：</strong></p>
<p><em>归并排序是先分解问题，然后再一层一层的合并(重点在合并)</em></p>
<p><em>快速排序是以一个元素为划分基准来分解问题，然后一层一层的分解。不用合并(重点在分解)</em></p>
<h2 id="2_u3001_u4EE3_u7801-3"><a href="#2_u3001_u4EE3_u7801-3" class="headerlink" title="2、代码"></a>2、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 快排</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Quicksort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> p, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (p &lt; r) &#123;</span><br><span class="line">			<span class="keyword">int</span> q = Partition(arr, p, r); </span><br><span class="line">			Quicksort(arr, p, q-<span class="number">1</span>);</span><br><span class="line">			Quicksort(arr, q+<span class="number">1</span>, r);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Partition</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> p, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 大概写一下这个过程，以备以后看的时候更快</span><br><span class="line">		 * x:分隔元素</span><br><span class="line">		 * i:指示当前最后一个小于等于x的元素。</span><br><span class="line">		 * j:指示遍历的每个元素</span><br><span class="line">		 * t:用作交换</span><br><span class="line">		 * </span><br><span class="line">		 * 用j扫描每个元素，当元素大于x时，则什么都不干。</span><br><span class="line">		 * 					当元素小于等于x时，则把i指示的下一个元素(当前从前向后第一个大于x的数据)</span><br><span class="line">		 * 					和这个元素(小于等于x)交换。</span><br><span class="line">		 * 最后把x和i+1的元素互换。返回i+1.</span><br><span class="line">		 * </span><br><span class="line">		 * i元素指示的值，就是两边的分割线。下标小于等于i的元素都小于等于x。大于i的都大于x。</span><br><span class="line">		 * x和i+1换了后，即x左边的都小于等于x，x右边的都大于x。</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">int</span> x = arr[r];</span><br><span class="line">		<span class="keyword">int</span> i = p-<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> t;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = p; j &lt; r; j++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (arr[j] &lt;= x) &#123;</span><br><span class="line">				i++;</span><br><span class="line">				t = arr[i];</span><br><span class="line">				arr[i] = arr[j];</span><br><span class="line">				arr[j] = t;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		t = arr[i+<span class="number">1</span>];</span><br><span class="line">		arr[i+<span class="number">1</span>] = arr[r];</span><br><span class="line">		arr[r] = t;</span><br><span class="line">		<span class="keyword">return</span> i+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"please input a order number and order"</span>);</span><br><span class="line">		System.out.println(<span class="string">"eg: 5 回车  5 8 2 4 9(以空格隔开)"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span> + n);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span> + i);</span><br><span class="line">		&#125;	</span><br><span class="line">		Quicksort(arr, <span class="number">0</span>, arr.length-<span class="number">1</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : arr) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u4E03_u3001_u8BA1_u6570_u6392_u5E8F"><a href="#u4E03_u3001_u8BA1_u6570_u6392_u5E8F" class="headerlink" title="七、计数排序"></a>七、计数排序</h1><h2 id="1_u3001_u524D_u63D0"><a href="#1_u3001_u524D_u63D0" class="headerlink" title="1、前提"></a>1、前提</h2><p><em>输入的元素在一定范围内，例如[0,k]</em></p>
<h2 id="2_u3001_u601D_u60F3"><a href="#2_u3001_u601D_u60F3" class="headerlink" title="2、思想"></a>2、思想</h2><p><strong>对于每一个输入元素x，确定小于x的元素的个数。那么x最终的位置即可确定。</strong></p>
<h2 id="3_u3001_u5B9E_u73B0"><a href="#3_u3001_u5B9E_u73B0" class="headerlink" title="3、实现"></a>3、实现</h2><blockquote>
<ul>
<li>输入数组a[],输出数组b[],辅助数组c[k+1]</li>
<li>c[]中的每个元素表示小于等于该下标的元素的个数</li>
<li>把数组a的每个元素都放入数组b中，下标为以该元素为下标c数组的值。</li>
<li>把c数组中对应元素减1(<strong>应对有重复元素的情况</strong>)</li>
</ul>
</blockquote>
<h2 id="uFF14_u3001_u4EE3_u7801"><a href="#uFF14_u3001_u4EE3_u7801" class="headerlink" title="４、代码"></a>４、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 计数排序</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> * </span><br><span class="line"> * 例如：9 回车</span><br><span class="line"> * 4 2 5 9</span><br><span class="line"> * 排序结果 2 4 6 9</span><br><span class="line"> *</span><br><span class="line"> *思想：对于每一个输入元素x，确定小于x的元素的个数。那么x最终的位置即可确定。</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountSort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Countsort</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> b[], <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//k代表所有元素都小于等于k</span></span><br><span class="line">		k += <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> c[] = <span class="keyword">new</span> <span class="keyword">int</span>[k];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : c) &#123;</span><br><span class="line">			i = <span class="number">0</span>;</span><br><span class="line">			<span class="comment">//System.out.println(i + "  " + c[i]);</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j : a) &#123;</span><br><span class="line">			c[j] = c[j] + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; c.length; ++i) &#123;</span><br><span class="line">			c[i] = c[i] + c[i - <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//for (int j = a.length - 1; j &gt;= 0; --j) &#123;</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= a.length - <span class="number">1</span>; ++j) &#123;</span><br><span class="line"></span><br><span class="line">			b[c[a[j]] - <span class="number">1</span>] = a[j];<span class="comment">//这里因为b数组下标从0开始</span></span><br><span class="line">			 <span class="comment">/**</span><br><span class="line">			  * 例如输入为a = [4 6 2 5]  b = [0 0 0 0]</span><br><span class="line">			  * 	c = [0 0 1 1 2 3 4]</span><br><span class="line">			  * 	6对应的小于等于6的是c[6],b[4]已经越界了</span><br><span class="line">			  */</span></span><br><span class="line">			c[a[j]]--;</span><br><span class="line">			<span class="comment">//c[a[j]]++;</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"请输入小于等于n的数字，以空格分隔开:"</span>);</span><br><span class="line">		System.out.println(<span class="string">"例如：9 回车"</span>);</span><br><span class="line">		System.out.println(<span class="string">"4 2 5 9"</span>);</span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span>+ n);</span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[split.length];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span>+i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> brr[] = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line">		Countsort(arr, brr, n);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : brr) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u516B_u3001_u57FA_u6570_u6392_u5E8F"><a href="#u516B_u3001_u57FA_u6570_u6392_u5E8F" class="headerlink" title="八、基数排序"></a>八、基数排序</h1><h2 id="1_u3001_u601D_u60F3-2"><a href="#1_u3001_u601D_u60F3-2" class="headerlink" title="1、思想"></a>1、思想</h2><p><strong>从每个数的各位开始排序，然后依次比较十位、百位。。。</strong></p>
<p><em>实际过程是在每一位进行排序都调用的是计数排序</em> <strong>(每位上的数都是0-9的数字，所以用计数排序)</strong></p>
<h2 id="2_u3001_u4EE3_u7801-4"><a href="#2_u3001_u4EE3_u7801-4" class="headerlink" title="2、代码"></a>2、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 基数排序 给每一位都进行一次计数排序</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RadixSort</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> d;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">	 * count[]:辅助数组(类似于计数排序里的c[])</span><br><span class="line">	 * temp[]:每一位拍好序的数组，临时放到temp</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> arr</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">radixSort</span><span class="params">(<span class="keyword">int</span> arr[])</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> k = <span class="number">10</span>;</span><br><span class="line">		<span class="keyword">int</span> i, j;</span><br><span class="line">		<span class="keyword">int</span> p;</span><br><span class="line">		<span class="keyword">int</span> count[] = <span class="keyword">new</span> <span class="keyword">int</span>[k];</span><br><span class="line">		<span class="keyword">int</span> temp[] = <span class="keyword">new</span> <span class="keyword">int</span>[arr.length];</span><br><span class="line">		<span class="comment">//d:数字的最大位数</span></span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= d; i++) &#123;</span><br><span class="line">			<span class="comment">// 每一层其实都是一个计数排序</span></span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; k; j++) &#123;</span><br><span class="line">				count[j] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">				count[getdigit(arr[j], i)]++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 此循环结束，count上的元素count[k]表示：当前第i位，小于等于k的个数。 </span><br><span class="line">			 * eg:i =3，count[3]表示，第三位（百位）上的数，小于等于3的有count[3]个。</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; count.length; j++) &#123;</span><br><span class="line">				count[j] = count[j] + count[j - <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * arr[p]:该元素值 </span><br><span class="line">			 * getdigit(arr[p],i)：该元素第i位是几 </span><br><span class="line">			 * count[t]：小于等于该元素的元素个数</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">for</span> (p = arr.length - <span class="number">1</span>; p &gt;= <span class="number">0</span>; p--) &#123;</span><br><span class="line">				<span class="keyword">int</span> t = getdigit(arr[p], i);</span><br><span class="line">				temp[count[t] - <span class="number">1</span>] = arr[p];<span class="comment">// 把该元素放到小于它的最右边，减一是因为下标从0开始</span></span><br><span class="line">				count[t]--;<span class="comment">// 放一个元素，减一</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (p = <span class="number">0</span>; p &lt; temp.length; p++) &#123;</span><br><span class="line">				arr[p] = temp[p];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 得到i的第d位上的数</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> i</span><br><span class="line">	 * <span class="doctag">@param</span> a取值为1到d位</span><br><span class="line">	 *            （从个位向前数）</span><br><span class="line">	 * <span class="doctag">@return</span></span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getdigit</span><span class="params">(<span class="keyword">int</span> arg, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= a; j++) &#123;</span><br><span class="line">			r = arg % <span class="number">10</span>;</span><br><span class="line">			arg = arg / <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"please input a order number and order"</span>);</span><br><span class="line">		System.out.println(<span class="string">"eg: 5 =====个数\n 回车\n 3======最高的位数（最高的数百位输入3）\n"</span></span><br><span class="line">				+ <span class="string">"  5 84 22 434 98(以空格隔开)"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span> + n);</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列最高的位数</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s2 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		d = s2.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"d="</span> + d);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s1 = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String line = s1.nextLine();</span><br><span class="line">		String[] split = line.split(<span class="string">"\\s"</span>);</span><br><span class="line">		<span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			arr[i] = Integer.parseInt(split[i]);</span><br><span class="line">			System.out.println(arr[i] + <span class="string">"地址： "</span> + i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 排序</span></span><br><span class="line">		radixSort(arr);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i : arr) &#123;</span><br><span class="line">			System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u4E5D_u3001_u6876_u6392_u5E8F"><a href="#u4E5D_u3001_u6876_u6392_u5E8F" class="headerlink" title="九、桶排序"></a>九、桶排序</h1><h2 id="1_u3001_u524D_u63D0-1"><a href="#1_u3001_u524D_u63D0-1" class="headerlink" title="1、前提"></a>1、前提</h2><p><em>输入数据均匀分布在[0,1)上</em></p>
<h2 id="2_u3001_u601D_u60F3-1"><a href="#2_u3001_u601D_u60F3-1" class="headerlink" title="2、思想"></a>2、思想</h2><p><strong>因为对数据有要求，所以可以把数据分别放入不同的链表(桶)中。在桶内排好序，再依次按桶输出即可</strong></p>
<h2 id="3_u3001_u5B9E_u73B0-1"><a href="#3_u3001_u5B9E_u73B0-1" class="headerlink" title="3、实现"></a>3、实现</h2><blockquote>
<ul>
<li>有一链表数组(桶)，大小为10(有10个小桶)。</li>
<li>给每个元素乘10，以元素的个位数字为准放入对应序号的小桶内。</li>
<li>每个小桶内采用排序。</li>
<li>按照小桶的序号，依次输出里面的元素。</li>
</ul>
</blockquote>
<h2 id="4_u3001_u4EE3_u7801"><a href="#4_u3001_u4EE3_u7801" class="headerlink" title="4、代码"></a>4、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.plaf.metal.MetalIconFactory.FolderIcon16;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 桶排序 假设：输入数据服从均匀分布，均匀、独立的分布在[0,1)上。</span><br><span class="line"> * </span><br><span class="line"> * Author: Wayne 13186259527@163.com</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BucketSort</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Random r = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">		<span class="keyword">float</span> value;</span><br><span class="line">		Node next;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">float</span> arr)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = arr;</span><br><span class="line">			<span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">setNext</span><span class="params">(Node next)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.next = next;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function">Node <span class="title">getEnd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			Node p = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">for</span> (p = <span class="keyword">this</span>; p.next != <span class="keyword">null</span>; p = p.next) &#123;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> p;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"请输入序列个数n"</span>);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入序列个数n</span><br><span class="line">		 */</span></span><br><span class="line">		Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">int</span> n = s.nextInt();</span><br><span class="line">		System.out.println(<span class="string">"n="</span> + n);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 链表</span><br><span class="line">		 */</span></span><br><span class="line">		Node list[] = <span class="keyword">new</span> Node[<span class="number">10</span>];</span><br><span class="line">		Node point = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">float</span> arr[] = <span class="keyword">new</span> <span class="keyword">float</span>[n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 产生只有2位小数的[0,1)的随机数 Math.floor():向下取整函数</span><br><span class="line">			 */</span></span><br><span class="line">			arr[i] = (<span class="keyword">float</span>) (Math.floor(Math.random() * <span class="number">100</span>) / <span class="number">100</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 排序</span></span><br><span class="line">		Bucketsort(arr, list);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输出源数据</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">			System.out.println(<span class="string">"arr["</span> + i + <span class="string">"] = "</span> + arr[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"==========================="</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">			point = list[i];</span><br><span class="line">			<span class="comment">// 打印每个链表中的所有数据</span></span><br><span class="line">			<span class="keyword">while</span> (point != <span class="keyword">null</span>) &#123;</span><br><span class="line">				System.out.println(<span class="string">"list["</span> + i + <span class="string">"].value: "</span> + point.value);</span><br><span class="line">				point = point.next;</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">"----"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> arr 存放输入数据的数组</span><br><span class="line">	 * <span class="doctag">@param</span> list 链表数组(桶)</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Bucketsort</span><span class="params">(<span class="keyword">float</span>[] arr, Node[] list)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> t;</span><br><span class="line">		Node point;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 将数据都挂在一个数组链表中。</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 例如arr[i] = 0.58 t = 5 5这个节点就被挂到list[5]后面</span><br><span class="line">			 */</span></span><br><span class="line">			t = (<span class="keyword">int</span>) Math.floor(arr[i] * <span class="number">10</span>);</span><br><span class="line">			point = <span class="keyword">new</span> Node(arr[i]);</span><br><span class="line">			<span class="keyword">if</span> (list[t] == <span class="keyword">null</span>) &#123;</span><br><span class="line">				list[t] = point;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="comment">// 挂链</span></span><br><span class="line">				list[t].getEnd().setNext(point);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">			point = list[i];</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 桶内排序 把每一个链表里面的数据都排为升序</span><br><span class="line">			 */</span></span><br><span class="line">			point = InBuckSort(point);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> point链表表头</span><br><span class="line">	 * @ p 工作指针 </span><br><span class="line">	 * @ q 遍历链表，找当前最小的节点 </span><br><span class="line">	 * @ M 指向当前已排序的最后一个节点</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Node <span class="title">InBuckSort</span><span class="params">(Node point)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (point != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">			Node p = <span class="keyword">null</span>, q = <span class="keyword">null</span>, Min = <span class="keyword">null</span>, M = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">float</span> tmp;</span><br><span class="line">			M = point;</span><br><span class="line">			<span class="keyword">for</span> (p = point; p.next != <span class="keyword">null</span>; p = p.next) &#123;</span><br><span class="line">				Min = p;</span><br><span class="line">				<span class="keyword">for</span> (q = p.next; q != <span class="keyword">null</span>; q = q.next) &#123;</span><br><span class="line">					<span class="keyword">if</span> (q.value &lt; Min.value) &#123;</span><br><span class="line">						Min = q;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				tmp = Min.value;</span><br><span class="line">				Min.value = M.value;</span><br><span class="line">				M.value = tmp;</span><br><span class="line">				<span class="comment">// 让M节点向后移动，来放下一个最小的元素</span></span><br><span class="line">				M = M.next;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> point;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u4E00_u3001_u76F4_u63A5_u63D2_u5165_u6392_u5E8F"><a href="#u4E00_u3001_u76F4_u63A5_u63D2_u5165_u6392_u5E8F" class="headerlink" title="一、直接插入排序"></a>一、直接插入排序</h1><h2 id="uFF11_u3001_u601D_u60F3"><a href="#uFF11_u3001_u601D_u60F3" class="headerlink" title="１、思想"></a>１、思想</h2><p><strong>从第二个元素到末尾，逐个向前面的有序序列插入，使之成为有序序列。</strong></p>
<blockquote>
<ul>
<li>插入过程在有序序列中从后向前比较，遇到比当前元素大的元素，则把它向后移动一个。<br> 遇到比当前元素小的元素，直接break。把当前元素放到比它小的元素的下一个。]]>
    
    </summary>
    
      <category term="算法" scheme="http://crazyhoney.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用Java操作Solr实现增、删和查询数据]]></title>
    <link href="http://crazyhoney.github.io/2016/04/27/%E4%BD%BF%E7%94%A8Java%E6%93%8D%E4%BD%9CSolr%E5%AE%9E%E7%8E%B0%E5%A2%9E%E3%80%81%E5%88%A0%E5%92%8C%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE/"/>
    <id>http://crazyhoney.github.io/2016/04/27/使用Java操作Solr实现增、删和查询数据/</id>
    <published>2016-04-27T02:52:18.000Z</published>
    <updated>2016-05-04T14:42:44.307Z</updated>
    <content type="html"><![CDATA[<h1 id="u4E00_u3001Solr_u7684_u7B80_u4ECB"><a href="#u4E00_u3001Solr_u7684_u7B80_u4ECB" class="headerlink" title="一、Solr的简介"></a>一、Solr的简介</h1><h1 id="u4E8C_u3001Java_u64CD_u4F5Csolr"><a href="#u4E8C_u3001Java_u64CD_u4F5Csolr" class="headerlink" title="二、Java操作solr"></a>二、Java操作solr</h1><h2 id="1_u3001_u6DFB_u52A0maven_u4F9D_u8D56"><a href="#1_u3001_u6DFB_u52A0maven_u4F9D_u8D56" class="headerlink" title="1、添加maven依赖"></a>1、添加maven依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.solr<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>solr-solrj<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>4.10.4<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="2_u3001_u4EE3_u7801_u5F15_u5305"><a href="#2_u3001_u4EE3_u7801_u5F15_u5305" class="headerlink" title="2、代码引包"></a>2、代码引包</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.impl.HttpSolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.response.QueryResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.response.SpellCheckResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.response.SpellCheckResponse.Suggestion;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.response.UpdateResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocumentList;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrInputDocument;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br></pre></td></tr></table></figure>
<h2 id="3_u3001_u83B7_u53D6solr_u94FE_u63A5"><a href="#3_u3001_u83B7_u53D6solr_u94FE_u63A5" class="headerlink" title="3、获取solr链接"></a>3、获取solr链接</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String baseURL = <span class="string">"http://192.168.255.128:8983/solr"</span>;<span class="comment">//注意：如果baseurl后面没有具体指定对应core的名称的话，默认会请求cleection1这个core</span></span><br><span class="line"><span class="comment">//获取solr的服务连接</span></span><br><span class="line">HttpSolrServer server = <span class="keyword">new</span> HttpSolrServer(baseURL);</span><br></pre></td></tr></table></figure>
<h2 id="4_u3001_u67E5_u8BE2_u6570_u636E"><a href="#4_u3001_u67E5_u8BE2_u6570_u636E" class="headerlink" title="4、查询数据"></a>4、查询数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//封装solr的查询对象</span></span><br><span class="line">		SolrQuery params = <span class="keyword">new</span> SolrQuery();</span><br><span class="line">		params.set(<span class="string">"q"</span>, <span class="string">"*:*"</span>);</span><br><span class="line">		QueryResponse response = server.query(params);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取solr查询的结果</span></span><br><span class="line">		SolrDocumentList results = response.getResults();</span><br><span class="line">		<span class="comment">//这个返回的是一个数据总数</span></span><br><span class="line">		<span class="keyword">long</span> numFound = results.getNumFound();</span><br><span class="line">		System.out.println(<span class="string">"数据总条数："</span>+numFound);<span class="comment">//注意：获取查询数据总数的话，需要使用getNumFound，如果直接获取SolrDocumentList的长度的话，只能返回一页数据的数量</span></span><br><span class="line">		<span class="keyword">for</span> (SolrDocument solrDocument : results) &#123;</span><br><span class="line">			<span class="comment">//System.out.println(solrDocument.toString());</span></span><br><span class="line">			<span class="comment">//获取每一个document中的所有字段</span></span><br><span class="line">			Collection&lt;String&gt; fieldNames = solrDocument.getFieldNames();</span><br><span class="line">			<span class="keyword">for</span> (String field : fieldNames) &#123;</span><br><span class="line">				System.out.println(field+<span class="string">"--"</span>+solrDocument.get(field));</span><br><span class="line">			&#125;</span><br><span class="line">			System.err.println(<span class="string">"========================================="</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5_u3001_u6DFB_u52A0_u6570_u636E"><a href="#5_u3001_u6DFB_u52A0_u6570_u636E" class="headerlink" title="5、添加数据"></a>5、添加数据</h2><h3 id="u65B9_u5F0F_u4E00_3A"><a href="#u65B9_u5F0F_u4E00_3A" class="headerlink" title="方式一:"></a>方式一:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		SolrInputDocument doc = <span class="keyword">new</span> SolrInputDocument();</span><br><span class="line">		doc.setField(<span class="string">"id"</span>, <span class="string">"9527"</span>);</span><br><span class="line">		doc.setField(<span class="string">"name"</span>, <span class="string">"JJ"</span>);</span><br><span class="line">		doc.setField(<span class="string">"last_modified"</span>, <span class="keyword">new</span> Date());</span><br><span class="line">		server.add(doc );</span><br><span class="line">		<span class="comment">//提交数据</span></span><br><span class="line">		server.commit();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="u65B9_u5F0F_u4E8C_3A"><a href="#u65B9_u5F0F_u4E8C_3A" class="headerlink" title="方式二:"></a>方式二:</h3><blockquote>
<ul>
<li>使用HttpSolrServer.addBean(object)这种方式</li>
</ul>
</blockquote>
<p><strong>Student类</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span><br><span class="line"> * Student.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年4月26日 下午3:50:03</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">package</span> Solr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.beans.Field;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Field</span></span><br><span class="line">	<span class="keyword">private</span> String id;</span><br><span class="line">	<span class="annotation">@Field</span></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="annotation">@Field</span></span><br><span class="line">	<span class="keyword">private</span> String favour;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFavour</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> favour;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFavour</span><span class="params">(String favour)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.favour = favour;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>注：只有被@Field修饰的字段才可以被solr识别</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testadd2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Student student = <span class="keyword">new</span> Student();</span><br><span class="line">		student.setId(<span class="string">"224"</span>);</span><br><span class="line">		student.setName(<span class="string">"集中营"</span>);</span><br><span class="line">		<span class="comment">// favour字段schema.xml中没有，需要向里面添加</span></span><br><span class="line">		student.setFavour(<span class="string">"Movie"</span>);</span><br><span class="line">		server.addBean(student);</span><br><span class="line">		server.commit();</span><br><span class="line">		System.out.println(<span class="string">"添加成功"</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>但是一执行，报错了！</strong><br>    unknown field :favour</p>
<p><em>纳闷了，我明明在Student类里favour字段前加了@Field注释啊。<br>为毛还会报这个错。</em></p>
<p>百度之，原因如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">	 * 添加数据时，如果添加的字段schema.xml中没有，会报错：unknown filed 解决：可以自行向schema.xml中添加该字段</span><br><span class="line">	 * 如下例中的favour字段</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@throws</span> Exception</span><br><span class="line">	 */</span></span><br></pre></td></tr></table></figure></p>
<p><strong>添加favour字段信息，搞定！</strong></p>
<h2 id="6_u3001_u5220_u9664_u6570_u636E"><a href="#6_u3001_u5220_u9664_u6570_u636E" class="headerlink" title="6、删除数据"></a>6、删除数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testdel</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// server.deleteById("9527");</span></span><br><span class="line">		server.deleteByQuery(<span class="string">"name:224集中营"</span>);</span><br><span class="line">		server.commit();</span><br><span class="line">		System.out.println(<span class="string">"删除成功"</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7_u3001_u62FC_u5199_u68C0_u67E5"><a href="#7_u3001_u62FC_u5199_u68C0_u67E5" class="headerlink" title="7、拼写检查"></a>7、拼写检查</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">	 * solr中的拼写检查</span><br><span class="line">	 * 注意：当把schema文件中的text字段的类型改为text_ik的时候，</span><br><span class="line">	 * 执行这个代码会报错</span><br><span class="line">	 * 解决方案：</span><br><span class="line">	 * 	1：修改schema.xml文件中的name字段的类型，页修改我日text_ik</span><br><span class="line">	 * 	2：修改solrconfig.xml文件中的第1315行，吧text_genery，修改为text_ik	</span><br><span class="line">	 * <span class="doctag">@throws</span> Exception</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="annotation">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		SolrQuery solrQuery = <span class="keyword">new</span> SolrQuery();</span><br><span class="line">		solrQuery.set(<span class="string">"qt"</span>, <span class="string">"/spell"</span>);</span><br><span class="line">		solrQuery.set(<span class="string">"q"</span>, <span class="string">"text:Samsang"</span>);</span><br><span class="line">		QueryResponse response = server.query(solrQuery);</span><br><span class="line">		SolrDocumentList results = response.getResults();</span><br><span class="line">		<span class="keyword">long</span> numFound = results.getNumFound();</span><br><span class="line">		<span class="keyword">if</span>(numFound==<span class="number">0</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"拼写错误！"</span>);</span><br><span class="line">			SpellCheckResponse spellCheckResponse = response.getSpellCheckResponse();</span><br><span class="line">			List&lt;Suggestion&gt; suggestions = spellCheckResponse.getSuggestions();<span class="comment">//这个list里面保存了多个字段的建议值</span></span><br><span class="line">			<span class="keyword">for</span> (Suggestion suggestion : suggestions) &#123;</span><br><span class="line">				<span class="keyword">int</span> numFound2 = suggestion.getNumFound();</span><br><span class="line">				System.out.println(<span class="string">"推荐的单词个数："</span>+numFound2);</span><br><span class="line">				List&lt;String&gt; alternatives = suggestion.getAlternatives();<span class="comment">//返回的是一个字段的建议值</span></span><br><span class="line">				<span class="keyword">for</span> (String string : alternatives) &#123;</span><br><span class="line">					System.out.println(string);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">for</span> (SolrDocument solrDocument : results) &#123;</span><br><span class="line">				<span class="comment">//System.out.println(solrDocument.toString());</span></span><br><span class="line">				<span class="comment">//获取每一个document中的所有字段</span></span><br><span class="line">				Collection&lt;String&gt; fieldNames = solrDocument.getFieldNames();</span><br><span class="line">				<span class="keyword">for</span> (String field : fieldNames) &#123;</span><br><span class="line">					System.out.println(field+<span class="string">"--"</span>+solrDocument.get(field));</span><br><span class="line">				&#125;</span><br><span class="line">				System.err.println(<span class="string">"========================================="</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u4E00_u3001Solr_u7684_u7B80_u4ECB"><a href="#u4E00_u3001Solr_u7684_u7B80_u4ECB" class="headerlink" title="一、Solr的简介"></a>一、Solr的简介</h1><h1 id="u4E8C_u3001Java_u64CD_u4F5Csolr"><a href="#u4E8C_u3001Java_u64CD_u4F5Csolr" class="headerlink" title="二、Java操作solr"></a>二、Java操作solr</h1><h2 id="1_u3001_u6DFB_u52A0maven_u4F9D_u8D56"><a href="#1_u3001_u6DFB_u52A0maven_u4F9D_u8D56" class="headerlink" title="1、添加maven依赖"></a>1、添加maven依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.solr<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>solr-solrj<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>4.10.4<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="Solr" scheme="http://crazyhoney.github.io/tags/Solr/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[HBase的触发器——Observer]]></title>
    <link href="http://crazyhoney.github.io/2016/04/20/HBase%E7%9A%84%E8%A7%A6%E5%8F%91%E5%99%A8%E2%80%94%E2%80%94Observer/"/>
    <id>http://crazyhoney.github.io/2016/04/20/HBase的触发器——Observer/</id>
    <published>2016-04-20T09:57:59.000Z</published>
    <updated>2016-05-04T14:40:01.146Z</updated>
    <content type="html"><![CDATA[<p>HBase中的observer分为三类:</p>
<p>MasterObserver、RegionObserver、WALOBserver。</p>
<h2 id="u81EA_u5B9A_u4E49MasterObserver"><a href="#u81EA_u5B9A_u4E49MasterObserver" class="headerlink" title="自定义MasterObserver"></a>自定义MasterObserver</h2><h2 id="1_u3001_u7EE7_u627FBaseMasterObserver_u7C7B"><a href="#1_u3001_u7EE7_u627FBaseMasterObserver_u7C7B" class="headerlink" title="1、继承BaseMasterObserver类"></a>1、继承BaseMasterObserver类</h2><p>(是MasterObserver的默认实现类)</p>
<blockquote>
<ul>
<li>覆盖其中的方法，实现需求</li>
</ul>
</blockquote>
<h2 id="2_u3001_u6253_u6210jar_u5305_uFF0C_u653E_u5230hbase_u7684lib_u76EE_u5F55_u4E0B"><a href="#2_u3001_u6253_u6210jar_u5305_uFF0C_u653E_u5230hbase_u7684lib_u76EE_u5F55_u4E0B" class="headerlink" title="2、打成jar包，放到hbase的lib目录下"></a>2、打成jar包，放到hbase的lib目录下</h2><h2 id="3_u300112-4-3-_u4FEE_u6539hbase_u7684_u914D_u7F6E_u6587_u4EF6hbase-site-xml_u6587_u4EF6"><a href="#3_u300112-4-3-_u4FEE_u6539hbase_u7684_u914D_u7F6E_u6587_u4EF6hbase-site-xml_u6587_u4EF6" class="headerlink" title="3、12.4.3.修改hbase的配置文件hbase-site.xml文件"></a>3、12.4.3.修改hbase的配置文件hbase-site.xml文件</h2><p><strong>增加如下内容</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>hbase.coprocessor.master.classes<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">value</span>&gt;</span>自己写的类的全路径名<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<h2 id="4_u3001_u91CD_u542FHBase_u96C6_u7FA4"><a href="#4_u3001_u91CD_u542FHBase_u96C6_u7FA4" class="headerlink" title="4、重启HBase集群"></a>4、重启HBase集群</h2><p><strong>在重启集群的时候，使用tail -f  …/hbse…master.log文件输出，判断是否出错。</strong></p>
<h2 id="5_u3001_u4EE3_u7801"><a href="#5_u3001_u4EE3_u7801" class="headerlink" title="5、代码"></a>5、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * PreCreateTableObserver.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年4月20日 下午3:20:20</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">package</span> HBase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HRegionInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HTableDescriptor;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.coprocessor.BaseMasterObserver;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.coprocessor.MasterCoprocessorEnvironment;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.coprocessor.ObserverContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.commons.logging.Log;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.commons.logging.LogFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PreCreateTableObserver</span> <span class="keyword">extends</span> <span class="title">BaseMasterObserver</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	Log log = LogFactory.getLog(PreCreateTableObserver.class);</span><br><span class="line">	<span class="comment">/* (non-Javadoc)</span><br><span class="line">	 * @see org.apache.hadoop.hbase.coprocessor.BaseMasterObserver#preCreateTable(org.apache.hadoop.hbase.coprocessor.ObserverContext, org.apache.hadoop.hbase.HTableDescriptor, org.apache.hadoop.hbase.HRegionInfo[])</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preCreateTable</span><span class="params">(</span><br><span class="line">			ObserverContext&lt;MasterCoprocessorEnvironment&gt; ctx,</span><br><span class="line">			HTableDescriptor desc, HRegionInfo[] regions)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		log.info(<span class="string">"\n这段代码被执行了\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u516D_u3001_u6D4B_u8BD5"><a href="#u516D_u3001_u6D4B_u8BD5" class="headerlink" title="六、测试"></a>六、测试</h2><p>在hbase建表后，查看master.log.发现：<br><img src="http://ww2.sinaimg.cn/large/75544e9fjw1f33buutj2oj20rn0akahr.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>HBase中的observer分为三类:</p>
<p>MasterObserver、RegionObserver、WALOBserver。</p>
<h2 id="u81EA_u5B9A_u4E49MasterObserver"><a href="#u81EA_u5B9A_u4E49MasterObserver" class="headerlink" title="自定义MasterObserver"></a>自定义MasterObserver</h2><h2 id="1_u3001_u7EE7_u627FBaseMasterObserver_u7C7B"><a href="#1_u3001_u7EE7_u627FBaseMasterObserver_u7C7B" class="headerlink" title="1、继承BaseMasterObserver类"></a>1、继承BaseMasterObserver类</h2><p>(是MasterObserver的默认实现类)</p>
<blockquote>
<ul>
<li>覆盖其中的方法，实现需求</li>
</ul>
</blockquote>
<h2 id="2_u3001_u6253_u6210jar_u5305_uFF0C_u653E_u5230hbase_u7684lib_u76EE_u5F55_u4E0B"><a href="#2_u3001_u6253_u6210jar_u5305_uFF0C_u653E_u5230hbase_u7684lib_u76EE_u5F55_u4E0B" class="headerlink" title="2、打成jar包，放到hbase的lib目录下"></a>2、打成jar包，放到hbase的lib目录下</h2><h2 id="3_u300112-4-3-_u4FEE_u6539hbase_u7684_u914D_u7F6E_u6587_u4EF6hbase-site-xml_u6587_u4EF6"><a href="#3_u300112-4-3-_u4FEE_u6539hbase_u7684_u914D_u7F6E_u6587_u4EF6hbase-site-xml_u6587_u4EF6" class="headerlink" title="3、12.4.3.修改hbase的配置文件hbase-site.xml文件"></a>3、12.4.3.修改hbase的配置文件hbase-site.xml文件</h2><p><strong>增加如下内容</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>hbase.coprocessor.master.classes<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">value</span>&gt;</span>自己写的类的全路径名<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br></pre></td></tr></table></figure></p>]]>
    
    </summary>
    
      <category term="HBase" scheme="http://crazyhoney.github.io/tags/HBase/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用Hive查询HBase数据]]></title>
    <link href="http://crazyhoney.github.io/2016/04/20/%E4%BD%BF%E7%94%A8Hive%E6%9F%A5%E8%AF%A2HBase%E6%95%B0%E6%8D%AE/"/>
    <id>http://crazyhoney.github.io/2016/04/20/使用Hive查询HBase数据/</id>
    <published>2016-04-20T02:25:02.000Z</published>
    <updated>2016-05-04T14:42:31.960Z</updated>
    <content type="html"><![CDATA[<h1 id="u4E00_u3001_u914D_u7F6E"><a href="#u4E00_u3001_u914D_u7F6E" class="headerlink" title="一、配置"></a>一、配置</h1><h2 id="1_u3001_u6574_u5408_u5DE5_u5177_u7C7B"><a href="#1_u3001_u6574_u5408_u5DE5_u5177_u7C7B" class="headerlink" title="1、整合工具类"></a>1、整合工具类</h2><h3 id="281_29_u3001_u7248_u672C_u95EE_u9898"><a href="#281_29_u3001_u7248_u672C_u95EE_u9898" class="headerlink" title="(1)、版本问题"></a>(1)、版本问题</h3><blockquote>
<ul>
<li>我使用的是Hive-0.14.0和hbase-0.98.8</li>
</ul>
</blockquote>
<p><strong>hive-Hbase-handler-0.14.0.jar</strong></p>
<p><em>这个版本是跟着hive的</em></p>
<h3 id="282_29_u3001_u6839_u636Ehive_u7248_u672C_u786E_u5B9Ahbase_u7248_u672C"><a href="#282_29_u3001_u6839_u636Ehive_u7248_u672C_u786E_u5B9Ahbase_u7248_u672C" class="headerlink" title="(2)、根据hive版本确定hbase版本"></a>(2)、根据hive版本确定hbase版本</h3><h4 id="u2460_u3001_u5728maven_u4ED3_u5E93_u627E_u5230_u5BF9_u5E94_u7684_u4F9D_u8D56_u6DFB_u52A0_u5230pom-xml_uFF0C_u4F8B_u5982_uFF1A"><a href="#u2460_u3001_u5728maven_u4ED3_u5E93_u627E_u5230_u5BF9_u5E94_u7684_u4F9D_u8D56_u6DFB_u52A0_u5230pom-xml_uFF0C_u4F8B_u5982_uFF1A" class="headerlink" title="①、在maven仓库找到对应的依赖添加到pom.xml，例如："></a>①、在maven仓库找到对应的依赖添加到pom.xml，例如：</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-hbase-handler<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<blockquote>
<ul>
<li>在下载好的jar包/META-INF/maven/DEPENDENCIES中，找到hbase的版本</li>
</ul>
</blockquote>
<p><em>例如：</em>hive-Hbase-handler-0.14.0.jar指明hbase的版本是0.98.3</p>
<blockquote>
<ul>
<li>我用的是0.98.8,小的版本差异不影响</li>
</ul>
</blockquote>
<h3 id="282_29_u3001jar_u5305_u5BFC_u5165"><a href="#282_29_u3001jar_u5305_u5BFC_u5165" class="headerlink" title="(2)、jar包导入"></a>(2)、jar包导入</h3><p><strong>把下载到的hive-hbase-handler-0.14.0.jar放到hive的lib目录下。</strong></p>
<h2 id="2_u3001_u8BBE_u7F6E_u73AF_u5883_u53D8_u91CF"><a href="#2_u3001_u8BBE_u7F6E_u73AF_u5883_u53D8_u91CF" class="headerlink" title="2、设置环境变量"></a>2、设置环境变量</h2><p>修改$HIVE_HOME/conf/hive-env.sh文件中的最后一行，内容如下：<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export <span class="constant">HIVE_AUX_JARS_PATH</span>=<span class="regexp">/usr/local</span><span class="regexp">/hive-0.14.0/lib</span><span class="regexp">/hive-hbase-handler-0.14.0.jar:/usr</span><span class="regexp">/local/hbase</span>-<span class="number">0.98</span>.<span class="number">8</span>-hadoop2/<span class="class"><span class="keyword">lib</span>/<span class="title">hbase</span>-<span class="title">client</span>-0.98.8-<span class="title">hadoop2</span>.<span class="title">jar</span>:/<span class="title">usr</span>/<span class="title">local</span>/<span class="title">hbase</span>-0.98.8-<span class="title">hadoop2</span>/<span class="title">lib</span>/<span class="title">zookeeper</span>-3.4.6.<span class="title">jar</span></span></span><br></pre></td></tr></table></figure></p>
<p><em>上述路径，根据自身情况配置</em></p>
<h1 id="u4E8C_u3001_u4F7F_u7528hive_u521B_u5EFAhbase_u8868"><a href="#u4E8C_u3001_u4F7F_u7528hive_u521B_u5EFAhbase_u8868" class="headerlink" title="二、使用hive创建hbase表"></a>二、使用hive创建hbase表</h1><h2 id="1_u3001_u5F00_u542Fhbase_u3001hive"><a href="#1_u3001_u5F00_u542Fhbase_u3001hive" class="headerlink" title="1、开启hbase、hive"></a>1、开启hbase、hive</h2><h2 id="2_u3001_u547D_u4EE4"><a href="#2_u3001_u547D_u4EE4" class="headerlink" title="2、命令"></a>2、命令</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> hivetohbase1(<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">name</span> <span class="keyword">string</span>) <span class="keyword">ROW</span> <span class="keyword">FORMAT</span> <span class="keyword">DELIMITED</span> <span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">','</span> </span><br><span class="line"><span class="keyword">STORED</span> <span class="keyword">BY</span> <span class="string">'org.apache.hadoop.hive.hbase.HBaseStorageHandler'</span> </span><br><span class="line"><span class="keyword">WITH</span> SERDEPROPERTIES ( </span><br><span class="line"><span class="string">"hbase.columns.mapping"</span> = <span class="string">":key,f1:c1"</span>, </span><br><span class="line"><span class="string">"hbase.table.name"</span> = <span class="string">"t1"</span> </span><br><span class="line">);</span></span><br></pre></td></tr></table></figure>
<p>上述：属性”hbase.columns.mapping”的值中间不能有任何空格。</p>
<h1 id="u4E8C_u3001_u4F7F_u7528hive_u5411hbase_u8868_u63D2_u5165_u6570_u636E"><a href="#u4E8C_u3001_u4F7F_u7528hive_u5411hbase_u8868_u63D2_u5165_u6570_u636E" class="headerlink" title="二、使用hive向hbase表插入数据"></a>二、使用hive向hbase表插入数据</h1><p><strong>只支持insert插入，不支持load data插入。</strong></p>
<h2 id="1_u3001_u547D_u4EE4"><a href="#1_u3001_u547D_u4EE4" class="headerlink" title="1、命令"></a>1、命令</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> hivetohbase(表名) <span class="keyword">select</span> *　<span class="keyword">from</span> (其他表);</span></span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> hivetohbase(表名) <span class="keyword">values</span>(...);</span></span><br></pre></td></tr></table></figure>
<h1 id="u4E09_u3001_u4F7F_u7528hive_u5173_u8054_u5DF2_u5B58_u5728_u7684hbase_u8868"><a href="#u4E09_u3001_u4F7F_u7528hive_u5173_u8054_u5DF2_u5B58_u5728_u7684hbase_u8868" class="headerlink" title="三、使用hive关联已存在的hbase表"></a>三、使用hive关联已存在的hbase表</h1><h2 id="1_u3001hbase_u8868_u7684_u6570_u636E"><a href="#1_u3001hbase_u8868_u7684_u6570_u636E" class="headerlink" title="1、hbase表的数据"></a>1、hbase表的数据</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">hbase</span><span class="params">(main)</span></span>:<span class="number">008</span>:<span class="number">0</span>&gt; scan <span class="string">'test1'</span></span><br><span class="line">ROW                          COLUMN+CELL                                                                       </span><br><span class="line"> one           column=<span class="tag">address</span>:home,timestamp=<span class="number">1460276233535</span>,value=taiyang                       </span><br><span class="line"> one           column=<span class="tag">address</span>:school,timestamp=<span class="number">1460370748876</span>,value=shiyan                      </span><br><span class="line"> two           column=<span class="tag">address</span>:home,timestamp=<span class="number">1460371067966</span>,value=beijing                       </span><br><span class="line"> two           column=<span class="tag">address</span>:school,timestamp=<span class="number">1460371058151</span>,value=sanyuan                     </span><br><span class="line"><span class="number">2</span> <span class="function"><span class="title">row</span><span class="params">(s)</span></span> <span class="keyword">in</span> <span class="number">0.2790</span> seconds</span><br></pre></td></tr></table></figure>
<h2 id="2_u3001_u7B2C_u4E00_u6B21_u5EFA_u8868"><a href="#2_u3001_u7B2C_u4E00_u6B21_u5EFA_u8868" class="headerlink" title="2、第一次建表"></a>2、第一次建表</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; create external table hbasetest1(id int, home string, school string) row format delimited fields terminated by ','</span><br><span class="line">    &gt; stored by 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'</span><br><span class="line">    &gt; with serdeproperties(</span><br><span class="line">    &gt; "hbase.columns.mapping" = ":key,address:name,address:school", </span><br><span class="line">    &gt; "hbase.table.name" = "test1"</span><br><span class="line">    &gt; );</span><br></pre></td></tr></table></figure>
<p><strong>查询：</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from hbasetest1;</span><br><span class="line">OK</span><br><span class="line">NULL    NULL    shiyan</span><br><span class="line">NULL    NULL    sanyuan</span><br></pre></td></tr></table></figure></p>
<blockquote>
<ul>
<li>问题：id和name没有显示。</li>
<li>发现：上面的建表语句”hbase.columns.mapping”属性的值写错了，把home写成了name.</li>
</ul>
</blockquote>
<h2 id="3_u3001_u7B2C_u4E8C_u6B21_u5EFA_u8868"><a href="#3_u3001_u7B2C_u4E8C_u6B21_u5EFA_u8868" class="headerlink" title="3、第二次建表"></a>3、第二次建表</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; create external table hbasetest1two(id int, home string, school string) row format delimited fields terminated by ','</span><br><span class="line">    &gt; stored by 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'</span><br><span class="line">    &gt; with serdeproperties(</span><br><span class="line">    &gt; "hbase.columns.mapping" = ":key,address:home,address:school", </span><br><span class="line">    &gt; "hbase.table.name" = "test1"</span><br><span class="line">    &gt; );</span><br></pre></td></tr></table></figure>
<p><strong>查询：</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from hbasetest1two;</span><br><span class="line">OK</span><br><span class="line">NULL    taiyang shiyan</span><br><span class="line">NULL    beijing sanyuan</span><br><span class="line">Time taken: 0.136 seconds, Fetched: 2 row(s)</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>问题：id没有显示。</li>
<li>发现：上面的建表语句，hive表中的id是int型，而hbase表中rowkey是string类型，不匹配所以报错。</li>
</ul>
</blockquote>
<h2 id="3_u3001_u7B2C_u4E09_u6B21_u5EFA_u8868"><a href="#3_u3001_u7B2C_u4E09_u6B21_u5EFA_u8868" class="headerlink" title="3、第三次建表"></a>3、第三次建表</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; create external table hbasetest1three(id string, home string, school string) row format delimited fields terminated by ','</span><br><span class="line">    &gt; stored by 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'</span><br><span class="line">    &gt; with serdeproperties(</span><br><span class="line">    &gt; "hbase.columns.mapping" = ":key,address:home,address:school", </span><br><span class="line">    &gt; "hbase.table.name" = "test1"</span><br><span class="line">    &gt; );</span><br></pre></td></tr></table></figure>
<p><strong>查询：</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from hbasetest1three;</span><br><span class="line">OK</span><br><span class="line">one     taiyang shiyan</span><br><span class="line">two     beijing sanyuan</span><br><span class="line">Time taken: 0.158 seconds, Fetched: 2 row(s)</span><br></pre></td></tr></table></figure>
<p><strong>成功~</strong></p>
<h1 id="u56DB_u3001_u6CE8_u610F"><a href="#u56DB_u3001_u6CE8_u610F" class="headerlink" title="四、注意"></a>四、注意</h1><blockquote>
<ul>
<li>使用hive创建hbase表，表中的数据时在hbase中存储的，hive中没有</li>
</ul>
</blockquote>
<p><strong>证实：HDFS中/user/hive/warehouse/该表 中没有任何数据</strong></p>
<blockquote>
<ul>
<li>使用hive关联已存在的hbase表,用的是外部表，数据更不在hive中</li>
</ul>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u4E00_u3001_u914D_u7F6E"><a href="#u4E00_u3001_u914D_u7F6E" class="headerlink" title="一、配置"></a>一、配置</h1><h2 id="1_u3001_u6574_u5408_u5DE5_u5177_u7C7B"><a href="#1_u3001_u6574_u5408_u5DE5_u5177_u7C7B" class="headerlink" title="1、整合工具类"></a>1、整合工具类</h2><h3 id="281_29_u3001_u7248_u672C_u95EE_u9898"><a href="#281_29_u3001_u7248_u672C_u95EE_u9898" class="headerlink" title="(1)、版本问题"></a>(1)、版本问题</h3><blockquote>
<ul>
<li>我使用的是Hive-0.14.0和hbase-0.98.8</li>
</ul>
</blockquote>
<p><strong>hive-Hbase-handler-0.14.0.jar</strong></p>
<p><em>这个版本是跟着hive的</em></p>
<h3 id="282_29_u3001_u6839_u636Ehive_u7248_u672C_u786E_u5B9Ahbase_u7248_u672C"><a href="#282_29_u3001_u6839_u636Ehive_u7248_u672C_u786E_u5B9Ahbase_u7248_u672C" class="headerlink" title="(2)、根据hive版本确定hbase版本"></a>(2)、根据hive版本确定hbase版本</h3><h4 id="u2460_u3001_u5728maven_u4ED3_u5E93_u627E_u5230_u5BF9_u5E94_u7684_u4F9D_u8D56_u6DFB_u52A0_u5230pom-xml_uFF0C_u4F8B_u5982_uFF1A"><a href="#u2460_u3001_u5728maven_u4ED3_u5E93_u627E_u5230_u5BF9_u5E94_u7684_u4F9D_u8D56_u6DFB_u52A0_u5230pom-xml_uFF0C_u4F8B_u5982_uFF1A" class="headerlink" title="①、在maven仓库找到对应的依赖添加到pom.xml，例如："></a>①、在maven仓库找到对应的依赖添加到pom.xml，例如：</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-hbase-handler<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="Hive" scheme="http://crazyhoney.github.io/tags/Hive/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用MapReduce向HBase导入数据]]></title>
    <link href="http://crazyhoney.github.io/2016/04/18/%E4%BD%BF%E7%94%A8MapReduce%E5%90%91HBase%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/"/>
    <id>http://crazyhoney.github.io/2016/04/18/使用MapReduce向HBase导入数据/</id>
    <published>2016-04-18T10:00:48.000Z</published>
    <updated>2016-05-04T14:42:57.108Z</updated>
    <content type="html"><![CDATA[<h1 id="u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B"><a href="#u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B" class="headerlink" title="一、需要的工具类"></a>一、需要的工具类</h1><h2 id="1_u3001TableReducer"><a href="#1_u3001TableReducer" class="headerlink" title="1、TableReducer"></a>1、TableReducer</h2><p><em>作用：Reducer类继承该类，实现对HBase表的操作</em></p>
<h1 id="u4E8C_u3001_u9700_u8981_u5BFC_u5165_u7684_u6570_u636E"><a href="#u4E8C_u3001_u9700_u8981_u5BFC_u5165_u7684_u6570_u636E" class="headerlink" title="二、需要导入的数据"></a>二、需要导入的数据</h1><p><img src="http://ww4.sinaimg.cn/large/75544e9fjw1f318vclrilj20jq01j74u.jpg" alt=""><br><a id="more"></a></p>
<h1 id="u4E09_u3001_u5B9E_u73B0_u4EE3_u7801"><a href="#u4E09_u3001_u5B9E_u73B0_u4EE3_u7801" class="headerlink" title="三、实现代码"></a>三、实现代码</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * MRToHBase.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年4月18日 下午5:00:19</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">package</span> HBase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Put;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.mapreduce.TableOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.mapreduce.TableReducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.NullWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper.Context;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.TextInputFormat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MRToHBase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 本次使用另一种创建configuration的方式，</span><br><span class="line">		 * 不同于HBaseToMR的直接创建HBaseConfiguration。</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">final</span> Configuration configuration = <span class="keyword">new</span> Configuration();</span><br><span class="line">		<span class="comment">// 设置zookeeper</span></span><br><span class="line">		configuration.set(<span class="string">"hbase.zookeeper.quorum"</span>, <span class="string">"192.168.255.128"</span>);</span><br><span class="line">		<span class="comment">// 设置hbase表名称，从参数中读取</span></span><br><span class="line">		configuration.set(TableOutputFormat.OUTPUT_TABLE, args[<span class="number">0</span>]);</span><br><span class="line">		<span class="comment">// 将该值改大，防止hbase超时退出</span></span><br><span class="line">		configuration.set(<span class="string">"dfs.socket.timeout"</span>, <span class="string">"180000"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">final</span> Job job = Job.getInstance(configuration,</span><br><span class="line">				MRToHBase.class.getSimpleName());</span><br><span class="line">		TableMapReduceUtil.addDependencyJars(job);</span><br><span class="line">		job.setJarByClass(MRToHBase.class);</span><br><span class="line"></span><br><span class="line">		job.setMapperClass(BatchImportMapper.class);</span><br><span class="line">		job.setReducerClass(BatchImportReducer.class);</span><br><span class="line">		<span class="comment">// 设置map的输出，不设置reduce的输出类型</span></span><br><span class="line">		job.setMapOutputKeyClass(LongWritable.class);</span><br><span class="line">		job.setMapOutputValueClass(Text.class);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 不再设置输出路径，而是设置输出格式类型</span></span><br><span class="line">		job.setOutputFormatClass(TableOutputFormat.class);</span><br><span class="line">		<span class="comment">//设置输入的路径</span></span><br><span class="line">		FileInputFormat.setInputPaths(job, args[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">		job.waitForCompletion(<span class="keyword">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BatchImportMapper</span> <span class="keyword">extends</span></span><br><span class="line">			<span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">LongWritable</span>, <span class="title">Text</span>&gt; </span>&#123;</span><br><span class="line">		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key, Text value, Context context)</span></span><br><span class="line">				<span class="keyword">throws</span> java.io.IOException, InterruptedException </span>&#123;</span><br><span class="line">			<span class="comment">//Mapper类中，什么也不做，直接将数据写出</span></span><br><span class="line">			context.write(key, value);</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BatchImportReducer</span> <span class="keyword">extends</span></span><br><span class="line">			<span class="title">TableReducer</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">NullWritable</span>&gt; </span>&#123;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 数据一行中有列族：列这样的数据</span><br><span class="line">		 * 所以要用CF数组，将其分开</span><br><span class="line">		 */</span></span><br><span class="line">		String[] CF = &#123;&#125;;</span><br><span class="line">		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(LongWritable key,</span><br><span class="line">				java.lang.Iterable&lt;Text&gt; values, Context context)</span></span><br><span class="line">				<span class="keyword">throws</span> java.io.IOException, InterruptedException </span>&#123;</span><br><span class="line">			<span class="keyword">for</span> (Text text : values) &#123;</span><br><span class="line">				<span class="keyword">final</span> String[] splited = text.toString().split(<span class="string">"\t"</span>);</span><br><span class="line">				<span class="comment">//因为一行有两个数据所以要遍历</span></span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i = i + <span class="number">2</span>) &#123;</span><br><span class="line">					<span class="comment">//设置rowkey</span></span><br><span class="line">					<span class="keyword">final</span> Put put = <span class="keyword">new</span> Put(Bytes.toBytes(splited[<span class="number">0</span>]));</span><br><span class="line">					<span class="comment">//用“：”分隔开列族和列</span></span><br><span class="line">					<span class="comment">/**</span><br><span class="line">					 * 第一个元素的列族和列的下标为1和2</span><br><span class="line">					 * 第二个元素的列族和列的下标为3和4</span><br><span class="line">					 */</span></span><br><span class="line">					CF = splited[i].split(<span class="string">":"</span>);</span><br><span class="line">					<span class="comment">//动态的设置列族、列和值</span></span><br><span class="line">					put.add(Bytes.toBytes(CF[<span class="number">0</span>]), Bytes.toBytes(CF[<span class="number">1</span>]),</span><br><span class="line">							Bytes.toBytes(splited[i + <span class="number">1</span>]));</span><br><span class="line">					<span class="comment">//将数据写出</span></span><br><span class="line">					context.write(NullWritable.get(), put);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u56DB_u3001_u63D0_u4EA4_u8FD0_u884C"><a href="#u56DB_u3001_u63D0_u4EA4_u8FD0_u884C" class="headerlink" title="四、提交运行"></a>四、提交运行</h1><h2 id="1_u3001_u5F00_u542FHDFS_u3001YARN_u3001HBase_u3002"><a href="#1_u3001_u5F00_u542FHDFS_u3001YARN_u3001HBase_u3002" class="headerlink" title="1、开启HDFS、YARN、HBase。"></a>1、开启HDFS、YARN、HBase。</h2><h2 id="2_u3001_u8FD0_u884C_u4E0B_u9762_u547D_u4EE4_uFF1A"><a href="#2_u3001_u8FD0_u884C_u4E0B_u9762_u547D_u4EE4_uFF1A" class="headerlink" title="2、运行下面命令："></a>2、运行下面命令：</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar MRToHBase<span class="class">.jar</span> 表名 输入数据地址(HDFS目录)</span><br></pre></td></tr></table></figure>
<p><strong>eg:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar MRToHBase<span class="class">.jar</span> MRIN /user/root/HBaseToMR34</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>注意点1：运行命令会启动MR程序，结束时会报一个错误，但是没关系。只要出现了successfully的字眼，就成功了。</li>
<li>注意点2：如果HBase中指定的表没有导入的数据的列族的话，也会报错。所以要保证，被导入数据的HBase表要有对应的列族。</li>
</ul>
</blockquote>
<h1 id="u4E94_u3001_u7ED3_u679C"><a href="#u4E94_u3001_u7ED3_u679C" class="headerlink" title="五、结果"></a>五、结果</h1><p><img src="http://ww3.sinaimg.cn/large/75544e9fjw1f31a1xf7nqj20vm05h41c.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B"><a href="#u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B" class="headerlink" title="一、需要的工具类"></a>一、需要的工具类</h1><h2 id="1_u3001TableReducer"><a href="#1_u3001TableReducer" class="headerlink" title="1、TableReducer"></a>1、TableReducer</h2><p><em>作用：Reducer类继承该类，实现对HBase表的操作</em></p>
<h1 id="u4E8C_u3001_u9700_u8981_u5BFC_u5165_u7684_u6570_u636E"><a href="#u4E8C_u3001_u9700_u8981_u5BFC_u5165_u7684_u6570_u636E" class="headerlink" title="二、需要导入的数据"></a>二、需要导入的数据</h1><p><img src="http://ww4.sinaimg.cn/large/75544e9fjw1f318vclrilj20jq01j74u.jpg" alt=""><br>]]>
    
    </summary>
    
      <category term="HBase" scheme="http://crazyhoney.github.io/tags/HBase/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用MapReduce导出HBase数据]]></title>
    <link href="http://crazyhoney.github.io/2016/04/13/%E4%BD%BF%E7%94%A8MapReduce%E5%AF%BC%E5%87%BAHBase%E6%95%B0%E6%8D%AE/"/>
    <id>http://crazyhoney.github.io/2016/04/13/使用MapReduce导出HBase数据/</id>
    <published>2016-04-13T06:51:31.000Z</published>
    <updated>2016-05-04T14:43:09.530Z</updated>
    <content type="html"><![CDATA[<h1 id="u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B"><a href="#u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B" class="headerlink" title="一、需要的工具类"></a>一、需要的工具类</h1><h2 id="1_u3001TableMapReduceUtil"><a href="#1_u3001TableMapReduceUtil" class="headerlink" title="1、TableMapReduceUtil"></a>1、TableMapReduceUtil</h2><p><em>作用：设置传入MR的HBase的表名等信息</em></p>
<h2 id="2_u3001TableMapper"><a href="#2_u3001TableMapper" class="headerlink" title="2、TableMapper"></a>2、TableMapper</h2><p><em>作用：mapper类继承该类，实现对HBase表的操作</em></p>
<h1 id="u4E8C_u3001_u5B9E_u73B0_u7684_u7248_u672C"><a href="#u4E8C_u3001_u5B9E_u73B0_u7684_u7248_u672C" class="headerlink" title="二、实现的版本"></a>二、实现的版本</h1><h2 id="u7248_u672C_u4E00"><a href="#u7248_u672C_u4E00" class="headerlink" title="版本一"></a>版本一</h2><blockquote>
<ul>
<li>输入：表名，输出路径</li>
<li>输出：该表所有行的列族，列, 值到指定目录</li>
</ul>
</blockquote>
<h2 id="u7248_u672C_u4E8C"><a href="#u7248_u672C_u4E8C" class="headerlink" title="版本二"></a>版本二</h2><blockquote>
<ul>
<li>输入：表名，输出路径，一个列族：一个列</li>
<li>输出：该表所有行的该列族，该列, 值到指定目录</li>
</ul>
</blockquote>
<h2 id="u7248_u672C_u4E09"><a href="#u7248_u672C_u4E09" class="headerlink" title="版本三"></a>版本三</h2><blockquote>
<ul>
<li>输入：表名，输出路径，N，列族：列 。。。</li>
<li>输出：该表所有行的N个（列族，该列, 值）到指定目录</li>
</ul>
</blockquote>
<a id="more"></a>
<h1 id="u4E09_u3001_u5B9E_u73B0_u4EE3_u7801"><a href="#u4E09_u3001_u5B9E_u73B0_u4EE3_u7801" class="headerlink" title="三、实现代码"></a>三、实现代码</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * HBaseToMR.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年4月12日 下午7:53:47</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">package</span> HBase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.Cell;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.KeyValue;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.io.ImmutableBytesWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.mapreduce.TableMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HBaseToMR</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Configuration conf = HBaseConfiguration.create();</span><br><span class="line">		String tmp = <span class="string">""</span>;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * args: [0]	[1]			[2]							[3]...[ 3+args[2]-1 ]</span><br><span class="line">		 * 		表名	目的地址	N:(输入的列族：列的个数)	列族：列</span><br><span class="line">		 * 例如：</span><br><span class="line">		 * 		N=4     那么列族：列就是args[3...3+4-1]</span><br><span class="line">		 * </span><br><span class="line">		 * 这个for循环就是把所有的列族：列都拼接成一个字符串。以\t分隔</span><br><span class="line">		 */</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; <span class="number">3</span>+Integer.parseInt(args[<span class="number">2</span>]); i++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(i == <span class="number">3</span>+Integer.parseInt(args[<span class="number">2</span>])-<span class="number">1</span>)&#123;</span><br><span class="line">				<span class="comment">//最后一次拼接，后面不需要\t分隔。否则后面解析时会出现空字符</span></span><br><span class="line">				tmp = tmp + args[i];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				tmp = tmp + args[i] + <span class="string">"\t"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		conf.set(<span class="string">"clms"</span>, tmp);</span><br><span class="line"></span><br><span class="line">		Job job = Job.getInstance(conf, HBaseToMR.class.getSimpleName());</span><br><span class="line">		job.setJarByClass(HBaseToMR.class);</span><br><span class="line"></span><br><span class="line">		Scan scan = <span class="keyword">new</span> Scan();</span><br><span class="line"></span><br><span class="line">		TableMapReduceUtil.initTableMapperJob(args[<span class="number">0</span>], scan, MyMapper.class,</span><br><span class="line">				Text.class, Text.class, job);</span><br><span class="line"></span><br><span class="line">		job.setMapperClass(MyMapper.class);</span><br><span class="line">		job.setMapOutputKeyClass(Text.class);</span><br><span class="line">		job.setMapOutputValueClass(Text.class);</span><br><span class="line">		job.setNumReduceTasks(<span class="number">0</span>);</span><br><span class="line">		job.setOutputFormatClass(TextOutputFormat.class);</span><br><span class="line">		job.setOutputKeyClass(Text.class);</span><br><span class="line">		job.setOutputValueClass(Text.class);</span><br><span class="line"></span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">		job.waitForCompletion(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMapper</span> <span class="keyword">extends</span> <span class="title">TableMapper</span>&lt;<span class="title">Text</span>, <span class="title">Text</span>&gt; </span>&#123;</span><br><span class="line">		Text k2 = <span class="keyword">new</span> Text();</span><br><span class="line">		Text v2 = <span class="keyword">new</span> Text();</span><br><span class="line"></span><br><span class="line">		<span class="annotation">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(</span><br><span class="line">				ImmutableBytesWritable key,</span><br><span class="line">				Result value,</span><br><span class="line">				Mapper&lt;ImmutableBytesWritable, Result, Text, Text&gt;.Context context)</span></span><br><span class="line">				<span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">			k2.set(key.get());</span><br><span class="line">			String string = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 版本三</span><br><span class="line">			 * 输出该行的任意列族，任意列，值</span><br><span class="line">			 */</span></span><br><span class="line">			String clms = context.getConfiguration().get(<span class="string">"clms"</span>);</span><br><span class="line">			String[] split = clms.split(<span class="string">"\t"</span>);</span><br><span class="line">			<span class="keyword">for</span> (String cfAndQ : split) &#123;</span><br><span class="line">				</span><br><span class="line">				String[] split2 = cfAndQ.split(<span class="string">":"</span>);</span><br><span class="line">				String Family = split2[<span class="number">0</span>];</span><br><span class="line">				String Qualifier = split2[<span class="number">1</span>];</span><br><span class="line">				</span><br><span class="line">				Cell cell = value.getColumnLatestCell(Family.getBytes(), Qualifier.getBytes());</span><br><span class="line">				</span><br><span class="line">				string = string + Family+<span class="string">":"</span>+Qualifier + <span class="string">"\t"</span></span><br><span class="line">						+ <span class="keyword">new</span> String(cell.getValue()) + <span class="string">"\t"</span>;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 版本二</span><br><span class="line">			 * 输出该行的一个列族，一个列，一个值</span><br><span class="line">			 */</span><span class="comment">/*</span><br><span class="line">			String clms = context.getConfiguration().get("clms");</span><br><span class="line">			String[] split = clms.split(":");</span><br><span class="line">			String Family = split[0];</span><br><span class="line">			String Qualifier = split[1];</span><br><span class="line">			</span><br><span class="line">			Cell cell = value.getColumnLatestCell(Family.getBytes(), Qualifier.getBytes());</span><br><span class="line">			</span><br><span class="line">			string = Family + "\t" + Qualifier + "\t"</span><br><span class="line">					+ new String(cell.getValue());*/</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 版本一：</span><br><span class="line">			 * 输出该行的列族，列, 值</span><br><span class="line">			 */</span><span class="comment">/*</span><br><span class="line">			for (KeyValue keyValue : value.raw()) &#123;</span><br><span class="line">				string = string + new String(keyValue.getFamily()) + "\t"</span><br><span class="line">						+ new String(keyValue.getQualifier()) + "\t"</span><br><span class="line">						+ new String(keyValue.getValue());</span><br><span class="line">			&#125;*/</span></span><br><span class="line">			v2.set(string);</span><br><span class="line">			context.write(k2, v2);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u56DB_u3001_u63D0_u4EA4_u8FD0_u884C"><a href="#u56DB_u3001_u63D0_u4EA4_u8FD0_u884C" class="headerlink" title="四、提交运行"></a>四、提交运行</h1><h2 id="1_u3001_u5F00_u542FHDFS_u3001YARN_u3001HBase_u3002"><a href="#1_u3001_u5F00_u542FHDFS_u3001YARN_u3001HBase_u3002" class="headerlink" title="1、开启HDFS、YARN、HBase。"></a>1、开启HDFS、YARN、HBase。</h2><h2 id="2_u3001_u8FD0_u884C_u4E0B_u9762_u547D_u4EE4_uFF1A"><a href="#2_u3001_u8FD0_u884C_u4E0B_u9762_u547D_u4EE4_uFF1A" class="headerlink" title="2、运行下面命令："></a>2、运行下面命令：</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar HBaseToMR<span class="class">.jar</span> 表名 目的地址(HDFS目录) N 列族：列 。。。</span><br></pre></td></tr></table></figure>
<p><strong>eg:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar HBaseToMR<span class="class">.jar</span> test1 /user/root/HBaseToMR <span class="number">2</span> <span class="tag">address</span>:home <span class="tag">address</span>:school</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B"><a href="#u4E00_u3001_u9700_u8981_u7684_u5DE5_u5177_u7C7B" class="headerlink" title="一、需要的工具类"></a>一、需要的工具类</h1><h2 id="1_u3001TableMapReduceUtil"><a href="#1_u3001TableMapReduceUtil" class="headerlink" title="1、TableMapReduceUtil"></a>1、TableMapReduceUtil</h2><p><em>作用：设置传入MR的HBase的表名等信息</em></p>
<h2 id="2_u3001TableMapper"><a href="#2_u3001TableMapper" class="headerlink" title="2、TableMapper"></a>2、TableMapper</h2><p><em>作用：mapper类继承该类，实现对HBase表的操作</em></p>
<h1 id="u4E8C_u3001_u5B9E_u73B0_u7684_u7248_u672C"><a href="#u4E8C_u3001_u5B9E_u73B0_u7684_u7248_u672C" class="headerlink" title="二、实现的版本"></a>二、实现的版本</h1><h2 id="u7248_u672C_u4E00"><a href="#u7248_u672C_u4E00" class="headerlink" title="版本一"></a>版本一</h2><blockquote>
<ul>
<li>输入：表名，输出路径</li>
<li>输出：该表所有行的列族，列, 值到指定目录</li>
</ul>
</blockquote>
<h2 id="u7248_u672C_u4E8C"><a href="#u7248_u672C_u4E8C" class="headerlink" title="版本二"></a>版本二</h2><blockquote>
<ul>
<li>输入：表名，输出路径，一个列族：一个列</li>
<li>输出：该表所有行的该列族，该列, 值到指定目录</li>
</ul>
</blockquote>
<h2 id="u7248_u672C_u4E09"><a href="#u7248_u672C_u4E09" class="headerlink" title="版本三"></a>版本三</h2><blockquote>
<ul>
<li>输入：表名，输出路径，N，列族：列 。。。</li>
<li>输出：该表所有行的N个（列族，该列, 值）到指定目录</li>
</ul>
</blockquote>]]>
    
    </summary>
    
      <category term="HBase" scheme="http://crazyhoney.github.io/tags/HBase/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Java操作HBase的基本用法]]></title>
    <link href="http://crazyhoney.github.io/2016/04/11/Java%E6%93%8D%E4%BD%9CHBase%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/"/>
    <id>http://crazyhoney.github.io/2016/04/11/Java操作HBase的基本用法/</id>
    <published>2016-04-11T08:36:20.000Z</published>
    <updated>2016-05-04T14:41:33.834Z</updated>
    <content type="html"><![CDATA[<h1 id="u4E00_u3001_u5728maven_u5DE5_u7A0B_u4E2D_u52A0_u5165Hbase_u7684_u4F9D_u8D56"><a href="#u4E00_u3001_u5728maven_u5DE5_u7A0B_u4E2D_u52A0_u5165Hbase_u7684_u4F9D_u8D56" class="headerlink" title="一、在maven工程中加入Hbase的依赖"></a>一、在maven工程中加入Hbase的依赖</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hbase<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hbase-client<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.98.8-hadoop2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hbase<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hbase-server<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.98.8-hadoop2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="u4E8C_u3001_u5C06hbase-site-xml_u653E_u5165src/main/resources_u76EE_u5F55_u4E0B"><a href="#u4E8C_u3001_u5C06hbase-site-xml_u653E_u5165src/main/resources_u76EE_u5F55_u4E0B" class="headerlink" title="二、将hbase-site.xml放入src/main/resources目录下"></a>二、将hbase-site.xml放入src/main/resources目录下</h1><h1 id="u4E09_u3001_u786E_u4FDDHDFS_u3001YARN_u3001HBase_u90FD_u6B63_u5E38_u542F_u52A8"><a href="#u4E09_u3001_u786E_u4FDDHDFS_u3001YARN_u3001HBase_u90FD_u6B63_u5E38_u542F_u52A8" class="headerlink" title="三、确保HDFS、YARN、HBase都正常启动"></a>三、确保HDFS、YARN、HBase都正常启动</h1><a id="more"></a>
<h1 id="u56DB_u3001_u7F16_u5199_u4EE3_u7801"><a href="#u56DB_u3001_u7F16_u5199_u4EE3_u7801" class="headerlink" title="四、编写代码"></a>四、编写代码</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * HBaseTest.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年4月10日 下午4:30:48</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">package</span> HBase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HColumnDescriptor;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HTableDescriptor;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.KeyValue;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.MasterNotRunningException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.ZooKeeperConnectionException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Get;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HBaseAdmin;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HTable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HTableInterface;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HTablePool;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Put;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ResultScanner;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HBasetest</span> </span>&#123;</span><br><span class="line">	<span class="keyword">static</span> HBaseAdmin admin = <span class="keyword">null</span>;</span><br><span class="line">	Configuration conf = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 构造函数初始化加载</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HBasetest</span><span class="params">()</span> <span class="keyword">throws</span> MasterNotRunningException,</span><br><span class="line">			ZooKeeperConnectionException, IOException </span>&#123;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 前提：要把hbase-site.xml放在src/main/resources目录下</span><br><span class="line">		 */</span></span><br><span class="line">		conf = HBaseConfiguration.create();</span><br><span class="line">		admin = <span class="keyword">new</span> HBaseAdmin(conf);</span><br><span class="line">		System.out.println(<span class="string">"hbase连接成功！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">		HBasetest hBase = <span class="keyword">new</span> HBasetest();</span><br><span class="line">		<span class="comment">// System.out.println(admin);</span></span><br><span class="line">		<span class="comment">//创建表</span></span><br><span class="line">		hBase.createTable(<span class="string">"Tabletest"</span>, <span class="string">"info"</span>, <span class="string">"scores"</span>);</span><br><span class="line">		<span class="comment">//插入一条记录</span></span><br><span class="line">		hBase.addOneData(<span class="string">"Tabletest"</span>, <span class="string">"one"</span>, <span class="string">"info"</span>, <span class="string">"weight"</span>, <span class="string">"50kg"</span>);</span><br><span class="line">		hBase.addOneData(<span class="string">"Tabletest"</span>, <span class="string">"one"</span>, <span class="string">"info"</span>, <span class="string">"hight"</span>, <span class="string">"175cm"</span>);</span><br><span class="line">		<span class="comment">//获得所有表中记录</span></span><br><span class="line">		hBase.getAllData(<span class="string">"Tabletest"</span>);</span><br><span class="line">		<span class="comment">//获得表中一行记录	</span></span><br><span class="line">		hBase.getOneRcord(<span class="string">"Tabletest"</span>, <span class="string">"one"</span>);</span><br><span class="line">		<span class="comment">//删除表中一行记录</span></span><br><span class="line">		hBase.deleteAllOnedata(<span class="string">"Tabletest"</span>, <span class="string">"one"</span>);</span><br><span class="line">		<span class="comment">//删除表中一条记录</span></span><br><span class="line">		hBase.deleteOneRcord(<span class="string">"Tabletest"</span>, <span class="string">"one"</span>, <span class="string">"info"</span>, <span class="string">"hight"</span>);</span><br><span class="line">		<span class="comment">//删除一个表</span></span><br><span class="line">		hBase.deleteTable(<span class="string">"Tabletest"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// hBase.getAllTable();</span></span><br><span class="line">		admin.close();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * <span class="doctag">@param</span> string</span><br><span class="line">	 * <span class="doctag">@param</span> string2</span><br><span class="line">	 * <span class="doctag">@throws</span> IOException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createTable</span><span class="params">(String tableName, String family1,</span><br><span class="line">			String family2)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (admin.tableExists(tableName)) &#123;</span><br><span class="line">			System.out.println(tableName + <span class="string">"表已存在"</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"start to create table"</span>);</span><br><span class="line">			HTableDescriptor hTableDescriptor = <span class="keyword">new</span> HTableDescriptor(</span><br><span class="line">					TableName.valueOf(tableName));</span><br><span class="line">			hTableDescriptor.addFamily(<span class="keyword">new</span> HColumnDescriptor(family1));</span><br><span class="line">			hTableDescriptor.addFamily(<span class="keyword">new</span> HColumnDescriptor(family2));</span><br><span class="line">			admin.createTable(hTableDescriptor);</span><br><span class="line">			System.out.println(tableName + <span class="string">"表创建成功！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 查询所有记录</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> tableName</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAllData</span><span class="params">(String tableName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			HTable hTable = <span class="keyword">new</span> HTable(conf, tableName);</span><br><span class="line">			Scan scan = <span class="keyword">new</span> Scan();</span><br><span class="line">			ResultScanner scanner = hTable.getScanner(scan);</span><br><span class="line">			<span class="keyword">for</span> (Result result : scanner) &#123;</span><br><span class="line">				<span class="keyword">if</span> (result.raw().length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">for</span> (KeyValue kv : result.raw()) &#123;</span><br><span class="line">						System.out.println(<span class="keyword">new</span> String(kv.getRow()) + <span class="string">"\t"</span></span><br><span class="line">								+ <span class="keyword">new</span> String(kv.getValue()));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 往表中添加一条数据</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> tableName</span><br><span class="line">	 * <span class="doctag">@param</span> rowkey</span><br><span class="line">	 * <span class="doctag">@param</span> family</span><br><span class="line">	 * <span class="doctag">@param</span> qualifier</span><br><span class="line">	 * <span class="doctag">@param</span> value</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addOneData</span><span class="params">(String tableName, String rowkey, String family,</span><br><span class="line">			String qualifier, String value)</span> </span>&#123;</span><br><span class="line">		HTablePool hTablePool = <span class="keyword">new</span> HTablePool(conf, <span class="number">1000</span>);</span><br><span class="line">		HTableInterface table = hTablePool.getTable(tableName);</span><br><span class="line">		Put put = <span class="keyword">new</span> Put(rowkey.getBytes());</span><br><span class="line">		put.add(family.getBytes(), qualifier.getBytes(), value.getBytes());</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			table.put(put);</span><br><span class="line">			System.out.println(<span class="string">"记录"</span> + rowkey + <span class="string">"添加成功！"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			System.out.println(<span class="string">"记录"</span> + rowkey + <span class="string">"添加失败！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 获取所有的列表</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getAllTable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (admin != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				HTableDescriptor[] listTables = admin.listTables();</span><br><span class="line">				<span class="keyword">if</span> (listTables.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">for</span> (HTableDescriptor hTableDescriptor : listTables) &#123;</span><br><span class="line">						System.out.println(hTableDescriptor.getNameAsString());</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getOneRcord</span><span class="params">(String tableName, String rowkey)</span> </span>&#123;</span><br><span class="line">		HTablePool hTablePool = <span class="keyword">new</span> HTablePool(conf, <span class="number">1000</span>);</span><br><span class="line">		HTableInterface table = hTablePool.getTable(tableName);</span><br><span class="line">		Get get = <span class="keyword">new</span> Get(rowkey.getBytes());</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Result result = table.get(get);</span><br><span class="line">			<span class="keyword">if</span> (result.raw().length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">for</span> (KeyValue kv : result.raw()) &#123;</span><br><span class="line">					<span class="comment">/*</span><br><span class="line">					 * System.out.println(new String(kv.getRow()) + "\t" + new</span><br><span class="line">					 * String(kv.getValue()));</span><br><span class="line">					 */</span></span><br><span class="line"></span><br><span class="line">					System.out.println(<span class="keyword">new</span> String(kv.getRowArray()) + <span class="string">"\t"</span>);</span><br><span class="line">					<span class="comment">// + new String(kv.getValueArray()));</span></span><br><span class="line">					<span class="comment">/*</span><br><span class="line">					 * System.out.println(new String(kv.getKey()) + "\t" + new</span><br><span class="line">					 * String(kv.getValue()));</span><br><span class="line">					 */</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 删除一条记录</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> string</span><br><span class="line">	 * <span class="doctag">@param</span> string2</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">deleteAllOnedata</span><span class="params">(String tableName, String rowkey)</span> </span>&#123;</span><br><span class="line">		HTablePool hTablePool = <span class="keyword">new</span> HTablePool(conf, <span class="number">1000</span>);</span><br><span class="line">		HTableInterface table = hTablePool.getTable(tableName);</span><br><span class="line">		Delete delete = <span class="keyword">new</span> Delete(rowkey.getBytes());</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			table.delete(delete);</span><br><span class="line">			System.out.println(rowkey + <span class="string">" 记录删除成功！"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			System.out.println(rowkey + <span class="string">" 记录删除失败！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 删除一条记录的一个值</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> tableName</span><br><span class="line">	 * <span class="doctag">@param</span> rowkey</span><br><span class="line">	 * <span class="doctag">@param</span> family</span><br><span class="line">	 * <span class="doctag">@param</span> qualifier</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">deleteOneRcord</span><span class="params">(String tableName, String rowkey, String family,</span><br><span class="line">			String qualifier)</span> </span>&#123;</span><br><span class="line">		HTablePool hTablePool = <span class="keyword">new</span> HTablePool(conf, <span class="number">1000</span>);</span><br><span class="line">		HTableInterface table = hTablePool.getTable(tableName);</span><br><span class="line">		Delete delete = <span class="keyword">new</span> Delete(rowkey.getBytes());</span><br><span class="line">		delete.deleteColumn(family.getBytes(), qualifier.getBytes());</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			table.delete(delete);</span><br><span class="line">			System.out.println(tableName + <span class="string">" "</span> + rowkey + <span class="string">","</span> + family + <span class="string">":"</span></span><br><span class="line">					+ qualifier + <span class="string">"值删除成功！"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			System.out.println(tableName + <span class="string">" "</span> + rowkey + <span class="string">","</span> + family + <span class="string">":"</span></span><br><span class="line">					+ qualifier + <span class="string">"值删除失败s！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 删除一张表</span><br><span class="line">	 * </span><br><span class="line">	 * <span class="doctag">@param</span> tableName</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">deleteTable</span><span class="params">(String tableName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (admin != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				admin.disableTable(tableName);</span><br><span class="line">				admin.deleteTable(tableName);</span><br><span class="line">				System.out.println(tableName + <span class="string">"表删除成功！"</span>);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">				System.out.println(tableName + <span class="string">"表删除失败！"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="u4E94_u3001_u9047_u5230_u7684_u95EE_u9898"><a href="#u4E94_u3001_u9047_u5230_u7684_u95EE_u9898" class="headerlink" title="五、遇到的问题"></a>五、遇到的问题</h1><blockquote>
<ul>
<li>点击运行，可以打印出admin的信息，但是一开始测试的创建表的操作始终不出结果。<br><strong>一直等啊，等，等啊，等</strong><br>最后终于出了结果：</li>
</ul>
</blockquote>
<p>unknown crxy</p>
<p>crxy 是我的虚拟机的主机名</p>
<p>我一想，可能是主机名没有在windows映射成地址，试试~</p>
<p>打开：C:\Windows\System32\drivers\etc\hosts</p>
<p>增加： 地址 主机名</p>
<p><strong>搞定~</strong></p>
<h1 id="u516D_u3001_u8FFD_u52A0"><a href="#u516D_u3001_u8FFD_u52A0" class="headerlink" title="六、追加"></a>六、追加</h1><p>上面实现的扫描一张表的实现不完善，没有把表中的每一项（行键、列族、列、值）都显示出来。<br>下面是更新的方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * Scanner.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年4月10日 下午6:27:10</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">package</span> HBase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.KeyValue;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.MasterNotRunningException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.ZooKeeperConnectionException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HBaseAdmin;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HTable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ResultScanner;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Scanner</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Configuration conf = HBaseConfiguration.create();</span><br><span class="line">		Scan scan = <span class="keyword">new</span> Scan();</span><br><span class="line">		HTable hTable = <span class="keyword">new</span> HTable(conf, <span class="string">"test1"</span>);</span><br><span class="line">		ResultScanner scanner = hTable.getScanner(scan);</span><br><span class="line">		<span class="keyword">for</span> (Result result : scanner) &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 这里用的都是keyValue里面旧的方法来获取行键，列族，列和值</span><br><span class="line">			 * 新的方法后面都有个Array，但是显示出来中间总有乱码，</span><br><span class="line">			 * 我猜测是时间戳在中间，但不知道怎么解析。</span><br><span class="line">			 * 以后再来解决</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">for</span> (KeyValue keyValue : result.raw()) &#123;</span><br><span class="line"></span><br><span class="line">				System.out.println(<span class="string">"row:"</span>+<span class="keyword">new</span> String(keyValue.getRow())+</span><br><span class="line">						<span class="string">"\tcolumnfamily:"</span>+ <span class="keyword">new</span> String(keyValue.getFamily()) + </span><br><span class="line">						<span class="string">"\tcolumn:"</span>+ <span class="keyword">new</span> String(keyValue.getQualifier()) + </span><br><span class="line">						<span class="string">"\tvalue:"</span>+ <span class="keyword">new</span> String(keyValue.getValue()));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u4E00_u3001_u5728maven_u5DE5_u7A0B_u4E2D_u52A0_u5165Hbase_u7684_u4F9D_u8D56"><a href="#u4E00_u3001_u5728maven_u5DE5_u7A0B_u4E2D_u52A0_u5165Hbase_u7684_u4F9D_u8D56" class="headerlink" title="一、在maven工程中加入Hbase的依赖"></a>一、在maven工程中加入Hbase的依赖</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hbase<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hbase-client<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.98.8-hadoop2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hbase<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hbase-server<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.98.8-hadoop2<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="u4E8C_u3001_u5C06hbase-site-xml_u653E_u5165src/main/resources_u76EE_u5F55_u4E0B"><a href="#u4E8C_u3001_u5C06hbase-site-xml_u653E_u5165src/main/resources_u76EE_u5F55_u4E0B" class="headerlink" title="二、将hbase-site.xml放入src/main/resources目录下"></a>二、将hbase-site.xml放入src/main/resources目录下</h1><h1 id="u4E09_u3001_u786E_u4FDDHDFS_u3001YARN_u3001HBase_u90FD_u6B63_u5E38_u542F_u52A8"><a href="#u4E09_u3001_u786E_u4FDDHDFS_u3001YARN_u3001HBase_u90FD_u6B63_u5E38_u542F_u52A8" class="headerlink" title="三、确保HDFS、YARN、HBase都正常启动"></a>三、确保HDFS、YARN、HBase都正常启动</h1>]]>
    
    </summary>
    
      <category term="HBase" scheme="http://crazyhoney.github.io/tags/HBase/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[微软2016校园招聘4月在线笔试2-403-Forbidden]]></title>
    <link href="http://crazyhoney.github.io/2016/04/07/%E5%BE%AE%E8%BD%AF2016%E6%A0%A1%E5%9B%AD%E6%8B%9B%E8%81%984%E6%9C%88%E5%9C%A8%E7%BA%BF%E7%AC%94%E8%AF%952-403-Forbidden/"/>
    <id>http://crazyhoney.github.io/2016/04/07/微软2016校园招聘4月在线笔试2-403-Forbidden/</id>
    <published>2016-04-07T05:34:52.000Z</published>
    <updated>2016-05-04T14:43:26.512Z</updated>
    <content type="html"><![CDATA[<p>昨天做了微软的在线笔试，那叫一个惨啊！</p>
<p><img src="http://ww1.sinaimg.cn/large/75544e9fjw1f2o4608l54j205k05edfp.jpg" alt=""></p>
<blockquote>
<ul>
<li>第一题目是全英文(我是很爱国好吗)</li>
<li>该死的输入，半天搞不定</li>
</ul>
</blockquote>
<p>，吐槽完毕，下面开始整理</p>
<h1 id="u9898_u76EE"><a href="#u9898_u76EE" class="headerlink" title="题目"></a>题目</h1><h2 id="u8F93_u5165_uFF1A"><a href="#u8F93_u5165_uFF1A" class="headerlink" title="输入："></a>输入：</h2><p>样例：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="number">5</span></span><br><span class="line">allow <span class="number">1.2</span><span class="number">.3</span><span class="number">.4</span>/<span class="number">30</span></span><br><span class="line">deny <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">allow <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">allow <span class="number">123.234</span><span class="number">.12</span><span class="number">.23</span>/<span class="number">3</span></span><br><span class="line">deny <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span></span><br><span class="line"><span class="number">1.2</span><span class="number">.3</span><span class="number">.4</span></span><br><span class="line"><span class="number">1.2</span><span class="number">.3</span><span class="number">.5</span></span><br><span class="line"><span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line"><span class="number">100.100</span><span class="number">.100</span><span class="number">.100</span></span><br><span class="line"><span class="number">219.142</span><span class="number">.53</span><span class="number">.100</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<ul>
<li>第一行两个数字n,m</li>
<li>n:输入n个规则</li>
<li>m:输入m个ip</li>
</ul>
</blockquote>
<a id="more"></a>
<p><strong>描述：</strong><br>用输入的ip去匹配每个规则，如果匹配，则判断是allow还是deny。根据这个得出结论，时候被允许通过。</p>
<p><strong>匹配规则：</strong><br>每个ip都可以写为32个二进制，斜线后面的数字k，是子网掩码的数量。（如果没有就默认32，全部匹配才可以）。<br>用ip和规则的前k位一一比对，如果符合，则说明匹配，否则不匹配。</p>
<p>在程序中的判断：<br>if(是allow &amp;&amp; 匹配成功) 输出YES<br>其他情况全都是NO<br>上代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * testString.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年4月6日 下午11:31:47</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">testString</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		<span class="keyword">while</span> (sc.hasNext()) &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * n:输入的规则数 m:输入的ip数</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">int</span> n = sc.nextInt();</span><br><span class="line">			<span class="keyword">int</span> m = sc.nextInt();</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * rule的结构 rule[][0]:allow||deny rule[][1]:ip rule[][2]:mask</span><br><span class="line">			 */</span></span><br><span class="line">			String rule[][] = <span class="keyword">new</span> String[n][<span class="number">3</span>];</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 数组r、in存放rule和ip的以数字形式存储的ip(分为4段，方便后面转换为二进制)</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">int</span> r[][] = <span class="keyword">new</span> <span class="keyword">int</span>[n][<span class="number">4</span>];</span><br><span class="line">			<span class="keyword">int</span> in[][] = <span class="keyword">new</span> <span class="keyword">int</span>[m][<span class="number">4</span>];</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 数组ip存放，输入的m个ip</span><br><span class="line">			 */</span></span><br><span class="line">			String ip[] = <span class="keyword">new</span> String[m];</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 循环输入rule的每一行中的三项元素，如果没有子网掩码位数（即没有斜线后面的数字），</span><br><span class="line">			 * 等价于，子网掩码位数为32（即全部匹配才行）。</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">				rule[i][<span class="number">0</span>] = sc.next();</span><br><span class="line">				rule[i][<span class="number">1</span>] = sc.next();</span><br><span class="line">				<span class="keyword">if</span> (rule[i][<span class="number">1</span>].contains(<span class="string">"/"</span>)) &#123;</span><br><span class="line">					String[] split = rule[i][<span class="number">1</span>].split(<span class="string">"/"</span>);</span><br><span class="line">					rule[i][<span class="number">1</span>] = split[<span class="number">0</span>];</span><br><span class="line">					rule[i][<span class="number">2</span>] = split[<span class="number">1</span>];</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					rule[i][<span class="number">2</span>] = <span class="string">"32"</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 循环键入ip地址</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">				ip[i] = sc.next();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 测试输出rule</span><br><span class="line">			 */</span></span><br><span class="line">			System.out.println(<span class="string">"以下是测试输出rule"</span>);</span><br><span class="line">			PrintRule(rule);</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 把rule的IP用“.”来拆开，放入r数组中</span><br><span class="line">			 */</span></span><br><span class="line">			r = SplitRuleIP(rule);</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 测试输出整数型的rule的ip</span><br><span class="line">			 */</span></span><br><span class="line">			System.out.println(<span class="string">"以下是测试输出整数型的rule的ip"</span>);</span><br><span class="line">			PrintIP(r);</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 把ip的IP用“.”来拆开，放入r数组中</span><br><span class="line">			 */</span></span><br><span class="line">			in = SplitIP(ip);</span><br><span class="line"></span><br><span class="line">			System.out.println(<span class="string">"以下是测试输出整数型的ip的ip"</span>);</span><br><span class="line">			PrintIP(in);</span><br><span class="line"></span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 上面已经将规则IP和IP都以整数的形式存入int数组中。r和in 下面进行二进制转化</span><br><span class="line">			 * ruleBin,ipBin表示rule和ip的IP的二进制数值</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">int</span> ruleBin[][] = <span class="keyword">new</span> <span class="keyword">int</span>[r.length][<span class="number">32</span>];</span><br><span class="line">			<span class="keyword">int</span> ipBin[][] = <span class="keyword">new</span> <span class="keyword">int</span>[in.length][<span class="number">32</span>];</span><br><span class="line">			ruleBin = CovertoBin(r);</span><br><span class="line">			ipBin = CovertoBin(in);</span><br><span class="line">			System.out.println(<span class="string">"=====ruleBin=========="</span>);</span><br><span class="line">			PrintBin(ruleBin);</span><br><span class="line">			System.out.println(<span class="string">"=====ipBin=========="</span>);</span><br><span class="line">			PrintBin(ipBin);</span><br><span class="line">			System.out.println(<span class="string">"=====result=========="</span>);</span><br><span class="line">			getResult(ipBin, ruleBin, rule);</span><br><span class="line">		&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintRule</span><span class="params">(String[][] rule)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rule.length; i++) &#123;</span><br><span class="line">			System.out.print(<span class="string">"rule: "</span> + rule[i][<span class="number">0</span>]);</span><br><span class="line">			System.out.print(<span class="string">" ip   "</span> + rule[i][<span class="number">1</span>]);</span><br><span class="line">			System.out.print(<span class="string">" mask   "</span> + rule[i][<span class="number">2</span>]);</span><br><span class="line">			System.out.print(<span class="string">"\n"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"=========================="</span>);</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[][] SplitRuleIP(String[][] rule) &#123;</span><br><span class="line">		<span class="keyword">int</span> r[][] = <span class="keyword">new</span> <span class="keyword">int</span>[rule.length][<span class="number">4</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rule.length; i++) &#123;</span><br><span class="line">			String[] split = rule[i][<span class="number">1</span>].split(<span class="string">"\\."</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				r[i][j] = Integer.parseInt(split[j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintIP</span><span class="params">(<span class="keyword">int</span>[][] r)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r.length; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">				System.out.print(<span class="string">" "</span> + r[i][j] + <span class="string">" "</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.print(<span class="string">"\n"</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"=========================="</span>);</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[][] SplitIP(String[] ip) &#123;</span><br><span class="line">		<span class="keyword">int</span> in[][] = <span class="keyword">new</span> <span class="keyword">int</span>[ip.length][<span class="number">4</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ip.length; i++) &#123;</span><br><span class="line">			String[] split = ip[i].split(<span class="string">"\\."</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; split.length; j++) &#123;</span><br><span class="line">				in[i][j] = Integer.parseInt(split[j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> in;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[][] CovertoBin(<span class="keyword">int</span>[][] r) &#123;</span><br><span class="line">		<span class="keyword">int</span> Bin[][] = <span class="keyword">new</span> <span class="keyword">int</span>[r.length][<span class="number">32</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Bin.length; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) &#123;</span><br><span class="line">				Bin[i][j] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r.length; i++) &#123;</span><br><span class="line">			<span class="keyword">int</span> k = <span class="number">31</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; <span class="number">8</span>; s++) &#123;</span><br><span class="line">					<span class="keyword">if</span> (r[i][j] != <span class="number">0</span>) &#123;</span><br><span class="line">						Bin[i][k--] = r[i][j] % <span class="number">2</span>;</span><br><span class="line">						r[i][j] /= <span class="number">2</span>;</span><br><span class="line">					&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">						k--;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Bin;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintBin</span><span class="params">(<span class="keyword">int</span>[][] ruleBin)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ruleBin.length; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) &#123;</span><br><span class="line">				<span class="keyword">if</span> (j % <span class="number">8</span> == <span class="number">0</span>) &#123;</span><br><span class="line">					System.out.print(<span class="string">" "</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.print(ruleBin[i][j]);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.print(<span class="string">"\n"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getResult</span><span class="params">(<span class="keyword">int</span>[][] ipBin, <span class="keyword">int</span>[][] ruleBin,</span><br><span class="line">			String[][] rule)</span> </span>&#123;</span><br><span class="line">		String type = <span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">// i循环每个ip</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ipBin.length; i++) &#123;</span><br><span class="line">			<span class="comment">// j循环每个ruleip</span></span><br><span class="line">			<span class="keyword">boolean</span> get = <span class="keyword">false</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; ruleBin.length; j++) &#123;</span><br><span class="line">				<span class="comment">// accord = false;</span></span><br><span class="line">				<span class="keyword">boolean</span> isAccord = <span class="keyword">true</span>;</span><br><span class="line">				<span class="comment">// 判断每一个ip和每一个rule的ip的符合情况</span></span><br><span class="line">				type = rule[j][<span class="number">0</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; Integer.parseInt(rule[j][<span class="number">2</span>]); k++) &#123;</span><br><span class="line">					<span class="keyword">if</span> (ipBin[i][k] != ruleBin[j][k]) &#123;</span><br><span class="line">						isAccord = <span class="keyword">false</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (isAccord) &#123;</span><br><span class="line">					get = <span class="keyword">true</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 这里的if判断，原本写的是if(type=="allow")&#123;&#125; ,不管怎么搞都不对。 都快崩溃了！！！</span><br><span class="line">			 * 百度之，发现原来是这个原因： 用“==”运算符，该运算符表示指向字符串的引用是否相同</span><br><span class="line">			 * 后来用了equals方法，该方法比较的是字符串的内容是否相同</span><br><span class="line">			 */</span></span><br><span class="line">			System.out.print(<span class="string">"第"</span>+(i+<span class="number">1</span>)+<span class="string">"个ip是否可以通过："</span>);</span><br><span class="line">			<span class="keyword">if</span> (type.equals(<span class="string">"allow"</span>)) &#123;</span><br><span class="line">				<span class="keyword">if</span> (get) &#123;</span><br><span class="line">					System.out.println(<span class="string">"YES"</span>);</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					System.out.println(<span class="string">"NO"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				System.out.println(<span class="string">"NO"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>p.s</strong> 这里输入搞得有点麻烦，以后再来改良</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>昨天做了微软的在线笔试，那叫一个惨啊！</p>
<p><img src="http://ww1.sinaimg.cn/large/75544e9fjw1f2o4608l54j205k05edfp.jpg" alt=""></p>
<blockquote>
<ul>
<li>第一题目是全英文(我是很爱国好吗)</li>
<li>该死的输入，半天搞不定</li>
</ul>
</blockquote>
<p>，吐槽完毕，下面开始整理</p>
<h1 id="u9898_u76EE"><a href="#u9898_u76EE" class="headerlink" title="题目"></a>题目</h1><h2 id="u8F93_u5165_uFF1A"><a href="#u8F93_u5165_uFF1A" class="headerlink" title="输入："></a>输入：</h2><p>样例：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="number">5</span></span><br><span class="line">allow <span class="number">1.2</span><span class="number">.3</span><span class="number">.4</span>/<span class="number">30</span></span><br><span class="line">deny <span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">allow <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">allow <span class="number">123.234</span><span class="number">.12</span><span class="number">.23</span>/<span class="number">3</span></span><br><span class="line">deny <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0</span></span><br><span class="line"><span class="number">1.2</span><span class="number">.3</span><span class="number">.4</span></span><br><span class="line"><span class="number">1.2</span><span class="number">.3</span><span class="number">.5</span></span><br><span class="line"><span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line"><span class="number">100.100</span><span class="number">.100</span><span class="number">.100</span></span><br><span class="line"><span class="number">219.142</span><span class="number">.53</span><span class="number">.100</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<ul>
<li>第一行两个数字n,m</li>
<li>n:输入n个规则</li>
<li>m:输入m个ip</li>
</ul>
</blockquote>]]>
    
    </summary>
    
      <category term="笔试" scheme="http://crazyhoney.github.io/tags/%E7%AC%94%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[HBase的物理模型]]></title>
    <link href="http://crazyhoney.github.io/2016/03/31/HBase%E7%9A%84%E7%89%A9%E7%90%86%E6%A8%A1%E5%9E%8B/"/>
    <id>http://crazyhoney.github.io/2016/03/31/HBase的物理模型/</id>
    <published>2016-03-31T02:07:57.000Z</published>
    <updated>2016-05-04T14:40:55.847Z</updated>
    <content type="html"><![CDATA[<h3 id="u521A_u5B66_u4E60_u4E86HBase_u7684_u7269_u7406_u6A21_u578B_uFF0C_u6709_u4E9B_u5FC3_u5F97_uFF0C_u8BB0_u5F55_u4E00_u4E0B_7E"><a href="#u521A_u5B66_u4E60_u4E86HBase_u7684_u7269_u7406_u6A21_u578B_uFF0C_u6709_u4E9B_u5FC3_u5F97_uFF0C_u8BB0_u5F55_u4E00_u4E0B_7E" class="headerlink" title="<em>刚学习了HBase的物理模型，有些心得，记录一下~</em>"></a><em>刚学习了HBase的物理模型，有些心得，记录一下~</em></h3><h4 id="u4E00_u3001_u57FA_u672C_u6982_u5FF5"><a href="#u4E00_u3001_u57FA_u672C_u6982_u5FF5" class="headerlink" title="一、基本概念"></a>一、基本概念</h4><h5 id="1_u3001region_server"><a href="#1_u3001region_server" class="headerlink" title="1、region server"></a>1、region server</h5><p>  HBase是分布式数据库，region server 就是每一个存储数据的节点。</p>
<h5 id="2_u3001region"><a href="#2_u3001region" class="headerlink" title="2、region"></a>2、region</h5><p>  每一个region server中，按行把大文件分为小文件。一个小文件就是一个region。</p>
<h4 id="u4E8C_u3001_u95EE_u9898_u5F15_u5165"><a href="#u4E8C_u3001_u95EE_u9898_u5F15_u5165" class="headerlink" title="二、问题引入"></a>二、问题引入</h4><p>HBase的数据是按列族分开存储的。当一个region server上的列族文件越来越大，那么它插入、查询的速度必然降低。</p>
<h4 id="u4E09_u3001_u89E3_u51B3_u65B9_u6848"><a href="#u4E09_u3001_u89E3_u51B3_u65B9_u6848" class="headerlink" title="三、解决方案"></a>三、解决方案</h4><p>当一个列族文件过大时，按行，将文件划分为region。大文件变为小文件，效率就提高了。</p>
<a id="more"></a>
<h4 id="u56DB_u3001region_u8FC7_u5927_u600E_u4E48_u529E"><a href="#u56DB_u3001region_u8FC7_u5927_u600E_u4E48_u529E" class="headerlink" title="四、region过大怎么办"></a>四、region过大怎么办</h4><p>按上面描述，region过大，也会出现插入、查询的速度降低的问题。</p>
<p><em>解决：</em></p>
<p>原来的一个region,拆成两个region。</p>
<blockquote>
<ul>
<li>类似于细胞分裂</li>
</ul>
</blockquote>
<h4 id="u4E94_u3001region_server_u8FC7_u5927_u600E_u4E48_u529E"><a href="#u4E94_u3001region_server_u8FC7_u5927_u600E_u4E48_u529E" class="headerlink" title="五、region server过大怎么办"></a>五、region server过大怎么办</h4><p>路子和上面相同，分裂为两个region server。</p>
<h4 id="u516D_u3001_u4E3E_u4F8B"><a href="#u516D_u3001_u4E3E_u4F8B" class="headerlink" title="六、举例"></a>六、举例</h4><p>原来一个region server中row key的索引是[1,1亿]。<br>现在分裂为两个region server,增加了一个节点。row key 索引分别是[1,5000万]、[5000万，1亿]。<br>这在总的索引表中，只有很细微的变化，就保证了存储文件的region不会变的很大(当然，region肯定是有限额的，超过多少，就会分裂)。<strong>所以，它就可以保证插入、查询的速度。</strong></p>
<h4 id="u4E03_u3001_u7C7B_u6BD4"><a href="#u4E03_u3001_u7C7B_u6BD4" class="headerlink" title="七、类比"></a>七、类比</h4><p><em>region的分裂，可以想象成细胞的分裂。</em></p>
<blockquote>
<ul>
<li>一直专注于一个细胞，细胞一旦太大，性能就变慢了，就<strong>裂变</strong>成新的小细胞。</li>
</ul>
</blockquote>
<h4 id="u516B_u3001_u4F5C_u7528"><a href="#u516B_u3001_u4F5C_u7528" class="headerlink" title="八、作用"></a>八、作用</h4><blockquote>
<ul>
<li>保证了HBase的快速插入、查询。</li>
</ul>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="u521A_u5B66_u4E60_u4E86HBase_u7684_u7269_u7406_u6A21_u578B_uFF0C_u6709_u4E9B_u5FC3_u5F97_uFF0C_u8BB0_u5F55_u4E00_u4E0B_7E"><a href="#u521A_u5B66_u4E60_u4E86HBase_u7684_u7269_u7406_u6A21_u578B_uFF0C_u6709_u4E9B_u5FC3_u5F97_uFF0C_u8BB0_u5F55_u4E00_u4E0B_7E" class="headerlink" title="<em>刚学习了HBase的物理模型，有些心得，记录一下~</em>"></a><em>刚学习了HBase的物理模型，有些心得，记录一下~</em></h3><h4 id="u4E00_u3001_u57FA_u672C_u6982_u5FF5"><a href="#u4E00_u3001_u57FA_u672C_u6982_u5FF5" class="headerlink" title="一、基本概念"></a>一、基本概念</h4><h5 id="1_u3001region_server"><a href="#1_u3001region_server" class="headerlink" title="1、region server"></a>1、region server</h5><p>  HBase是分布式数据库，region server 就是每一个存储数据的节点。</p>
<h5 id="2_u3001region"><a href="#2_u3001region" class="headerlink" title="2、region"></a>2、region</h5><p>  每一个region server中，按行把大文件分为小文件。一个小文件就是一个region。</p>
<h4 id="u4E8C_u3001_u95EE_u9898_u5F15_u5165"><a href="#u4E8C_u3001_u95EE_u9898_u5F15_u5165" class="headerlink" title="二、问题引入"></a>二、问题引入</h4><p>HBase的数据是按列族分开存储的。当一个region server上的列族文件越来越大，那么它插入、查询的速度必然降低。</p>
<h4 id="u4E09_u3001_u89E3_u51B3_u65B9_u6848"><a href="#u4E09_u3001_u89E3_u51B3_u65B9_u6848" class="headerlink" title="三、解决方案"></a>三、解决方案</h4><p>当一个列族文件过大时，按行，将文件划分为region。大文件变为小文件，效率就提高了。</p>]]>
    
    </summary>
    
      <category term="HBase" scheme="http://crazyhoney.github.io/tags/HBase/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[maven工程添加依赖，查看源码]]></title>
    <link href="http://crazyhoney.github.io/2016/03/30/maven%E5%B7%A5%E7%A8%8B%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96%EF%BC%8C%E6%9F%A5%E7%9C%8B%E6%BA%90%E7%A0%81/"/>
    <id>http://crazyhoney.github.io/2016/03/30/maven工程添加依赖，查看源码/</id>
    <published>2016-03-30T06:06:20.000Z</published>
    <updated>2016-05-04T14:42:08.226Z</updated>
    <content type="html"><![CDATA[<h1 id="u539F_u56E0"><a href="#u539F_u56E0" class="headerlink" title="原因"></a>原因</h1><p>最近在学习Hive，学习到了自定义函数UDF。要继承一个类org.apache.hadoop.hive.ql.exec.UDF<br>所以要添加Hive的依赖，下载源码才可以进行自定义函数。</p>
<h1 id="u4E00_u3001_u6DFB_u52A0_u4F9D_u8D56"><a href="#u4E00_u3001_u6DFB_u52A0_u4F9D_u8D56" class="headerlink" title="一、添加依赖"></a>一、添加依赖</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-exec<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-serde<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-service<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-metastore<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-common<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-cli<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hive-jdbc<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">version</span>&gt;</span>0.14.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- more --&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>把以上依赖添加到maven工程的pom.xml中。按理来说，保存后，它会自动下载所依赖的jar包。但是可能是我哪里没有配置好，它没有自动下载。</li>
</ul>
</blockquote>
<p>这个时候添加的依赖那里会出现一堆红叉。不要紧<br>，进入第二步。</p>
<h1 id="u4E8C_u3001_u4E0B_u8F7D_u4F9D_u8D56_u7684jar_u5305"><a href="#u4E8C_u3001_u4E0B_u8F7D_u4F9D_u8D56_u7684jar_u5305" class="headerlink" title="二、下载依赖的jar包"></a>二、下载依赖的jar包</h1><h2 id="1_u3001_u6253_u5F00cmd_uFF0C_u8FDB_u5165_u5230_u9879_u76EE_u6240_u5728_u7684_u76EE_u5F55"><a href="#1_u3001_u6253_u5F00cmd_uFF0C_u8FDB_u5165_u5230_u9879_u76EE_u6240_u5728_u7684_u76EE_u5F55" class="headerlink" title="1、打开cmd，进入到项目所在的目录"></a>1、打开cmd，进入到项目所在的目录</h2><h2 id="2_u3001_u6267_u884Cmvn_clean_package_28_u8FD9_u6837_u53EF_u4EE5_u628A_u6240_u6709_u672A_u4E0B_u8F7D_u7684jar_u5305_u91CD_u65B0_u4E0B_u8F7D_29"><a href="#2_u3001_u6267_u884Cmvn_clean_package_28_u8FD9_u6837_u53EF_u4EE5_u628A_u6240_u6709_u672A_u4E0B_u8F7D_u7684jar_u5305_u91CD_u65B0_u4E0B_u8F7D_29" class="headerlink" title="2、执行mvn clean package(这样可以把所有未下载的jar包重新下载)"></a>2、执行mvn clean package(这样可以把所有未下载的jar包重新下载)</h2><blockquote>
<ul>
<li><p>此时需要耐心等待，因为服务器在国外（你懂滴）。</p>
</li>
<li><p>出现BULID SUCCESS即表示完成。</p>
</li>
</ul>
</blockquote>
<h2 id="3_u3001_u6D88_u9664_u7EA2_u53C9"><a href="#3_u3001_u6D88_u9664_u7EA2_u53C9" class="headerlink" title="3、消除红叉"></a>3、消除红叉</h2><p>此时，虽然jar包都已经下载完毕。但是红叉依旧存在。<br>此时在</p>
<p><strong>项目上右键-&gt;Maven-&gt;Update project…</strong></p>
<p>等它结束后，红叉都消失了</p>
<p>p.s 我就是这样搞定的(不行的话，我也母鸡(╰_╯)# )</p>
<h2 id="4_u3001_u6DFB_u52A0_u6E90_u7801"><a href="#4_u3001_u6DFB_u52A0_u6E90_u7801" class="headerlink" title="4、添加源码"></a>4、添加源码</h2><p>按理说，jar包我都下载好了。源代码我应该都可以看了啊。</p>
<p>可是，问题依旧没有结束。。。</p>
<p>eclipse中open type中输入hive<br><strong>结果：</strong></p>
<h2 id="source_not_found"><a href="#source_not_found" class="headerlink" title="source not found"></a>source not found</h2><p>真是哔了狗了。我特么都下载了源代码，居然说找不到。闹哪样啊！！！</p>
<h3 id="u5C1D_u8BD5_u2460"><a href="#u5C1D_u8BD5_u2460" class="headerlink" title="尝试①"></a>尝试①</h3><pre><code>添加external 源。把下好的jar包添加进去。还特么不行。
</code></pre><h3 id="u5C1D_u8BD5_u2461"><a href="#u5C1D_u8BD5_u2461" class="headerlink" title="尝试②"></a>尝试②</h3><pre><code>我看到项目上右键-&gt;Maven里面有一个Download Sources
我想着，不就是sources找不到吗，试试喽。点了一下。等了半天。居然好了。。。
</code></pre><p><strong>看了一下，原来下载依赖的地方，多了一个以sources<br>结尾的jar包。可能必须要下载这个才可以吧。</strong></p>
<h2 id="u6B64_u65F6_uFF0C_u6E90_u4EE3_u7801_u90FD_u5DF2_u7ECF_u53EF_u4EE5_u67E5_u770B_u4E86_u3002"><a href="#u6B64_u65F6_uFF0C_u6E90_u4EE3_u7801_u90FD_u5DF2_u7ECF_u53EF_u4EE5_u67E5_u770B_u4E86_u3002" class="headerlink" title="此时，源代码都已经可以查看了。"></a>此时，源代码都已经可以查看了。</h2>]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u539F_u56E0"><a href="#u539F_u56E0" class="headerlink" title="原因"></a>原因</h1><p>最近在学习Hive，学习到了自定义函数UDF。要继承一个类org.apache.hadoop.hive.]]>
    </summary>
    
      <category term="Java" scheme="http://crazyhoney.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hive复杂数据类型的嵌套]]></title>
    <link href="http://crazyhoney.github.io/2016/03/29/Hive%E5%A4%8D%E6%9D%82%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%B5%8C%E5%A5%97/"/>
    <id>http://crazyhoney.github.io/2016/03/29/Hive复杂数据类型的嵌套/</id>
    <published>2016-03-29T02:05:55.000Z</published>
    <updated>2016-05-04T14:40:57.741Z</updated>
    <content type="html"><![CDATA[<p>前几天尝试map,struct,map的嵌套，结果失败。之后又查到union还不完善，就以为这个办不成。<br>今早机缘巧合，看到一篇文章</p>
<p>提到在嵌套多层的情况下，分隔符会随着复合类型嵌套层次的递增而发生变化，分隔符默认会以\001,\002,\003,\004…<br>变化。<br>我一看，不行那就试试喽，死马当活马医嘛，结果给“治”好了(￢_￢)。果然药不能停~~~</p>
<h2 id="u4E0B_u9762_u6211_u4EEC_u5206_u9636_u6BB5_u6765_u641E_u8FD9_u4E2A_u5D4C_u5957_u5B9E_u9A8C_uFF0C_u9010_u5C42_u589E_u52A0_u96BE_u5EA6"><a href="#u4E0B_u9762_u6211_u4EEC_u5206_u9636_u6BB5_u6765_u641E_u8FD9_u4E2A_u5D4C_u5957_u5B9E_u9A8C_uFF0C_u9010_u5C42_u589E_u52A0_u96BE_u5EA6" class="headerlink" title="下面我们分阶段来搞这个嵌套实验，逐层增加难度"></a>下面我们分阶段来搞这个嵌套实验，逐层增加难度</h2><h1 id="map_u548Carray_u5D4C_u5957"><a href="#map_u548Carray_u5D4C_u5957" class="headerlink" title="map和array嵌套"></a>map和array嵌套</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> testmaparray(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">  student_id <span class="built_in">int</span>,</span><br><span class="line">  staff_id <span class="built_in">int</span>,</span><br><span class="line">  <span class="keyword">value</span> <span class="built_in">int</span>,  </span><br><span class="line">  items <span class="built_in">array</span>&lt;</span><br><span class="line">              <span class="keyword">struct</span>&lt;</span><br><span class="line">                      <span class="keyword">value</span>:<span class="built_in">int</span>,</span><br><span class="line">                      staff_id:<span class="built_in">int</span>,</span><br><span class="line">                      logtime:<span class="built_in">date</span></span><br><span class="line">                    &gt;  </span><br><span class="line">             &gt;)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span></span><br><span class="line">collection items <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">' '</span></span><br><span class="line"><span class="keyword">map</span> <span class="keyword">keys</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span>;</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>数据文件</p>
<pre><code>1       3       2       15      15,2,2015-09-03
</code></pre><p>load到表中后，查询出来：</p>
<pre><code>1       3       2       15      [{&quot;value&quot;:15,&quot;staff_id&quot;:2,&quot;logtime&quot;:&quot;2015-09-03&quot;}]
</code></pre><p>说明map keys那个分隔符可以分隔<strong>struct里面的各个元素</strong></p>
<h1 id="map_u548Cstruct_u5D4C_u5957"><a href="#map_u548Cstruct_u5D4C_u5957" class="headerlink" title="map和struct嵌套"></a>map和struct嵌套</h1><h2 id="u7B2C_u4E00_u6B21_u5B9E_u9A8C"><a href="#u7B2C_u4E00_u6B21_u5B9E_u9A8C" class="headerlink" title="第一次实验"></a>第一次实验</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> testmapstruct(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">  comp <span class="keyword">struct</span>&lt;</span><br><span class="line">              info:<span class="keyword">map</span>&lt;<span class="keyword">string</span>,<span class="keyword">string</span>&gt;</span><br><span class="line">             &gt;,</span><br><span class="line">  favors <span class="built_in">array</span>&lt;<span class="keyword">string</span>&gt;)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span></span><br><span class="line">collection items <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span></span><br><span class="line"><span class="keyword">map</span> <span class="keyword">keys</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">':'</span>;</span></span><br></pre></td></tr></table></figure>
<p>数据文件</p>
<pre><code>1       zhuzhi:xianyang,xueli:master,jiguan:shanxi      swimming,running
</code></pre><p>导入，查询结果：</p>
<pre><code>1       {&quot;info&quot;:{&quot;zhuzhi&quot;:null,&quot;xianyang&quot;:null}}        [&quot;swimming&quot;,&quot;running&quot;]
</code></pre><blockquote>
<ul>
<li><p>本来是用“:”做map里键值的分隔符，结果被解析成struct的分隔符。这里有了歧义。</p>
</li>
<li><p>所以就不能用这种分隔符了。要试试默认的分隔符。</p>
</li>
</ul>
</blockquote>
<h2 id="u7B2C_u4E8C_u6B21_u5B9E_u9A8C"><a href="#u7B2C_u4E8C_u6B21_u5B9E_u9A8C" class="headerlink" title="第二次实验"></a>第二次实验</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> testmapstruct2(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">  comp <span class="keyword">struct</span>&lt;</span><br><span class="line">              info:<span class="keyword">map</span>&lt;<span class="keyword">string</span>,<span class="keyword">string</span>&gt;</span><br><span class="line">             &gt;,</span><br><span class="line">  favors <span class="built_in">array</span>&lt;<span class="keyword">string</span>&gt;);</span></span><br></pre></td></tr></table></figure>
<p>分析默认分隔符：</p>
<blockquote>
<ul>
<li>字段之间用\001</li>
<li>struct和array里的每个元素之间用\002</li>
<li>struct里面的map的每个元素之间用\003</li>
<li>map的每个键值对里面的键和值之间用\004</li>
</ul>
</blockquote>
<p>数据文件</p>
<pre><code>1^Azhuzhi^Dxianyang^Cxueli^Dmaster^Cjiguan^Dshanxi^Aswimming^Brunning
</code></pre><p>导入，查询结果：</p>
<pre><code>1       {&quot;info&quot;:{&quot;zhuzhi&quot;:&quot;xianyang&quot;,&quot;xueli&quot;:&quot;master&quot;,&quot;jiguan&quot;:&quot;shanxi&quot;}}       [&quot;swimming&quot;,&quot;running&quot;]
</code></pre><h1 id="map_u3001struct_u548Cmap_u5D4C_u5957"><a href="#map_u3001struct_u548Cmap_u5D4C_u5957" class="headerlink" title="map、struct和map嵌套"></a>map、struct和map嵌套</h1><h2 id="u540E_u9762_u518D_u6765_u5199_u54C8_28_u273F_u25E1_u203F_u25E1_29"><a href="#u540E_u9762_u518D_u6765_u5199_u54C8_28_u273F_u25E1_u203F_u25E1_29" class="headerlink" title="后面再来写哈(✿◡‿◡)"></a>后面再来写哈(✿◡‿◡)</h2>]]></content>
    <summary type="html">
    <![CDATA[<p>前几天尝试map,struct,map的嵌套，结果失败。之后又查到union还不完善，就以为这个办不成。<br>今早机缘巧合，看到一篇文章</p>
<p>提到在嵌套多层的情况下，分隔符会随着复合类型嵌套层次的递增而发生变化，分隔符默认会以\001,\002,\003,\004…<br>变化。<br>我一看，不行那就试试喽，死马当活马医嘛，结果给“治”好了(￢_￢)。果然药不能停~~~</p>
<h2 id="u4E0B_u9762_u6211_u4EEC_u5206_u9636_u6BB5_u6765_u641E_u8FD9_u4E2A_u5D4C_u5957_u5B9E_u9A8C_uFF0C_u9010_u5C42_u589E_u52A0_u96BE_u5EA6"><a href="#u4E0B_u9762_u6211_u4EEC_u5206_u9636_u6BB5_u6765_u641E_u8FD9_u4E2A_u5D4C_u5957_u5B9E_u9A8C_uFF0C_u9010_u5C42_u589E_u52A0_u96BE_u5EA6" class="headerlink" title="下面我们分阶段来搞这个嵌套实验，逐层增加难度"></a>下面我们分阶段来搞这个嵌套实验，逐层增加难度</h2><h1 id="map_u548Carray_u5D4C_u5957"><a href="#map_u548Carray_u5D4C_u5957" class="headerlink" title="map和array嵌套"></a>map和array嵌套</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> testmaparray(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">  student_id <span class="built_in">int</span>,</span><br><span class="line">  staff_id <span class="built_in">int</span>,</span><br><span class="line">  <span class="keyword">value</span> <span class="built_in">int</span>,  </span><br><span class="line">  items <span class="built_in">array</span>&lt;</span><br><span class="line">              <span class="keyword">struct</span>&lt;</span><br><span class="line">                      <span class="keyword">value</span>:<span class="built_in">int</span>,</span><br><span class="line">                      staff_id:<span class="built_in">int</span>,</span><br><span class="line">                      logtime:<span class="built_in">date</span></span><br><span class="line">                    &gt;  </span><br><span class="line">             &gt;)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span></span><br><span class="line">collection items <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">' '</span></span><br><span class="line"><span class="keyword">map</span> <span class="keyword">keys</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span>;</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="Hive" scheme="http://crazyhoney.github.io/tags/Hive/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hive自定义分隔符---自定义InputFormat]]></title>
    <link href="http://crazyhoney.github.io/2016/03/25/Hive%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E9%9A%94%E7%AC%A6-%E8%87%AA%E5%AE%9A%E4%B9%89InputFormat/"/>
    <id>http://crazyhoney.github.io/2016/03/25/Hive自定义分隔符-自定义InputFormat/</id>
    <published>2016-03-25T02:23:04.000Z</published>
    <updated>2016-05-04T14:41:21.486Z</updated>
    <content type="html"><![CDATA[<h2 id="u540E_u9762_u518D_u6765_u653E_u622A_u56FE2016-03-25"><a href="#u540E_u9762_u518D_u6765_u653E_u622A_u56FE2016-03-25" class="headerlink" title="后面再来放截图2016-03-25"></a>后面再来放截图2016-03-25</h2><h1 id="u573A_u666F"><a href="#u573A_u666F" class="headerlink" title="场景"></a>场景</h1><p>一个公司中，上一个数据导入组有他们自己的表结构，定义的分隔符。</p>
<p>你们数据处理组要用人家的数据。肯定不能改动人家的表啊，没有这个权限。</p>
<p>假如数据导入组用的是$@_@$这种恶心的，又实用的分隔符(与内容重复的概率低)。</p>
<p>你用Hive要进行处理，但是分隔符又不是Hive里面的分隔符，咋办涅？</p>
<p><strong>解决方案：</strong></p>
<blockquote>
<p>*　自定义InputFormat类，来实现复杂分隔符的处理</p>
</blockquote>
<a id="more"></a>
<h1 id="u81EA_u5B9A_u4E49InputFormat_u7C7B"><a href="#u81EA_u5B9A_u4E49InputFormat_u7C7B" class="headerlink" title="自定义InputFormat类"></a>自定义InputFormat类</h1><h2 id="u7B2C_u4E00_u6B21_u5C1D_u8BD5"><a href="#u7B2C_u4E00_u6B21_u5C1D_u8BD5" class="headerlink" title="第一次尝试"></a>第一次尝试</h2><p>  想着简单啊，把里面默认的分隔符换成$@_@$，不就搞定了吗？说干就干：</p>
<p>把原有的org.apache.hadoop.mapred.TextInputFormat，复制了一份，放在自己写的Hive.myinputformat中。<br>    添加以下改动：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> RecordReader&lt;LongWritable, Text&gt; getRecordReader(</span><br><span class="line">	InputSplit genericSplit, JobConf job, Reporter reporter)</span><br><span class="line">			<span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">		reporter.setStatus(genericSplit.toString());</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 修改"textinputformat.record.delimiter"值</span><br><span class="line">		 */</span></span><br><span class="line">		job.set(<span class="string">"textinputformat.record.delimiter"</span>, <span class="string">"$@_@$"</span>);</span><br><span class="line"></span><br><span class="line">		String delimiter = job.get(<span class="string">"textinputformat.record.delimiter"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//delimiter.toLowerCase().replaceAll("\\$@_@\\$", "\001");</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">byte</span>[] recordDelimiterBytes = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != delimiter) &#123;</span><br><span class="line">			recordDelimiterBytes = delimiter.getBytes(Charsets.UTF_8);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> LineRecordReader(job, (FileSplit) genericSplit,</span><br><span class="line">				recordDelimiterBytes);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>  还有个插曲：</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">hive&gt;create table t1(id <span class="built_in">int</span>,name <span class="built_in">string</span>)</span><br><span class="line">    stored <span class="keyword">as</span> <span class="type">InputFormat</span> <span class="symbol">'myinputformat'</span></span><br><span class="line">    outputformat'org.apache.hadoop.hive.ql.io.<span class="type">HiveIgnoreKeyTextOutputFormat'</span>;</span><br></pre></td></tr></table></figure>
<p>   显示：<strong>cannot find class myinputformat.</strong></p>
<p>   问题：没加包名 -_-</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">hive&gt;create table t1(id <span class="built_in">int</span>,name <span class="built_in">string</span>)</span><br><span class="line">    stored <span class="keyword">as</span> <span class="type">InputFormat</span> <span class="symbol">'Hive</span>.myinputformat'</span><br><span class="line">    outputformat'org.apache.hadoop.hive.ql.io.<span class="type">HiveIgnoreKeyTextOutputFormat'</span>;</span><br></pre></td></tr></table></figure>
<p>显示：<strong>cannot find class Hive.myinputformat.</strong></p>
<p><img src="http://ww2.sinaimg.cn/large/75544e9fjw1f28z84wa66j2064064747.jpg" alt=""></p>
<p>问题：居然要重新进入一遍Hive。(。﹏。*)<br>      可能是要刷新，不会。直接重新进入就好了。</p>
<p>本以为这该好了。可是数据一导入，卧槽。还是跪了0_0</p>
<pre><code>显示：

1     NULL
NULL  NULL
</code></pre><h2 id="u53EF_u60DC_uFF0C_u7406_u60F3_u5F88_u4E30_u6EE1_uFF0C_u73B0_u5B9E_u5F88_u9AA8_u611F_28_uFFE2__uFFE2_29"><a href="#u53EF_u60DC_uFF0C_u7406_u60F3_u5F88_u4E30_u6EE1_uFF0C_u73B0_u5B9E_u5F88_u9AA8_u611F_28_uFFE2__uFFE2_29" class="headerlink" title="可惜，理想很丰满，现实很骨感(￢_￢)"></a>可惜，理想很丰满，现实很骨感(￢_￢)</h2><h2 id="u5931_u8D25_u3002"><a href="#u5931_u8D25_u3002" class="headerlink" title="失败。"></a>失败。</h2><h2 id="u7B2C_u4E8C_u6B21_u5C1D_u8BD5"><a href="#u7B2C_u4E8C_u6B21_u5C1D_u8BD5" class="headerlink" title="第二次尝试"></a>第二次尝试</h2><p>百度，找到以下解决方法：<a href="http://www.micmiu.com/bigdata/hive/hive-inputformat-string/" target="_blank" rel="external">http://www.micmiu.com/bigdata/hive/hive-inputformat-string/</a></p>
<p>把他的类复制下来，搞成jar包。直接用他的分隔符|@^_^@|<br>直接成功了。<br><img src="http://ww1.sinaimg.cn/large/e739bec3jw1egdj7nmzusj208c0bgt9d.jpg" alt=""></p>
<p>研究了一下他的代码，主要是这句：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String strReplace = text.toString().toLowerCase()</span><br><span class="line">						.replaceAll(<span class="string">"\\|@\\^_\\^@\\|"</span>, <span class="string">"\001"</span>);</span><br></pre></td></tr></table></figure></p>
<h2 id="u4F46_u662F_u6211_u5C31_u5947_u4E86_u602A_3A"><a href="#u4F46_u662F_u6211_u5C31_u5947_u4E86_u602A_3A" class="headerlink" title="但是我就奇了怪:"></a>但是我就奇了怪:</h2><p><strong>为啥不是|@^<em>^@|，而是\|@\^</em>\^@\|</strong><br>经过一番折腾：<br>原来replaceAll()函数是去匹配正则表达式。</p>
<p>这里的意思是：用Hive默认的“\001”去替换原本的“|@^_^@|”。</p>
<p>而加上很多反斜杠是正则表达式的<strong>原因</strong>：</p>
<p>要告诉编译器，别解析我这里面的字符。我是一个整体的。</p>
<p>我就把这句改成了：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String strReplace = text.toString().toLowerCase()</span><br><span class="line">						.replaceAll(<span class="string">"\\$@_@\\$"</span>, <span class="string">"\001"</span>);</span><br></pre></td></tr></table></figure></p>
<p>然后，打包，放入lib目录下。建表，导入数据。成功~</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u540E_u9762_u518D_u6765_u653E_u622A_u56FE2016-03-25"><a href="#u540E_u9762_u518D_u6765_u653E_u622A_u56FE2016-03-25" class="headerlink" title="后面再来放截图2016-03-25"></a>后面再来放截图2016-03-25</h2><h1 id="u573A_u666F"><a href="#u573A_u666F" class="headerlink" title="场景"></a>场景</h1><p>一个公司中，上一个数据导入组有他们自己的表结构，定义的分隔符。</p>
<p>你们数据处理组要用人家的数据。肯定不能改动人家的表啊，没有这个权限。</p>
<p>假如数据导入组用的是$@_@$这种恶心的，又实用的分隔符(与内容重复的概率低)。</p>
<p>你用Hive要进行处理，但是分隔符又不是Hive里面的分隔符，咋办涅？</p>
<p><strong>解决方案：</strong></p>
<blockquote>
<p>*　自定义InputFormat类，来实现复杂分隔符的处理</p>
</blockquote>]]>
    
    </summary>
    
      <category term="Hive" scheme="http://crazyhoney.github.io/tags/Hive/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hive的复合类型UNION]]></title>
    <link href="http://crazyhoney.github.io/2016/03/24/Hive%E7%9A%84%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8BUNION/"/>
    <id>http://crazyhoney.github.io/2016/03/24/Hive的复合类型UNION/</id>
    <published>2016-03-24T02:27:05.000Z</published>
    <updated>2016-05-04T14:41:11.549Z</updated>
    <content type="html"><![CDATA[<p>这两天正在学Hive,学习到了复合数据类型ARRAY,MAP,STRUCT。</p>
<h2 id="u7A81_u7136_u60F3_u5230"><a href="#u7A81_u7136_u60F3_u5230" class="headerlink" title="突然想到"></a>突然想到</h2><p>能不能把许多类型放在一起，用上面的类型嵌套，始终不太得劲。所以查了查，发现有个UNION类型好像可以干这个事。<br>百度之，资料不多，没啥用处。就找到了官网文档。</p>
<p>如下：</p>
<p><img src="http://ww2.sinaimg.cn/large/75544e9fjw1f27r1rj8dhj20t60gptdt.jpg" alt=""></p>
<p><strong>This means that UNIONTYPEs are effectively look-at-only.</strong></p>
<p>这个类型目前只能看啊！卧槽◔ ‸◔?<br>没啥实际作用！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>这两天正在学Hive,学习到了复合数据类型ARRAY,MAP,STRUCT。</p>
<h2 id="u7A81_u7136_u60F3_u5230"><a href="#u7A81_u7136_u60F3_u5230" class="headerlink" title="]]>
    </summary>
    
      <category term="Hive" scheme="http://crazyhoney.github.io/tags/Hive/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Java的IO流]]></title>
    <link href="http://crazyhoney.github.io/2016/03/18/Java%E7%9A%84IO%E6%B5%81/"/>
    <id>http://crazyhoney.github.io/2016/03/18/Java的IO流/</id>
    <published>2016-03-18T11:19:46.000Z</published>
    <updated>2016-05-04T14:41:48.946Z</updated>
    <content type="html"><![CDATA[<p>//有时间再排版吧，累觉不爱 3/18</p>
<h1 id="u4E00_u3001Java_u7684_u6D41_uFF1A"><a href="#u4E00_u3001Java_u7684_u6D41_uFF1A" class="headerlink" title="一、Java的流："></a>一、Java的流：</h1><blockquote>
<ul>
<li>各种各样的流对应各种各样的管道，它们有些可以套在一起使用。</li>
</ul>
</blockquote>
<p><img src="http://ww1.sinaimg.cn/large/75544e9fjw1f214xcgrxkj20qk04nac5.jpg" alt=""></p>
<h1 id="u4E8C_u3001_u5206_u7C7B_uFF1A"><a href="#u4E8C_u3001_u5206_u7C7B_uFF1A" class="headerlink" title="二、分类："></a>二、分类：</h1><blockquote>
<ul>
<li>输入流，输出流——-文件的流向不同</li>
</ul>
</blockquote>
<h2 id="u8F93_u5165_u6D41_3A_u8FDB_u5165_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29"><a href="#u8F93_u5165_u6D41_3A_u8FDB_u5165_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29" class="headerlink" title="<strong>输入流:进入程序(写的代码)</strong>"></a><strong>输入流:进入程序(写的代码)</strong></h2><h2 id="u8F93_u51FA_u6D41_3A_u4ECE_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29_u51FA_u53BB"><a href="#u8F93_u51FA_u6D41_3A_u4ECE_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29_u51FA_u53BB" class="headerlink" title="<strong>输出流:从程序(写的代码)出去</strong>"></a><strong>输出流:从程序(写的代码)出去</strong></h2><blockquote>
<ul>
<li><p>字节流，字符流——-处理的数据单位不同</p>
</li>
<li><p>节点流，处理流——-功能不同</p>
</li>
</ul>
</blockquote>
<a id="more"></a>
<p>节点流：<strong>流</strong>(管道)直接怼到<strong>文件</strong>(水桶)上的流。</p>
<p>处理流：包在别的<strong>流</strong>(管道)上面的<strong>流</strong>(管道)。</p>
<h2 id="u51E1_u662F_u4EE5stream_u7ED3_u5C3E_u7684_u90FD_u662F_u5B57_u8282_u6D41"><a href="#u51E1_u662F_u4EE5stream_u7ED3_u5C3E_u7684_u90FD_u662F_u5B57_u8282_u6D41" class="headerlink" title="<strong>凡是以stream结尾的都是字节流</strong>"></a><strong>凡是以stream结尾的都是字节流</strong></h2><h1 id="u4E09_u3001_u8282_u70B9_u6D41"><a href="#u4E09_u3001_u8282_u70B9_u6D41" class="headerlink" title="三、节点流"></a>三、节点流</h1><h2 id="1_u3001FileInputStream"><a href="#1_u3001FileInputStream" class="headerlink" title="1、FileInputStream"></a>1、FileInputStream</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileInputStream</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line">    FileInputStream in = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      in = <span class="keyword">new</span> FileInputStream(<span class="string">"d:\\share\\java\\io\\TestFileInputStream.java"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"找不到指定文件"</span>);</span><br><span class="line">      System.exit(-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">long</span> num = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span>((b=in.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">//b!=-1相当于这个文件还没有读到结尾</span></span><br><span class="line">        System.out.print((<span class="keyword">char</span>)b);</span><br><span class="line">        num++;</span><br><span class="line">      &#125;</span><br><span class="line">      in.close();  </span><br><span class="line">      System.out.println();</span><br><span class="line">      System.out.println(<span class="string">"共读取了 "</span>+num+<span class="string">" 个字节"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">      System.out.println(<span class="string">"文件读取错误"</span>); System.exit(-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个程序执行结束后，读出的文件，如果有中文，则会显示乱码。因为它是一个字节字节地读，而中文占用的不止一个字节。</p>
<h2 id="2_u3001FileOutputStream"><a href="#2_u3001FileOutputStream" class="headerlink" title="2、FileOutputStream"></a>2、FileOutputStream</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileOutputStream</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">	  <span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line">	  FileInputStream in = <span class="keyword">null</span>;</span><br><span class="line">	  FileOutputStream out = <span class="keyword">null</span>;</span><br><span class="line">	  <span class="keyword">try</span> &#123;</span><br><span class="line">	    in = <span class="keyword">new</span> FileInputStream(<span class="string">"e:/javatest/testfile.java"</span>);</span><br><span class="line">	    out = <span class="keyword">new</span> FileOutputStream(<span class="string">"e:/javatest/8/HWJ.java"</span>);</span><br><span class="line">	    <span class="keyword">while</span>((b=in.read())!=-<span class="number">1</span>)&#123;<span class="comment">//in这个管道在从文件里面读数据</span></span><br><span class="line">	    	System.out.print((<span class="keyword">char</span>)b);</span><br><span class="line">	      out.write(b);<span class="comment">//out这个管道在向文件里面“灌”数据</span></span><br><span class="line">	    &#125;</span><br><span class="line">	    in.close();</span><br><span class="line">	    out.close();</span><br><span class="line">	  &#125; <span class="keyword">catch</span> (FileNotFoundException e2) &#123;</span><br><span class="line">	    System.out.println(<span class="string">"找不到指定文件"</span>); System.exit(-<span class="number">1</span>);</span><br><span class="line">	  &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">	    System.out.println(<span class="string">"文件复制错误"</span>); System.exit(-<span class="number">1</span>);</span><br><span class="line">	  &#125;</span><br><span class="line">	  System.out.println(<span class="string">"文件已复制"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>FileOutputStream(path,append):如果第二个参数写为true，则可以向文件后面追加。</p>
<h2 id="3_u3001FileReader"><a href="#3_u3001FileReader" class="headerlink" title="3、FileReader"></a>3、FileReader</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileReader</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    FileReader fr = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      fr = <span class="keyword">new</span> FileReader(<span class="string">"e:\\javatest\\8\\io\\TestFileReader.java"</span>);</span><br><span class="line">      <span class="keyword">int</span> ln = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> ((c = fr.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">        System.out.print((<span class="keyword">char</span>)c);</span><br><span class="line">      &#125;</span><br><span class="line">      fr.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"找不到指定文件"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"文件读取错误"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个程序执行结束，如果文件里面有中文，则会完美的将中文读出。因为这是以字符的形式读出。</p>
<h2 id="4_u3001FileWriter"><a href="#4_u3001FileWriter" class="headerlink" title="4、FileWriter"></a>4、FileWriter</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestFileWriter</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    FileWriter fw = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      fw = <span class="keyword">new</span> FileWriter(<span class="string">"e:\\javatest\\8\\heijudy.txt"</span>);</span><br><span class="line">      fw.write(<span class="string">"我的导师叫那英~"</span>);</span><br><span class="line">      fw.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e1) &#123;</span><br><span class="line">    	e1.printStackTrace();</span><br><span class="line">      System.out.println(<span class="string">"文件写入错误"</span>);</span><br><span class="line">      System.exit(-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">"文件写入完成"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个程序如果目标目录下没有这个文件，则会自动创建一个文件。然后把字符串给写进去。<br>FileWriter(path,append):如果第二个参数写为true，则可以向文件后面追加。</p>
<h1 id="u56DB_u3001_u5904_u7406_u6D41"><a href="#u56DB_u3001_u5904_u7406_u6D41" class="headerlink" title="四、处理流"></a>四、处理流</h1><p><img src="http://ww3.sinaimg.cn/large/75544e9fjw1f215819sspj20lo0d60ve.jpg" alt=""></p>
<h2 id="1_u3001_u7F13_u51B2_u6D41_28_u5E26_u5C0F_u6876_u7684_u6D41_29"><a href="#1_u3001_u7F13_u51B2_u6D41_28_u5E26_u5C0F_u6876_u7684_u6D41_29" class="headerlink" title="1、缓冲流(带小桶的流)"></a>1、缓冲流(带小桶的流)</h2><h3 id="281_29_u3001BufferedInputStream_u3001BufferedOutputStream"><a href="#281_29_u3001BufferedInputStream_u3001BufferedOutputStream" class="headerlink" title="(1)、BufferedInputStream、BufferedOutputStream"></a>(1)、BufferedInputStream、BufferedOutputStream</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestBufferStream1</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			FileInputStream fis = <span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"e:\\javatest\\8\\io\\test.java"</span>);</span><br><span class="line">			BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(fis);</span><br><span class="line">			<span class="comment">//BufferedInputStream bis = new BufferedInputStream(fis,5);</span></span><br><span class="line">			<span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">			System.out.println(bis.read());</span><br><span class="line">			System.out.println(bis.read());</span><br><span class="line">			bis.mark(<span class="number">2</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">10</span> &amp;&amp; (c = bis.read()) != -<span class="number">1</span>; i++) &#123;</span><br><span class="line">				System.out.print((<span class="keyword">char</span>) c + <span class="string">" "</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println();</span><br><span class="line">			bis.reset();</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">10</span> &amp;&amp; (c = bis.read()) != -<span class="number">1</span>; i++) &#123;</span><br><span class="line">				System.out.print((<span class="keyword">char</span>) c + <span class="string">" "</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			bis.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://ww4.sinaimg.cn/large/75544e9fjw1f215glij66j20ru0cgjsm.jpg" alt=""></p>
<p>BufferedInputStream.mark(int readlimit)<br>意思是：</p>
<pre><code>标记当前位置，在后面读取readlimit个字节之前有效。
</code></pre><p><strong>但实际中并不是这样！！！</strong></p>
<p>实际中是这样的：</p>
<blockquote>
<ul>
<li>当BufferedInputStream调用了mark(不管这里是几)后，后面读取的字节数如果超过了流的Size，则这个标记失效。代码中设置的Size=5的BufferedInputStream证实了这个。</li>
</ul>
</blockquote>
<h3 id="282_29_u3001BufferedWriter_u3001BufferedReader"><a href="#282_29_u3001BufferedWriter_u3001BufferedReader" class="headerlink" title="(2)、BufferedWriter、BufferedReader"></a>(2)、BufferedWriter、BufferedReader</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestBufferStream2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(</span><br><span class="line">					<span class="string">"e:/javatest/8/我的家在东北.txt"</span>));</span><br><span class="line">			BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(</span><br><span class="line">					<span class="string">"e:/javatest/8/我的家在东北.txt"</span>));</span><br><span class="line">			String s = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++) &#123;</span><br><span class="line">				s = String.valueOf(Math.random());</span><br><span class="line">				bw.write(s);</span><br><span class="line">				bw.newLine();<span class="comment">//写一个换行符</span></span><br><span class="line">			&#125;</span><br><span class="line">			bw.flush();</span><br><span class="line">			<span class="keyword">while</span> ((s = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">				System.out.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">			bw.close();</span><br><span class="line">			br.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://ww1.sinaimg.cn/large/75544e9fjw1f215t4p55xj211s0ezwh0.jpg" alt=""></p>
<blockquote>
<ul>
<li><p>BufferedWriter.newLine()//写一个换行符</p>
</li>
<li><p>BufferedWriter.write(String s,int off,int len)//写一个字符串s，从off写len个字符。off和len可以缺省，那么就写整个s。也有写字符数组的方法，类似。</p>
</li>
<li><p>有一个很好用的方法：<br>BufferedReader.readLine()//读一行内容<br>它可以直接读出一行内容，即便是为了这个方法，也值得在其他流上套一个BufferedReader</p>
</li>
</ul>
</blockquote>
<h2 id="2_u3001_u8F6C_u6362_u6D41"><a href="#2_u3001_u8F6C_u6362_u6D41" class="headerlink" title="2、转换流"></a>2、转换流</h2><p>转换流概念图片</p>
<h3 id="281_29_u3001OutputStreamWriter"><a href="#281_29_u3001OutputStreamWriter" class="headerlink" title="(1)、OutputStreamWriter"></a>(1)、OutputStreamWriter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTransForm1</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			OutputStreamWriter osw = <span class="keyword">new</span> OutputStreamWriter(</span><br><span class="line">					<span class="keyword">new</span> FileOutputStream(<span class="string">"e:\\javatest\\8\\io\\char.txt"</span>));</span><br><span class="line">			osw.write(<span class="string">"mircosoft ibm sun apple hp"</span>);</span><br><span class="line">			<span class="comment">// osw.getEncoding()拿到这个字符编码</span></span><br><span class="line">			System.out.println(osw.getEncoding());</span><br><span class="line">			osw.close();</span><br><span class="line">			osw = <span class="keyword">new</span> OutputStreamWriter(<span class="keyword">new</span> FileOutputStream(</span><br><span class="line">					<span class="string">"e:\\javatest\\8\\io\\char.txt"</span>, <span class="keyword">true</span>), <span class="string">"GBK"</span>); <span class="comment">// latin-1</span></span><br><span class="line"></span><br><span class="line">			osw.write(<span class="string">"    mircosoft ibm sun apple hp"</span>);</span><br><span class="line">			<span class="comment">// osw.write("    mircosoft ibm sun apple hp", 3, 2);</span></span><br><span class="line">			System.out.println(osw.getEncoding());</span><br><span class="line">			osw.close();</span><br><span class="line"></span><br><span class="line">			InputStreamReader isr = <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(</span><br><span class="line">					<span class="string">"e:\\javatest\\8\\io\\char.txt"</span>));</span><br><span class="line">			BufferedReader br = <span class="keyword">new</span> BufferedReader(isr);</span><br><span class="line">			String s;</span><br><span class="line">			s = br.readLine();</span><br><span class="line">			System.out.println(s);</span><br><span class="line">			br.close();</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e2) &#123;</span><br><span class="line">			System.out.println(<span class="string">"找不到指定文件"</span>);</span><br><span class="line">			System.exit(-<span class="number">1</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"FINISH"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>图片：大管道套小管道<br>OutputStreamWriter.write(String str,int off,int len):可以写一个字符串从off开始len个字符。<br>off和len可以缺省，那么默认写全部str。<br>代码中的： osw.write(“    mircosoft ibm sun apple hp”, 3, 2);证实了这个。</p>
<h3 id="282_29_u3001InputStreamReader"><a href="#282_29_u3001InputStreamReader" class="headerlink" title="(2)、InputStreamReader"></a>(2)、InputStreamReader</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTransForm2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">		InputStreamReader isr = <span class="keyword">new</span> InputStreamReader(System.in);</span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(isr);</span><br><span class="line">		String s = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			s = br.readLine();</span><br><span class="line">			<span class="keyword">while</span> (s != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (s.equalsIgnoreCase(<span class="string">"exit"</span>))</span><br><span class="line">					<span class="comment">//如果s的内容是"exit",进来</span></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				System.out.println(s.toUpperCase());</span><br><span class="line">				<span class="comment">//toUpperCase()把小写转换成大写</span></span><br><span class="line">				s = br.readLine();</span><br><span class="line">			&#125;</span><br><span class="line">			br.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>//System.in是个阻塞式的流，如果你没有输入，它就傻傻的等待~<br>图片：三个管道，读字节&gt;读字符&gt;读一行字符串</p>
<h2 id="3_u3001_u6570_u636E_u6D41"><a href="#3_u3001_u6570_u636E_u6D41" class="headerlink" title="3、数据流"></a>3、数据流</h2><p>图片：概念</p>
<h3 id="281_29_u3001DataInputStream_u3001DataOutputStream"><a href="#281_29_u3001DataInputStream_u3001DataOutputStream" class="headerlink" title="(1)、DataInputStream、DataOutputStream"></a>(1)、DataInputStream、DataOutputStream</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestDataStream</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * ByteArrayOutputStream 的创建完成了2个操作：</span><br><span class="line">		 * 一、在内存中分配了一个字节数组（即：缓冲区）</span><br><span class="line">		 * 二、一根流管道怼在了这个字节数组上</span><br><span class="line">		 */</span></span><br><span class="line">		ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">		<span class="comment">// 在baos管道上再套接一层管道dos</span></span><br><span class="line">		DataOutputStream dos = <span class="keyword">new</span> DataOutputStream(baos);</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 向这个流dos里面写了一个double，一个boolean</span><br><span class="line">			 *</span><br><span class="line">			 * 实际上是先把这两个数据写到了刚才在内存中分配</span><br><span class="line">			 * 的字节数组（缓冲区）中暂时保存起来</span><br><span class="line">			 */</span></span><br><span class="line">			dos.writeDouble(Math.random());</span><br><span class="line">			dos.writeBoolean(<span class="keyword">true</span>);</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 创建一个字节数组输入流，将输出流的字节数组（缓冲区）</span><br><span class="line">			 * 的内容以字节数组的形式返回</span><br><span class="line">			 */</span></span><br><span class="line">			ByteArrayInputStream bais = <span class="keyword">new</span> ByteArrayInputStream(</span><br><span class="line">					baos.toByteArray());</span><br><span class="line">			<span class="comment">// 可从此流中读取的剩余字节数</span></span><br><span class="line">			System.out.println(bais.available());</span><br><span class="line">			<span class="comment">// 套在一个流上</span></span><br><span class="line">			DataInputStream dis = <span class="keyword">new</span> DataInputStream(bais);</span><br><span class="line">			<span class="comment">// 读取一个double，一个boolean</span></span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 正确的read的顺序应该和write的顺序相同。</span><br><span class="line">			 * 如果相反，则会产生错误。</span><br><span class="line">			 * “先写先读”-----先进先出-----队列</span><br><span class="line">			 */</span></span><br><span class="line">			System.out.println(dis.readDouble());</span><br><span class="line">			System.out.println(dis.readBoolean());</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 关闭后，字符数组消失，管道都消失</span><br><span class="line">			 */</span></span><br><span class="line">			dos.close();</span><br><span class="line">			dis.close();</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4_u3001print_u6D41"><a href="#4_u3001print_u6D41" class="headerlink" title="4、print流"></a>4、print流</h2><p>图片：概念</p>
<h3 id="281_29_u3001PrintStream"><a href="#281_29_u3001PrintStream" class="headerlink" title="(1)、PrintStream"></a>(1)、PrintStream</h3><h4 id="u2460"><a href="#u2460" class="headerlink" title="①"></a>①</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPrintStream1</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		PrintStream ps = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(</span><br><span class="line">					<span class="string">"e:\\javatest\\8\\io\\char.txt"</span>, <span class="keyword">true</span>);</span><br><span class="line">      <span class="comment">//在文件输出流外再套了一层输出流</span></span><br><span class="line">			ps = <span class="keyword">new</span> PrintStream(fos);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (ps != <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="comment">//设置system的输出流为ps</span></span><br><span class="line">			System.setOut(ps);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"\n中国好声音第四季----周杰伦歌迷见面会~~~~~~~~~~才怪~"</span>);</span><br><span class="line">		ps.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>图片：管道套管道图，把往控制台的输出流设置为自己创建的流。</p>
<h4 id="u2461"><a href="#u2461" class="headerlink" title="②"></a>②</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPrintStream2</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String filename = args[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">if</span> (filename != <span class="keyword">null</span>) &#123;</span><br><span class="line">			list(filename, System.out);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">list</span><span class="params">(String f, PrintStream fs)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(f));</span><br><span class="line">			String s = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">while</span> ((s = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">				fs.println(s);</span><br><span class="line">			&#125;</span><br><span class="line">			br.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			fs.println(<span class="string">"无法读取文件"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>读取一个参数（文件名），然后输出到控制台</p>
<h3 id="282_29_u3001PrintWriter"><a href="#282_29_u3001PrintWriter" class="headerlink" title="(2)、PrintWriter"></a>(2)、PrintWriter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPrintStream3</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String s = <span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 一根管道怼到了标准输入上（键盘上）</span><br><span class="line">		 */</span></span><br><span class="line">		BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 后面带true的参数，用于写日志</span><br><span class="line">			 */</span></span><br><span class="line">			FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">"e:\\javatest\\8\\io\\char.txt"</span>,</span><br><span class="line">					<span class="keyword">true</span>); <span class="comment">// Log4J</span></span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * 又一根管道PrintWriter怼到了FileWriter流上</span><br><span class="line">			 */</span></span><br><span class="line">			PrintWriter log = <span class="keyword">new</span> PrintWriter(fw);</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * br.readLine():此处是从标准输入流中读取一行内容</span><br><span class="line">			 */</span></span><br><span class="line">			<span class="keyword">while</span> ((s = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (s.equalsIgnoreCase(<span class="string">"exit"</span>))</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				System.out.println(s.toUpperCase());</span><br><span class="line">				<span class="comment">/**向指向文件的流里面写数据</span><br><span class="line">				 *</span><br><span class="line">				 */</span></span><br><span class="line">				log.println(<span class="string">"-----"</span>);</span><br><span class="line">				log.println(s.toUpperCase());</span><br><span class="line">				log.flush();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//当写完后，在后面加上日期</span></span><br><span class="line">			log.println(<span class="string">"==="</span> + <span class="keyword">new</span> Date() + <span class="string">"==="</span>);</span><br><span class="line">			<span class="comment">/**</span><br><span class="line">			 * flush()刷新此输出流并强制写出所有缓冲的输出字节</span><br><span class="line">			 */</span></span><br><span class="line">			log.flush();</span><br><span class="line">			log.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5_u3001Object_u6D41"><a href="#5_u3001Object_u6D41" class="headerlink" title="5、Object流"></a>5、Object流</h2><p><strong>直接将Object写入或写出</strong></p>
<blockquote>
<p>*　序列化：把一个Object直接转换为字节流写到硬盘(或者网络)上去。</p>
</blockquote>
<p>Java序列化：</p>
<p>  类通过实现 java.io.Serializable(标记性的接口) 接口以启用其序列化功能。未实现此接口的类将无法使其任何状态序列化或反序列化。可序列化类的所有子类型本身都是可序列化的。<br>  <strong>序列化接口没有方法或字段，仅用于标识可序列化的语义。</strong><br>  类实现Serializable接口，做了标记之后。实质上是告诉编译器，“我可以被序列化，come on~序列化我吧~~”。</p>
<p>关键字transient:<br>修饰变量，在序列化的时候不予考虑(即：往硬盘上写的时候，直接忽视它，当它是透明的)</p>
<p>transient使用小结(原文地址：<a href="http://blog.csdn.net/lanxuezaipiao/article/details/16358677" target="_blank" rel="external">http://blog.csdn.net/lanxuezaipiao/article/details/16358677</a>)<br>1）一旦变量被transient修饰，变量将不再是对象持久化的一部分，该变量内容在序列化后无法获得访问。<br>2）transient关键字只能修饰变量，而不能修饰方法和类。注意，本地变量是不能被transient关键字修饰的。变量如果是用户自定义类变量，则该类需要实现Serializable接口。<br>3）被transient关键字修饰的变量不再能被序列化，一个静态变量不管是否被transient修饰，均不能被序列化。</p>
<h3 id="281_29_u3001ObjectInputStream_u3001ObjectOutputStream"><a href="#281_29_u3001ObjectInputStream_u3001ObjectOutputStream" class="headerlink" title="(1)、ObjectInputStream、ObjectOutputStream"></a>(1)、ObjectInputStream、ObjectOutputStream</h3><p>优点：<br>比DataInputStream、DataOutputStream流更方便，ObjectInputStream、ObjectOutputStream可以直接读写一个Object对象。而不用一个数据一个数据地读写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestObjectIO</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		T t = <span class="keyword">new</span> T();</span><br><span class="line">		t.k = <span class="number">8</span>;</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输出流</span><br><span class="line">		 * 一个管道套一个管道怼在了文件上</span><br><span class="line">		 */</span></span><br><span class="line">		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"e:\\javatest\\8\\char.txt"</span>);</span><br><span class="line">		ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(fos);</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * ObjectOutputStream.writeObject(Object o)//直接写一个对象进去</span><br><span class="line">		 */</span></span><br><span class="line">		oos.writeObject(t);</span><br><span class="line">		oos.flush();</span><br><span class="line">		oos.close();</span><br><span class="line">		<span class="comment">/**</span><br><span class="line">		 * 输入流</span><br><span class="line">		 * 一个管道套一个管道怼在了文件上</span><br><span class="line">		 */</span></span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"e:\\javatest\\8\\char.txt"</span>);</span><br><span class="line">		ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(fis);</span><br><span class="line">		T tReaded = (T) ois.readObject();</span><br><span class="line">		System.out.println(tReaded.i + <span class="string">" "</span> + tReaded.j + <span class="string">" "</span> + tReaded.d + <span class="string">" "</span></span><br><span class="line">				+ tReaded.k);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">9</span>;</span><br><span class="line">	<span class="keyword">double</span> d = <span class="number">2.3</span>;</span><br><span class="line">	<span class="keyword">transient</span> <span class="keyword">int</span> k = <span class="number">15</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此例中，变量k被transient修饰，所以不能被序列化。输出tReaded.k的结果为0。</p>
<p>java.io.Externalizable：<br>实现了Serializable接口，对象序列化的过程自动进行，由JVM帮你控制。这TM自己控制不了它怎么序列化的，总感觉不太爽啊(￢_￢)，Java还很人性的提供了Externalizable接口(估计是顾及到了一些程序员的感受(๑•ᴗ•๑))。</p>
<p>其实，<br>public interface Externalizable extends Serializable<br>它是Serializable的子接口<del>~^_^</del>~<br>程序员可以实现里面的<strong>readExternal(ObjectInput in)和writeExternal(ObjectOutput out)</strong>方法，<br>就可以自己控制序列化的过程。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>//有时间再排版吧，累觉不爱 3/18</p>
<h1 id="u4E00_u3001Java_u7684_u6D41_uFF1A"><a href="#u4E00_u3001Java_u7684_u6D41_uFF1A" class="headerlink" title="一、Java的流："></a>一、Java的流：</h1><blockquote>
<ul>
<li>各种各样的流对应各种各样的管道，它们有些可以套在一起使用。</li>
</ul>
</blockquote>
<p><img src="http://ww1.sinaimg.cn/large/75544e9fjw1f214xcgrxkj20qk04nac5.jpg" alt=""></p>
<h1 id="u4E8C_u3001_u5206_u7C7B_uFF1A"><a href="#u4E8C_u3001_u5206_u7C7B_uFF1A" class="headerlink" title="二、分类："></a>二、分类：</h1><blockquote>
<ul>
<li>输入流，输出流——-文件的流向不同</li>
</ul>
</blockquote>
<h2 id="u8F93_u5165_u6D41_3A_u8FDB_u5165_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29"><a href="#u8F93_u5165_u6D41_3A_u8FDB_u5165_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29" class="headerlink" title="<strong>输入流:进入程序(写的代码)</strong>"></a><strong>输入流:进入程序(写的代码)</strong></h2><h2 id="u8F93_u51FA_u6D41_3A_u4ECE_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29_u51FA_u53BB"><a href="#u8F93_u51FA_u6D41_3A_u4ECE_u7A0B_u5E8F_28_u5199_u7684_u4EE3_u7801_29_u51FA_u53BB" class="headerlink" title="<strong>输出流:从程序(写的代码)出去</strong>"></a><strong>输出流:从程序(写的代码)出去</strong></h2><blockquote>
<ul>
<li><p>字节流，字符流——-处理的数据单位不同</p>
</li>
<li><p>节点流，处理流——-功能不同</p>
</li>
</ul>
</blockquote>]]>
    
    </summary>
    
      <category term="Java" scheme="http://crazyhoney.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[SQL和数据库设计]]></title>
    <link href="http://crazyhoney.github.io/2016/03/17/SQL%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/"/>
    <id>http://crazyhoney.github.io/2016/03/17/SQL和数据库设计/</id>
    <published>2016-03-17T07:56:41.000Z</published>
    <updated>2016-05-04T14:42:18.311Z</updated>
    <content type="html"><![CDATA[<h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><p>(从mysql入手)<br>先数据库，再表，再有数据</p>
<h2 id="u4E00_u3001_u6570_u636E_u5E93_u7BA1_u7406"><a href="#u4E00_u3001_u6570_u636E_u5E93_u7BA1_u7406" class="headerlink" title="一、数据库管理"></a>一、数据库管理</h2><h3 id="1_u3001_u67E5_u8BE2_u6240_u6709_u6570_u636E_u5E93"><a href="#1_u3001_u67E5_u8BE2_u6240_u6709_u6570_u636E_u5E93" class="headerlink" title="1、查询所有数据库"></a>1、查询所有数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">databases</span></span></span><br></pre></td></tr></table></figure>
<h3 id="2_u3001_u521B_u5EFA_u6570_u636E_u5E93"><a href="#2_u3001_u521B_u5EFA_u6570_u636E_u5E93" class="headerlink" title="2、创建数据库"></a>2、创建数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">database</span> 数据库名称      <span class="comment">--使用默认字符集</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> 数据库名称 <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8</span></span><br></pre></td></tr></table></figure>
<h3 id="3_u3001_u67E5_u770B_u6570_u636E_u5E93_u7684_u9ED8_u8BA4_u5B57_u7B26_u96C6"><a href="#3_u3001_u67E5_u770B_u6570_u636E_u5E93_u7684_u9ED8_u8BA4_u5B57_u7B26_u96C6" class="headerlink" title="3、查看数据库的默认字符集"></a>3、查看数据库的默认字符集</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">database</span> 数据库名称</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="4_u3001_u5220_u9664_u6570_u636E_u5E93"><a href="#4_u3001_u5220_u9664_u6570_u636E_u5E93" class="headerlink" title="4、删除数据库"></a>4、删除数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">database</span> 数据库名称</span></span><br></pre></td></tr></table></figure>
<h3 id="5_u3001_u4FEE_u6539_u6570_u636E_u5E93_u5B57_u7B26_u96C6_u683C_u5F0F"><a href="#5_u3001_u4FEE_u6539_u6570_u636E_u5E93_u5B57_u7B26_u96C6_u683C_u5F0F" class="headerlink" title="5、修改数据库字符集格式"></a>5、修改数据库字符集格式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">database</span> 数据库名称 <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> gbk</span></span><br></pre></td></tr></table></figure>
<h2 id="u4E8C_u3001_u8868_u7BA1_u7406"><a href="#u4E8C_u3001_u8868_u7BA1_u7406" class="headerlink" title="二、表管理"></a>二、表管理</h2><h3 id="1_u3001_u67E5_u770B_u6240_u6709_u8868"><a href="#1_u3001_u67E5_u770B_u6240_u6709_u8868" class="headerlink" title="1、查看所有表"></a>1、查看所有表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">tables</span></span></span><br></pre></td></tr></table></figure>
<h3 id="2_u3001_u521B_u5EFA_u8868"><a href="#2_u3001_u521B_u5EFA_u8868" class="headerlink" title="2、创建表"></a>2、创建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> 表名称(</span><br><span class="line">  字段名 字段类型，</span><br><span class="line">  字段名 字段类型(类型长度)</span><br><span class="line">  ...</span><br><span class="line">)</span></span><br></pre></td></tr></table></figure>
<h3 id="3_u3001_u67E5_u770B_u8868_u7ED3_u6784"><a href="#3_u3001_u67E5_u770B_u8868_u7ED3_u6784" class="headerlink" title="3、查看表结构"></a>3、查看表结构</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc 表名</span><br></pre></td></tr></table></figure>
<h3 id="4_u3001_u5220_u9664_u8868"><a href="#4_u3001_u5220_u9664_u8868" class="headerlink" title="4、删除表"></a>4、删除表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">table</span> 表名</span></span><br></pre></td></tr></table></figure>
<h3 id="5_u3001_u4FEE_u6539_u8868"><a href="#5_u3001_u4FEE_u6539_u8868" class="headerlink" title="5、修改表"></a>5、修改表</h3><h4 id="281_29_u3001_u6DFB_u52A0_u5B57_u6BB5"><a href="#281_29_u3001_u6DFB_u52A0_u5B57_u6BB5" class="headerlink" title="(1)、添加字段"></a>(1)、添加字段</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> <span class="keyword">column</span> 字段名 字段类型(类型长度)</span></span><br></pre></td></tr></table></figure>
<h4 id="282_29_u3001_u5220_u9664_u5B57_u6BB5"><a href="#282_29_u3001_u5220_u9664_u5B57_u6BB5" class="headerlink" title="(2)、删除字段"></a>(2)、删除字段</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> <span class="keyword">column</span> 字段名</span></span><br></pre></td></tr></table></figure>
<h4 id="284_29_u3001_u4FEE_u6539_u5B57_u6BB5_u7C7B_u578B"><a href="#284_29_u3001_u4FEE_u6539_u5B57_u6BB5_u7C7B_u578B" class="headerlink" title="(4)、修改字段类型"></a>(4)、修改字段类型</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">modify</span> <span class="keyword">column</span> 字段名 字段类型（类型长度）</span></span><br></pre></td></tr></table></figure>
<h4 id="285_29_u3001_u4FEE_u6539_u5B57_u6BB5_u540D_u79F0"><a href="#285_29_u3001_u4FEE_u6539_u5B57_u6BB5_u540D_u79F0" class="headerlink" title="(5)、修改字段名称"></a>(5)、修改字段名称</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">change</span> <span class="keyword">column</span> 字段名 字段类型（类型长度）</span></span><br></pre></td></tr></table></figure>
<h4 id="286_29_u3001_u4FEE_u6539_u8868_u540D_u79F0"><a href="#286_29_u3001_u4FEE_u6539_u8868_u540D_u79F0" class="headerlink" title="(6)、修改表名称"></a>(6)、修改表名称</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">rename</span> <span class="keyword">to</span> 新表名</span></span><br></pre></td></tr></table></figure>
<h3 id="6_u3001_u589E_u5220_u6539_u6570_u636E"><a href="#6_u3001_u589E_u5220_u6539_u6570_u636E" class="headerlink" title="6、增删改数据"></a>6、增删改数据</h3><h2 id="u4EE5_u540E_u6709_u65F6_u95F4_u518D_u5199_uFF0C_u5E72_u4E0D_u52A8_u4E86_u3002_u5148_u5199_u6570_u636E_u5E93_u8BBE_u8BA1_u7684"><a href="#u4EE5_u540E_u6709_u65F6_u95F4_u518D_u5199_uFF0C_u5E72_u4E0D_u52A8_u4E86_u3002_u5148_u5199_u6570_u636E_u5E93_u8BBE_u8BA1_u7684" class="headerlink" title="以后有时间再写，干不动了。先写数据库设计的"></a>以后有时间再写，干不动了。先写数据库设计的</h2><hr>
<h1 id="u6570_u636E_u5E93_u8BBE_u8BA1"><a href="#u6570_u636E_u5E93_u8BBE_u8BA1" class="headerlink" title="数据库设计"></a>数据库设计</h1><p>键：一个属性或多个属性组合<br>候选键：用来唯一标识一条元组。（一个关系可以有多个）<br>主键：所有候选键拿出来用的键。（一个关系只能有一个）</p>
<h2 id="u4E00_u3001_u8303_u5F0F"><a href="#u4E00_u3001_u8303_u5F0F" class="headerlink" title="一、范式"></a>一、范式</h2><h3 id="u7B2C_u4E00_u8303_u5F0F_281NF_29"><a href="#u7B2C_u4E00_u8303_u5F0F_281NF_29" class="headerlink" title="第一范式(1NF)"></a>第一范式(1NF)</h3><p>条件：关系R的每个属性的值域是不可分割的值。<br>即：要求每个字段必须是不可分割的独立单元</p>
<h3 id="u7B2C_u4E8C_u8303_u5F0F_282NF_29"><a href="#u7B2C_u4E8C_u8303_u5F0F_282NF_29" class="headerlink" title="第二范式(2NF)"></a>第二范式(2NF)</h3><p>条件一：关系R是1NF<br>条件二：关系R的每个<strong>非主属性</strong>都完全依赖于候选键（这种依赖包括传递的依赖）<br>A-&gt;B : A决定B，B依赖A<br>A-&gt;B B-&gt;C : A决定C。C依赖A（B传递了C对A的依赖）</p>
<h3 id="u7B2C_u4E09_u8303_u5F0F_283NF_29"><a href="#u7B2C_u4E09_u8303_u5F0F_283NF_29" class="headerlink" title="第三范式(3NF)"></a>第三范式(3NF)</h3><p>条件一：关系R是2NF<br>条件二：关系R的每个<strong>非主属性</strong>都不传递对候选键的依赖。<br>即：每个非主属性都依赖于某一候选键（这种依赖不包括传递的依赖）</p>
<h3 id="BSCNF_u8303_u5F0F"><a href="#BSCNF_u8303_u5F0F" class="headerlink" title="BSCNF范式"></a>BSCNF范式</h3><p>条件一：关系R是1NF<br>条件二：关系R的每个<strong>属性</strong>都不传递对候选键的依赖。</p>
<p>理解：3NF说的是每个非主属性，而BCNF范式说的是每个属性。<br>因为主属性（主键）可以是属性的组合。所以存在以下情况：<br>存在关系R: (A,B)-&gt;B B-&gt;C  (A,B)是关系的候选键也是主键，B传递了C对于候选键的依赖。<br>所以R不是BCNF。<br>以后再来这个补充例子</p>
<p>2016-03-17 17：03</p>
<hr>
<h2 id="u4E8C_u3001_u5173_u7CFB_u7684_u5BF9_u5E94_u8054_u7CFB"><a href="#u4E8C_u3001_u5173_u7CFB_u7684_u5BF9_u5E94_u8054_u7CFB" class="headerlink" title="二、关系的对应联系"></a>二、关系的对应联系</h2><h3 id="1_u3001_u4E00_u5BF9_u4E00_u8054_u7CFB_281_3A1_29"><a href="#1_u3001_u4E00_u5BF9_u4E00_u8054_u7CFB_281_3A1_29" class="headerlink" title="1、一对一联系(1:1)"></a>1、一对一联系(1:1)</h3><p>一个关系的一条元组唯一对另一个关系的一条元组。</p>
<blockquote>
<ul>
<li>两个关系的联系实质是在看两个关系的同名属性上的值的对应联系。</li>
</ul>
</blockquote>
<p><strong>两个关系通过候选键属性进行关联</strong></p>
<h3 id="2_u3001_u4E00_u5BF9_u591A_u8054_u7CFB_281_3An_29"><a href="#2_u3001_u4E00_u5BF9_u591A_u8054_u7CFB_281_3An_29" class="headerlink" title="2、一对多联系(1:n)"></a>2、一对多联系(1:n)</h3><p>一个关系的一条元组对应另一个关系的多条元组<br>条件：1）两个关系有同名属性<br>      2）一方的同名属性一定是候选键<br>         多方的同名属性一定不是候选键（是外键）<br>外键：连个关系在关联时，多方的同名属性。<br>    作用：保证两个关系的关联。</p>
<h3 id="3_u3001_u591A_u5BF9_u591A_u8054_u7CFB_28m_3An_29"><a href="#3_u3001_u591A_u5BF9_u591A_u8054_u7CFB_28m_3An_29" class="headerlink" title="3、多对多联系(m:n)"></a>3、多对多联系(m:n)</h3><blockquote>
<p><em>　两个关系必然没有同名属性，且不可将一方主键加到另一方作外键。
</em>　两个关系分别向对方是一对多。</p>
</blockquote>
<p><strong>解决多对多联系：</strong></p>
<blockquote>
<ul>
<li>产生第三方联系表。</li>
</ul>
</blockquote>
<p>第三方表：</p>
<p>a)包含两个多方候选键（主键）</p>
<p>b)主键：包含两个多方表的主键</p>
<p>c)外键：两个，分别是两个多方表的主键</p>
<blockquote>
<ul>
<li>将一个多对多(m:n)——&gt;两个一对多(1:n)</li>
</ul>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><p>(从mysql入手)<br>先数据库，再表，再有数据</p>
<h2 id="u4E00_u3001_u6570_u636E_u5E93_u7BA1_u7406"><a href="#u4E00_u3001_u6570_u636E_u5E93_u7BA1_u7406" class="headerlink" title="一、数据库管理"></a>一、数据库管理</h2><h3 id="1_u3001_u67E5_u8BE2_u6240_u6709_u6570_u636E_u5E93"><a href="#1_u3001_u67E5_u8BE2_u6240_u6709_u6570_u636E_u5E93" class="headerlink" title="1、查询所有数据库"></a>1、查询所有数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">databases</span></span></span><br></pre></td></tr></table></figure>
<h3 id="2_u3001_u521B_u5EFA_u6570_u636E_u5E93"><a href="#2_u3001_u521B_u5EFA_u6570_u636E_u5E93" class="headerlink" title="2、创建数据库"></a>2、创建数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">database</span> 数据库名称      <span class="comment">--使用默认字符集</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> 数据库名称 <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8</span></span><br></pre></td></tr></table></figure>
<h3 id="3_u3001_u67E5_u770B_u6570_u636E_u5E93_u7684_u9ED8_u8BA4_u5B57_u7B26_u96C6"><a href="#3_u3001_u67E5_u770B_u6570_u636E_u5E93_u7684_u9ED8_u8BA4_u5B57_u7B26_u96C6" class="headerlink" title="3、查看数据库的默认字符集"></a>3、查看数据库的默认字符集</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">database</span> 数据库名称</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="数据库" scheme="http://crazyhoney.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Java线程复习]]></title>
    <link href="http://crazyhoney.github.io/2016/03/17/Java%E7%BA%BF%E7%A8%8B%E5%A4%8D%E4%B9%A0/"/>
    <id>http://crazyhoney.github.io/2016/03/17/Java线程复习/</id>
    <published>2016-03-17T03:06:14.000Z</published>
    <updated>2016-05-04T14:41:57.012Z</updated>
    <content type="html"><![CDATA[<h2 id="join_28_29_u64CD_u4F5C_uFF1A"><a href="#join_28_29_u64CD_u4F5C_uFF1A" class="headerlink" title="join()操作："></a>join()操作：</h2><p>在主程序中，线程.join()操作，会使主程序（主线程）等待线程执行结束才继续向下执行。<br><strong>相当于方法调用</strong>。</p>
<h2 id="yield_28_29_u64CD_u4F5C_uFF1A"><a href="#yield_28_29_u64CD_u4F5C_uFF1A" class="headerlink" title="yield()操作："></a>yield()操作：</h2><p>当在这个线程中调用了yield()之后，当前线程会让出CPU资源一小会，让别的线程去执行。</p>
<p>举例&lt;(￣︶￣)&gt;:</p>
<p>你在厕所坑位前准备上厕所，来了一个人急的马上要拉到裤子上了。你调用一下yield(),说：“你先来吧，我先让你上厕所！”</p>
<a id="more"></a>
<h2 id="synchronized_u64CD_u4F5C"><a href="#synchronized_u64CD_u4F5C" class="headerlink" title="synchronized操作"></a>synchronized操作</h2><h3 id="synchronized_u65B9_u6CD5_uFF1A"><a href="#synchronized_u65B9_u6CD5_uFF1A" class="headerlink" title="synchronized方法："></a>synchronized方法：</h3><p>在执行这个方法的过程中，当前对象被锁定。其他线程不能访问该对象的synchronized方法。<br>但是，其他线程去访问，当前对象所在类的其他对象时，却没有限制。因为是该对象呗上锁，其他对象并没有。</p>
<blockquote>
<p>*如果两个线程要执行一个类中的synchronized方法，并且两个线程使用相同的实例来调用方法，那么一次只能有一个线程能够执行方法，另一个需要等待，直到锁被释放。</p>
</blockquote>
<p><strong>也就是说：如果一个线程在对象上获得一个锁，就没有任何其他线程可以进入（该对象的）类中的任何一个同步方法。</strong><br>例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * TestSynchronized2.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年3月16日 下午8:25:11</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSynchronized2</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> b = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		<span class="comment">//Thread.sleep(2000);</span></span><br><span class="line">		System.out.println(<span class="string">"================"</span>);</span><br><span class="line">		System.out.println(<span class="string">"我进入了m1()"</span>);</span><br><span class="line"></span><br><span class="line">		b = <span class="number">1000</span>;</span><br><span class="line">		System.out.println(<span class="string">"我在m1()"</span>);</span><br><span class="line">		Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">		System.out.println(<span class="string">"我等了5秒"</span>);</span><br><span class="line">		System.out.println(<span class="string">"m1:b = "</span> + b);</span><br><span class="line">		System.out.println(<span class="string">"我离开了m1()"</span>);		</span><br><span class="line">		System.out.println(<span class="string">"================"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"================"</span>);</span><br><span class="line">		System.out.println(<span class="string">"我进入了m2()"</span>);</span><br><span class="line">		Thread.sleep(<span class="number">5500</span>);</span><br><span class="line">		System.out.println(<span class="string">"我等了5.5秒"</span>);</span><br><span class="line">		System.out.println(<span class="string">"我在m2()"</span>);</span><br><span class="line">		b = <span class="number">2000</span>;</span><br><span class="line">		System.out.println(<span class="string">"m2: b= "</span>+b);</span><br><span class="line">		System.out.println(<span class="string">"我离开了m2()"</span>);</span><br><span class="line">		System.out.println(<span class="string">"================"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			m1();</span><br><span class="line">		&#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		TestSynchronized2 tt = <span class="keyword">new</span> TestSynchronized2();</span><br><span class="line">		Thread t = <span class="keyword">new</span> Thread(tt);</span><br><span class="line">		t.start();</span><br><span class="line"></span><br><span class="line">		tt.m2();</span><br><span class="line">		System.out.println(<span class="string">"tt.b="</span>+tt.b);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="u7ED3_u679C_uFF1A"><a href="#u7ED3_u679C_uFF1A" class="headerlink" title="结果："></a>结果：</h2><p><img src="http://ww2.sinaimg.cn/large/75544e9fjw1f1z1sa3pybj205j09t0u7.jpg" alt=""></p>
<p>同一个对象的2个线程去分别访问该对象的两个synchronized方法，结果是一个执行结束后，再执行另外一个。印证了上面的说法。</p>
<h3 id="synchronized_u5757_uFF1A"><a href="#synchronized_u5757_uFF1A" class="headerlink" title="synchronized块："></a>synchronized块：</h3><p>在执行当前代码块过程中，当前代码块被锁定，其他线程不能访问这个代码块。<br>但是其他的部分（<strong>未被synchronized(this)修饰的代码</strong>）可以被其他线程访问。（亲测有效）<br>以下例子测试未被synchronized(this)修饰的代码是否可以被其他线程访问</p>
<blockquote>
<ul>
<li>主线程开启了一个t的线程，调用（被synchronized修饰的）m1()。在里面sleep()5秒钟。然后把b赋为1000。</li>
<li>主线程自己调用该类中（未被synchronized修饰的）m2()，把b赋为2000。</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * TestSynchronized.java</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年3月16日 下午8:02:40</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@author</span> Administrator</span><br><span class="line"> *</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSynchronized</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> b = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">		b = <span class="number">1000</span>;</span><br><span class="line">		System.out.println(<span class="string">"b = "</span> + b);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		b = <span class="number">2000</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			m1();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		TestSynchronized tt = <span class="keyword">new</span> TestSynchronized();</span><br><span class="line">		Thread t = <span class="keyword">new</span> Thread(tt);</span><br><span class="line">		t.start();</span><br><span class="line"></span><br><span class="line">		tt.m2();</span><br><span class="line">		System.out.println(tt.b);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>结果如下：</strong></p>
<p><img src="http://ww4.sinaimg.cn/large/75544e9fjw1f1yyyt6bkbj206g0510t8.jpg" alt=""></p>
<p>证实：未被synchronized修饰的代码，可以在<strong>被加锁的代码执行时</strong>可以被其他线程访问。</p>
<h2 id="sleep_28_29_u64CD_u4F5C"><a href="#sleep_28_29_u64CD_u4F5C" class="headerlink" title="sleep()操作"></a>sleep()操作</h2><p>在程序中Thread.sleep(<strong>毫秒</strong>)<br>可以让程序睡眠<strong>毫秒</strong>的时长。</p>
<h3 id="u4F46_u662F"><a href="#u4F46_u662F" class="headerlink" title="但是"></a>但是</h3><p>如果是在synchronized修饰的代码块（或者方法）中，有sleep操作，当前的锁不会被释放。知道被锁定的代码块（或者方法）执行完毕，锁才会被释放。</p>
<p><strong>即：sleep():睡着了，仍然抱着锁。</strong></p>
<h2 id="wait_28_29_u64CD_u4F5C"><a href="#wait_28_29_u64CD_u4F5C" class="headerlink" title="wait()操作"></a>wait()操作</h2><p>这是java.lang.object类里面的操作，换句话说：这是所有类的老祖宗拥有的方法，所以所有对象都可以调用这个方法。</p>
<blockquote>
<ul>
<li>例如：<br>this.wait();<br>表示：在当前的正在访问这个对象的线程wait。</li>
<li>wait()之后，之前此线程拥有的锁，就不在归它所有了。锁被释放了。</li>
</ul>
</blockquote>
<h2 id="u5F3A_u8C03_uFF1A"><a href="#u5F3A_u8C03_uFF1A" class="headerlink" title="强调："></a>强调：</h2><p><strong>wait()操作必须和synchronized()一起使用。</strong></p>
<p>即，这个线程只有拥有了一把锁（锁方法，或者锁代码块），才可以wait()。<br>在代码层面：wait()方法必须在synchronized(){…}语句块内被调用。</p>
<h2 id="notify_28_29_u64CD_u4F5C"><a href="#notify_28_29_u64CD_u4F5C" class="headerlink" title="notify()操作"></a>notify()操作</h2><p>this.notify()：叫醒一个正在当前对象上wait的线程。</p>
<blockquote>
<ul>
<li>notify()和wait()一般是一一对应的。</li>
</ul>
</blockquote>
<h2 id="notifyAll_28_29_u64CD_u4F5C"><a href="#notifyAll_28_29_u64CD_u4F5C" class="headerlink" title="notifyAll()操作"></a>notifyAll()操作</h2><p>this.notifyAll()：叫醒当前wait在此对象上的所有线程。</p>
<p><strong>但是：例如有3个线程A,B,C wait()在该对象上，调用了notifyAll()后，也只有一个线程获得锁继续执行，等它执行完后，其他2个才一个一个地执行（其中的顺序应该是由JVM决定的）</strong></p>
<h3 id="u4EE5_u4E0B_u662F_u5F15_u7528_u4E00_u4E2A_u4EC1_u5144_u5728_u767E_u5EA6_u4E0A_u7684_u56DE_u7B54_uFF0C_u89C9_u5F97_u5F88_u6709_u9053_u7406_uFF1A"><a href="#u4EE5_u4E0B_u662F_u5F15_u7528_u4E00_u4E2A_u4EC1_u5144_u5728_u767E_u5EA6_u4E0A_u7684_u56DE_u7B54_uFF0C_u89C9_u5F97_u5F88_u6709_u9053_u7406_uFF1A" class="headerlink" title="以下是引用一个仁兄在百度上的回答，觉得很有道理："></a>以下是引用一个仁兄在百度上的回答，觉得很有道理：</h3><hr>
<p><strong>调用notifyAll通知所有线程继续执行，只能有一个线程在执行其余的线程在等待(因为在所有线程被唤醒的时候在synchornized块中)。这时的等待和调用notifyAll前的等待是不一样的。</strong></p>
<p><strong>notifyAll前：在对象上休息区内休息</strong></p>
<p><strong>notifyAll后：在排队等待获得对象锁。</strong></p>
<p><strong>notify和notifyAll都是把某个对象上休息区内的线程唤醒,notify只能唤醒一个,但究竟是哪一个不能确定,而notifyAll则唤醒这个对象上的休息室中所有的线程。</strong></p>
<hr>
<h2 id="sleep_28_29_u548Cwait_28_29_u7684_u91CD_u5927_u533A_u522B_uFF1A"><a href="#sleep_28_29_u548Cwait_28_29_u7684_u91CD_u5927_u533A_u522B_uFF1A" class="headerlink" title="sleep()和wait()的重大区别："></a>sleep()和wait()的重大区别：</h2><p><strong>sleep:睡着了，抱着锁</strong></p>
<blockquote>
<p>*　sleep()是Thread类的方法，sleep()执行时，（如果锁定了对象）别的线程不能访问被锁定对象。</p>
</blockquote>
<p><strong>wait: 睡着了，放开锁</strong></p>
<blockquote>
<p>*　wait()是Object类的方法，wait()执行时，（必须是在锁定对象里调用wait）别的线程可以访问被锁定对象。</p>
</blockquote>
<p>场景应用：<br>对于一个数据库文件，读操作是可以让多线程同时访问的(读一下又不会怀孕(๑•ᴗ•๑))，但是写操作应该是要加锁的，否则就会出现数据不一致等问题。</p>
<p>类比：大街上看见一美女，看操作是可以让很多人(多线程)同时看的(又不犯法)，但是搭讪操作应该是要加锁的，否则你让美女跟哪个人说话，美女不就乱套了吗？<br>P.S 当然更不能摸。</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="join_28_29_u64CD_u4F5C_uFF1A"><a href="#join_28_29_u64CD_u4F5C_uFF1A" class="headerlink" title="join()操作："></a>join()操作：</h2><p>在主程序中，线程.join()操作，会使主程序（主线程）等待线程执行结束才继续向下执行。<br><strong>相当于方法调用</strong>。</p>
<h2 id="yield_28_29_u64CD_u4F5C_uFF1A"><a href="#yield_28_29_u64CD_u4F5C_uFF1A" class="headerlink" title="yield()操作："></a>yield()操作：</h2><p>当在这个线程中调用了yield()之后，当前线程会让出CPU资源一小会，让别的线程去执行。</p>
<p>举例&lt;(￣︶￣)&gt;:</p>
<p>你在厕所坑位前准备上厕所，来了一个人急的马上要拉到裤子上了。你调用一下yield(),说：“你先来吧，我先让你上厕所！”</p>]]>
    
    </summary>
    
      <category term="Java" scheme="http://crazyhoney.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[设计模式（六）]]></title>
    <link href="http://crazyhoney.github.io/2016/03/14/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E5%85%AD%EF%BC%89/"/>
    <id>http://crazyhoney.github.io/2016/03/14/设计模式（六）/</id>
    <published>2016-03-14T09:23:04.000Z</published>
    <updated>2016-05-04T14:44:17.086Z</updated>
    <content type="html"><![CDATA[<h1 id="u7B56_u7565_u6A21_u5F0F"><a href="#u7B56_u7565_u6A21_u5F0F" class="headerlink" title="策略模式"></a>策略模式</h1><h2 id="u7B80_u5355_u7684_u8BF4_u5C31_u662F_28_u0E51_u2022_u1D17_u2022_u0E51_29_uFF1A"><a href="#u7B80_u5355_u7684_u8BF4_u5C31_u662F_28_u0E51_u2022_u1D17_u2022_u0E51_29_uFF1A" class="headerlink" title="简单的说就是(๑•ᴗ•๑)："></a>简单的说就是(๑•ᴗ•๑)：</h2><blockquote>
<ul>
<li>有好几个算法（方法）的接口一样，专门让一个类A去操作它，并且把实际的操作封装到A的方法中。</li>
</ul>
</blockquote>
<h2 id="u4E13_u4E1A_u4E00_u70B9_u5C31_u662F-_28_u0E51_26gt_3B_u0602_26lt_3B_u0E51_29_u06F6_uFF1A"><a href="#u4E13_u4E1A_u4E00_u70B9_u5C31_u662F-_28_u0E51_26gt_3B_u0602_26lt_3B_u0E51_29_u06F6_uFF1A" class="headerlink" title="专业一点就是.(๑&gt;؂&lt;๑)۶："></a>专业一点就是.(๑&gt;؂&lt;๑)۶：</h2><blockquote>
<ul>
<li>定义了算法家族，分别封装起来，让它们之间可以相互替换，从模式让算法的变化，不会影响到算法的客户。</li>
</ul>
</blockquote>
<p><img src="http://yun.baozoumanhua.com/Project/RageMaker0/images/0/5.png" alt=""></p>
<p><img src="http://ww4.sinaimg.cn/large/75544e9fjw1f1wj6m43djj20ml0etaby.jpg" alt=""><br><strong>介个问题且听下回分解(✿◡‿◡)</strong></p>
<p><img src="http://jellythink.u.qiniudn.com/jellythinkStrategy.png" alt="Strategy"></p>
<h2 id="u505A_u6CD5"><a href="#u505A_u6CD5" class="headerlink" title="做法"></a>做法</h2><blockquote>
<ul>
<li><strong>Context包含一个Strategy基类的指针，可以指向传入的Strategy子类对象</strong></li>
<li><strong>Context的getResult方法，直接用基类指针调用子类的方法实现功能</strong></li>
</ul>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * Strategy.cpp</span><br><span class="line"> *	策略模式</span><br><span class="line"> *  Created on: 2016年3月14日 下午4:30:31</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> CashSuper &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">acceptCash</span><span class="params">(<span class="keyword">double</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//原价类</span></span><br><span class="line"><span class="keyword">class</span> CashNormal: <span class="keyword">public</span> CashSuper &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">acceptCash</span><span class="params">(<span class="keyword">double</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> money;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//打折类</span></span><br><span class="line"><span class="keyword">class</span> CashRebate: <span class="keyword">public</span> CashSuper &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">double</span> moneyRebate;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	CashRebate(<span class="keyword">double</span> mR) &#123;</span><br><span class="line">		moneyRebate = mR;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">acceptCash</span><span class="params">(<span class="keyword">double</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> money * moneyRebate;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//返现类</span></span><br><span class="line"><span class="keyword">class</span> CashReturn: <span class="keyword">public</span> CashSuper &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">double</span> moneyCondition;</span><br><span class="line">	<span class="keyword">double</span> moneyReturn;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	CashReturn(<span class="keyword">double</span> mC, <span class="keyword">double</span> mR) &#123;</span><br><span class="line">		moneyCondition = mC;</span><br><span class="line">		moneyReturn = mR;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">acceptCash</span><span class="params">(<span class="keyword">double</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">double</span> reult = money;</span><br><span class="line">		<span class="keyword">if</span> (money &gt;= moneyCondition) &#123;</span><br><span class="line">			reult = money - <span class="built_in">floor</span>((money / moneyCondition)) * moneyReturn;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> reult;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//具体的操作类</span></span><br><span class="line"><span class="keyword">class</span> Context &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	CashSuper *cs;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Context(CashSuper * CS) &#123;</span><br><span class="line">		cs = CS;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">GetResult</span><span class="params">(<span class="keyword">double</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cs-&gt;acceptCash(money);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	Context *c = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">int</span> choice;</span><br><span class="line">	<span class="keyword">double</span> money;</span><br><span class="line">	<span class="keyword">double</span> result;</span><br><span class="line">	<span class="comment">//printf("hello\n");</span></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入金额（&gt;0）：\n"</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; money;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入打折方式："</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"1------原价"</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"2------打八折"</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"3------满300返100"</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; choice;</span><br><span class="line">		<span class="keyword">if</span> (choice == <span class="number">1</span> || choice == <span class="number">2</span> || choice == <span class="number">3</span>) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"输入有误，请输入1、2和3中任一数字"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">switch</span> (choice) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">		c = <span class="keyword">new</span> Context(<span class="keyword">new</span> CashNormal());</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		c = <span class="keyword">new</span> Context(<span class="keyword">new</span> CashRebate(<span class="number">0.8</span>));</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		c = <span class="keyword">new</span> Context(<span class="keyword">new</span> CashReturn(<span class="number">300</span>, <span class="number">100</span>));</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	result = c-&gt;GetResult(money);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"result = "</span> &lt;&lt; result &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u7B56_u7565_u6A21_u5F0F"><a href="#u7B56_u7565_u6A21_u5F0F" class="headerlink" title="策略模式"></a>策略模式</h1><h2 id="u7B80_u5355_u7684_u]]>
    </summary>
    
      <category term="设计模式" scheme="http://crazyhoney.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[设计模式（五）]]></title>
    <link href="http://crazyhoney.github.io/2016/03/14/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%BA%94%EF%BC%89/"/>
    <id>http://crazyhoney.github.io/2016/03/14/设计模式（五）/</id>
    <published>2016-03-14T04:46:43.000Z</published>
    <updated>2016-05-04T14:44:12.366Z</updated>
    <content type="html"><![CDATA[<h1 id="u5355_u4F8B_u6A21_u5F0F"><a href="#u5355_u4F8B_u6A21_u5F0F" class="headerlink" title="单例模式"></a>单例模式</h1><h2 id="u7B80_u5355_u7684_u8BF4_u5C31_u662F_28_u0E51_u2022_u1D17_u2022_u0E51_29_uFF1A"><a href="#u7B80_u5355_u7684_u8BF4_u5C31_u662F_28_u0E51_u2022_u1D17_u2022_u0E51_29_uFF1A" class="headerlink" title="简单的说就是(๑•ᴗ•๑)："></a>简单的说就是(๑•ᴗ•๑)：</h2><blockquote>
<ul>
<li>你点一下一个按钮（比如说：帮助-&gt;关于），你再点一次的话，它不会再弹出一个窗口。</li>
<li>类比：<br>  计划生育，让你只能生一个孩子。</li>
</ul>
</blockquote>
<h2 id="u4E13_u4E1A_u4E00_u70B9_u5C31_u662F_28_uFFE2__uFFE2_29_uFF1A"><a href="#u4E13_u4E1A_u4E00_u70B9_u5C31_u662F_28_uFFE2__uFFE2_29_uFF1A" class="headerlink" title="专业一点就是(￢_￢)："></a>专业一点就是(￢_￢)：</h2><blockquote>
<ul>
<li>保证一个类仅有一个实例，并提供一个访问它的全局访问点。</li>
</ul>
</blockquote>
<p><img src="http://www.cxyclub.cn/Upload/Images/2013072518/40FF1255E7B9ADFF.png" alt="Singleton"></p>
<h2 id="u505A_u6CD5"><a href="#u505A_u6CD5" class="headerlink" title="做法"></a>做法</h2><blockquote>
<ul>
<li><strong>构造函数私有化（类外不可以调用构造函数，便不可以创建对象）</strong></li>
<li><strong>有一个私有的静态的成员变量（属性），可以是指针、引用或者对象（见“饿汉”）</strong></li>
<li><strong>有一个公有的函数，可以返回一个该类对象（如果有的话直接返回，如果没有则创建）</strong></li>
</ul>
</blockquote>
<h2 id="u61D2_u6C49"><a href="#u61D2_u6C49" class="headerlink" title="懒汉"></a>懒汉</h2><blockquote>
<ul>
<li><strong>顾名思义：需要创建时才创建对象</strong></li>
</ul>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * Singleton.cpp</span><br><span class="line"> *	单例模式</span><br><span class="line"> *  Created on: 2016年3月11日 下午3:38:31</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 懒汉：需要创建时才创建对象</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">class</span> Singleton &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">static</span> Singleton * instance;</span><br><span class="line">	Singleton() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> Singleton * <span class="title">GetInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (instance == <span class="literal">NULL</span>) &#123;</span><br><span class="line">      <span class="comment">//懒汉，进入函数后判断是否创建，如果未创建则创建对象</span></span><br><span class="line">			instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> instance;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//这里不创建</span></span><br><span class="line">Singleton* Singleton::instance = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="comment">//懒汉</span></span><br><span class="line">	Singleton * s1 = Singleton::GetInstance();</span><br><span class="line">	Singleton * s2 = Singleton::GetInstance();</span><br><span class="line">	<span class="keyword">if</span> (s1 == s2) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"s1 == s2"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u997F_u6C49"><a href="#u997F_u6C49" class="headerlink" title="饿汉"></a>饿汉</h2><blockquote>
<ul>
<li><strong>顾名思义：从一开始加载的时候就创建对象</strong></li>
</ul>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * singleton2.cpp</span><br><span class="line"> *	单例模式  饿汉</span><br><span class="line"> *  Created on: 2016年3月11日 下午4:24:03</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">class</span> singleton &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">static</span> singleton* instance;</span><br><span class="line">	singleton() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> singleton* <span class="title">GetInstace</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//饿汉，直接返回已经创建好的对象</span></span><br><span class="line">		<span class="keyword">return</span> instance;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//这里直接创建</span></span><br><span class="line">singleton* singleton::instance = <span class="keyword">new</span> singleton();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	singleton* s1 = singleton::GetInstace();</span><br><span class="line">	singleton* s2 = singleton::GetInstace();</span><br><span class="line">	<span class="keyword">if</span> (s1 == s2) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"s1 == s2"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="u5355_u4F8B_u6A21_u5F0F"><a href="#u5355_u4F8B_u6A21_u5F0F" class="headerlink" title="单例模式"></a>单例模式</h1><h2 id="u7B80_u5355_u7684_u]]>
    </summary>
    
      <category term="设计模式" scheme="http://crazyhoney.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[设计模式（四）]]></title>
    <link href="http://crazyhoney.github.io/2016/03/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
    <id>http://crazyhoney.github.io/2016/03/13/设计模式（四）/</id>
    <published>2016-03-13T13:41:52.000Z</published>
    <updated>2016-05-04T14:44:24.084Z</updated>
    <content type="html"><![CDATA[<h2 id="u9002_u914D_u5668_u6A21_u5F0F"><a href="#u9002_u914D_u5668_u6A21_u5F0F" class="headerlink" title="适配器模式"></a>适配器模式</h2><h2 id="u7B80_u5355_u7684_u8BF4_u5C31_u662F_28_u0E51_u2022_u1D17_u2022_u0E51_29_uFF1A"><a href="#u7B80_u5355_u7684_u8BF4_u5C31_u662F_28_u0E51_u2022_u1D17_u2022_u0E51_29_uFF1A" class="headerlink" title="简单的说就是(๑•ᴗ•๑)："></a>简单的说就是(๑•ᴗ•๑)：</h2><p>电源适配器（把220V的交流电转换为电器能够使用的电压）</p>
<h2 id="u4E13_u4E1A_u4E00_u70B9_u5C31_u662F_28_u2299_u02CD_u2299_29_uFF1A"><a href="#u4E13_u4E1A_u4E00_u70B9_u5C31_u662F_28_u2299_u02CD_u2299_29_uFF1A" class="headerlink" title="专业一点就是(⊙ˍ⊙)："></a>专业一点就是(⊙ˍ⊙)：</h2><p>想复用一些现成的类，但是接口又与复用环境要求不一致。那么使用适配器转换接口。</p>
<hr>
<h2 id="1_u3001_u7C7B_u9002_u914D_u5668"><a href="#1_u3001_u7C7B_u9002_u914D_u5668" class="headerlink" title="1、类适配器"></a>1、类适配器</h2><ul>
<li>[x] 适用于C++（因为它支持多继承）</li>
</ul>
<p><img src="http://www.myexception.cn/img/2012/09/10/111548767.jpg" alt="ClassAdapter"></p>
<h2 id="u9002_u914D_u5668_u7C7B_u7EE7_u627F_u4E86Target_u548CAdaptee_u7684_u65B9_u6CD5_uFF0C_u6240_u4EE5_u53EF_u4EE5_u76F4_u63A5_u5728_u65B9_u6CD5_u4E2D_u8C03_u7528Adaptee_u7684_u65B9_u6CD5_uFF0C_u5B9E_u73B0_u63A5_u53E3_u7684_u8F6C_u6362"><a href="#u9002_u914D_u5668_u7C7B_u7EE7_u627F_u4E86Target_u548CAdaptee_u7684_u65B9_u6CD5_uFF0C_u6240_u4EE5_u53EF_u4EE5_u76F4_u63A5_u5728_u65B9_u6CD5_u4E2D_u8C03_u7528Adaptee_u7684_u65B9_u6CD5_uFF0C_u5B9E_u73B0_u63A5_u53E3_u7684_u8F6C_u6362" class="headerlink" title="<strong>适配器类继承了Target和Adaptee的方法，所以可以直接在方法中调用Adaptee的方法，实现接口的转换</strong>"></a><strong>适配器类继承了Target和Adaptee的方法，所以可以直接在方法中调用Adaptee的方法，实现接口的转换</strong></h2><h2 id="2_u3001_u5BF9_u8C61_u9002_u914D_u5668"><a href="#2_u3001_u5BF9_u8C61_u9002_u914D_u5668" class="headerlink" title="2、对象适配器"></a>2、对象适配器</h2><p><img src="http://www.myexception.cn/img/2012/06/25/1359217096.png" alt="ObjectAdapter"></p>
<h2 id="u9002_u914D_u5668_u7C7B_u7EE7_u627F_u4E86Target_u7684_u65B9_u6CD5_uFF0C_u5E76_u4E14_u542B_u6709Adaptee_u7684_u5BF9_u8C61_uFF08_u6216_u8005_u6307_u9488_uFF09_u3002_u53EF_u4EE5_u518D_u65B9_u6CD5_u4E2D_u8C03_u7528Adaptee_u7684_u65B9_u6CD5_uFF0C_u5B9E_u73B0_u63A5_u53E3_u8F6C_u6362"><a href="#u9002_u914D_u5668_u7C7B_u7EE7_u627F_u4E86Target_u7684_u65B9_u6CD5_uFF0C_u5E76_u4E14_u542B_u6709Adaptee_u7684_u5BF9_u8C61_uFF08_u6216_u8005_u6307_u9488_uFF09_u3002_u53EF_u4EE5_u518D_u65B9_u6CD5_u4E2D_u8C03_u7528Adaptee_u7684_u65B9_u6CD5_uFF0C_u5B9E_u73B0_u63A5_u53E3_u8F6C_u6362" class="headerlink" title="<strong>适配器类继承了Target的方法，并且含有Adaptee的对象（或者指针）。可以再方法中调用Adaptee的方法，实现接口转换</strong>"></a><strong>适配器类继承了Target的方法，并且含有Adaptee的对象（或者指针）。可以再方法中调用Adaptee的方法，实现接口转换</strong></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * Adapter.cpp</span><br><span class="line"> *</span><br><span class="line"> *  Created on: 2016年3月11日 下午4:48:49</span><br><span class="line"> *      Author: Wayne 13186259527@163.com</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Target &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"我要20V的电压"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> Adaptee &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SpecialMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"我这里提供10V的电压"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类适配器</span></span><br><span class="line"><span class="keyword">class</span> ClsAdapter: <span class="keyword">public</span> Target, <span class="keyword">private</span> Adaptee &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"类适配器"</span> &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"你要20V，我给你20V"</span> &lt;&lt; endl;</span><br><span class="line">		SpecialMethod();</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"我给你转换为20V"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对象适配器</span></span><br><span class="line"><span class="keyword">class</span> ObjAdapter: <span class="keyword">public</span> Target &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	Adaptee ptr;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">/*ObjAdapter(Adaptee ptr)&#123;</span><br><span class="line">	 this-&gt;ptr = ptr;</span><br><span class="line">	 &#125;*/</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"对象适配器"</span> &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"你要20V，我给你20V"</span> &lt;&lt; endl;</span><br><span class="line">		ptr.SpecialMethod();</span><br><span class="line">		<span class="comment">//ptr-&gt;SpecialMethod();</span></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"我给你转换为20V"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">	<span class="comment">//类适配器</span></span><br><span class="line">	ClsAdapter cls;</span><br><span class="line">	cls.Method();</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"=================="</span> &lt;&lt; endl;</span><br><span class="line">	<span class="comment">//对象适配器</span></span><br><span class="line">	ObjAdapter obj;</span><br><span class="line">	obj.Method();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="u9002_u914D_u5668_u6A21_u5F0F"><a href="#u9002_u914D_u5668_u6A21_u5F0F" class="headerlink" title="适配器模式"></a>适配器模式</h2><h2 id="u7B80]]>
    </summary>
    
      <category term="设计模式" scheme="http://crazyhoney.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
</feed>
